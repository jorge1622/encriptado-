(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[31],{634:function(e,t,n){"use strict";n.r(t),n.d(t,"_OneDSLogger",function(){return Nt}),n.d(t,"_InMemoryPropertyStorage",function(){return Bt});var a,i=n(0),r=n(363),o=n(360),s=n(29),c=n(183),d=n(2),l=n(262),u=n(261),f="locale",p="ver",m="name",_=(n(7).l,Object(u.t)({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]})),h=Object(u.t)({id:[0,"id"],ver:[1,p],appName:[2,m],locale:[3,f],expId:[4,"expId"],env:[5,"env"]}),b=Object(u.t)({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),g=Object(u.t)({locale:[0,f],localId:[1,"localId"],id:[2,"id"]}),v=Object(u.t)({osName:[0,m],ver:[1,p]}),y=Object(u.t)({ver:[0,p],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),S=Object(u.t)({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),D=Object(u.t)({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),I=Object(u.t)({tz:[0,"tz"]}),x=Object(u.t)({sessionId:[0,"sesId"]}),C=Object(u.t)({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),O=Object(u.t)({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),w=Object(u.t)({traceId:[0,"traceID"],traceName:[1,m],parentId:[2,"parentID"]}),E=Object(u.t)({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]}),A=n(205),L=n(43),k=n(56),M=n(49),P=n(70);function T(){return void 0===a&&(a=!!F(0)),a}function U(){return T()?F(0):null}function F(e){var t,n,a=null;try{var i=Object(P.e)();if(!i)return null;n=new Date,(a=0===e?i.localStorage:i.sessionStorage)&&Object(d.m)(a.setItem)&&(a.setItem(n,n),t=a.getItem(n)!==n,a.removeItem(n),t&&(a=null))}catch(e){a=null}return a}function H(){return this.getId()}function R(e){this.setId(e)}var N=function(){function e(){Object(s.e)(e,this,function(e){e.setId=function(t){e.customId=t},e.getId=function(){return Object(d.v)(e.customId)?e.customId:e.automaticId}})}return e._staticInit=void Object(d.x)(e.prototype,"id",H,R),e}(),B="ai_session",j=function(){function e(t,n){var i,r,o=Object(L.i)(t),l=Object(k.a)(t);Object(s.e)(e,this,function(t){var s,u={sessionRenewalMs:(s=n).sessionRenewalMs&&function(){return s.sessionRenewalMs},sessionExpirationMs:s.sessionExpirationMs&&function(){return s.sessionExpirationMs},cookieDomain:s.cookieDomain&&function(){return s.cookieDomain},namePrefix:s.namePrefix&&function(){return s.namePrefix},sessionAsGuid:function(){return s.sessionAsGuid},idLength:function(){return s.idLength?s.idLength:22}};function f(e){var n=t.automaticSession,a=e.split("|");a.length>0&&n.setId(a[0]);try{if(a.length>1){var i=+a[1];n.acquisitionDate=+new Date(i),n.acquisitionDate=n.acquisitionDate>0?n.acquisitionDate:0}if(a.length>2){var r=+a[2];n.renewalDate=+new Date(r),n.renewalDate=n.renewalDate>0?n.renewalDate:0}}catch(e){Object(L.n)(o,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===n.renewalDate&&Object(L.n)(o,2,517,"AI session renewal date is 0, session will be reset.")}function p(){var e=t.automaticSession,n=(new Date).getTime(),a=t.config.sessionAsGuid();!Object(d.D)(a)&&a?Object(d.u)(a)?e.setId(Object(c.t)()):e.setId(Object(c.t)(a)):e.setId(Object(M.n)(u&&u.idLength?u.idLength():22)),e.acquisitionDate=n,e.renewalDate=n,m(e.getId(),e.acquisitionDate,e.renewalDate),T()||Object(L.n)(o,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function m(e,n,a){var o=n+t.config.sessionExpirationMs(),s=a+t.config.sessionRenewalMs(),c=new Date,d=[e,n,a];o<s?c.setTime(o):c.setTime(s);var u=t.config.cookieDomain?t.config.cookieDomain():null;l.set(r(),d.join("|")+";expires="+c.toUTCString(),null,u),i=(new Date).getTime()}Object(d.m)(n.sessionExpirationMs)||(u.sessionExpirationMs=function(){return e.acquisitionSpan}),Object(d.m)(n.sessionRenewalMs)||(u.sessionRenewalMs=function(){return e.renewalSpan}),t.config=u,r=function(){return t.config.namePrefix&&t.config.namePrefix()?B+t.config.namePrefix():B},t.automaticSession=new N,t.update=function(){t.automaticSession.getId()||function(){var e=l.get(r());if(e&&Object(d.m)(e.split))f(e);else{var n=function(e,t){var n=U();if(null!==n)try{return n.getItem(t)}catch(t){a=!1,Object(L.n)(e,1,503,"Browser failed read of local storage. "+t)}return null}(o,r());n&&f(n)}t.automaticSession.getId()||p()}();var n=t.automaticSession,s=t.config,c=(new Date).getTime(),u=c-n.acquisitionDate>s.sessionExpirationMs(),_=c-n.renewalDate>s.sessionRenewalMs();u||_?p():(!i||c-i>e.cookieUpdateInterval)&&(n.renewalDate=c,m(n.getId(),n.acquisitionDate,n.renewalDate))},t.backup=function(){var e,n,i,s=t.automaticSession;e=s.getId(),n=s.acquisitionDate,i=s.renewalDate,function(e,t,n){var i=U();if(null!==i)try{i.setItem(t,n)}catch(t){a=!1,Object(L.n)(e,1,504,"Browser failed write to local storage. "+t)}}(o,r(),[e,n,i].join("|"))}})}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),V=n(16),z=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function G(e,t){void 0===t&&(t=z);var n=null;if(e)for(var a=e.split(","),i=0;i<a.length;i++)K(a[i],t)&&(n?n+=","+a[i]:n=a[i]);return n}function K(e,t){if(void 0===t&&(t=z),!e||e.length<4)return!1;for(var n=!1,a=e.substring(0,3).toString().toUpperCase(),i=0;i<t.length;i++)if(t[i]+":"===a&&e.length<=256){n=!0;break}return n}function W(){return this.getExpId()}var q=function(){function e(t,n){var a=null,i=z.slice(0),r=Object(k.a)(n),o=t;Object(s.e)(e,this,function(e){if(Object(V.p)()){var n=Object(V.r)().documentElement;n&&(e.locale=n.lang)}function s(e){e!==a&&(a=G(e,i))}e.env=t.env?t.env:function(e){var t,n={},a=Object(V.r)();if(a){t=a&&a.querySelectorAll("meta");for(var i=0;i<t.length;i++){var r=t[i];r.name&&0===r.name.toLowerCase().indexOf(e)&&(n[r.name.replace(e,"")]=r.content)}}return n}("awa-").env,e.getExpId=function(){return o.expId?(s(o.expId),a):(s(Object(c.i)(r,"Treatments")),a)}})}return e.validateAppExpId=G,e._staticInit=void Object(d.x)(e.prototype,"expId",W),e}(),Q=function(){},Y=function(){};function J(){return this.getMsfpc()}function X(){return this.getAnid()}var Z=function(){function e(t,n){var a=Object(k.a)(n);Object(s.e)(e,this,function(e){t.serviceName&&(e.serviceName=t.serviceName),e.getMsfpc=function(){return Object(c.i)(a,"MSFPC")},e.getAnid=function(){return Object(c.i)(a,"ANON").slice(0,34)}})}var t;return e._staticInit=(t=e.prototype,Object(d.x)(t,"msfpc",J),void Object(d.x)(t,"anid",X)),e}(),$=function(){var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,a="+";n>0&&(a="-"),n=Math.abs(n),t=Math.abs(t),this.tz=a+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString())},ee={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},te={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},ne="Unknown",ae=[{r:ee.WINPHONE,os:"Windows Phone"},{r:ee.WINRT,os:"Windows RT"},{r:ee.WIN,os:"Windows"},{r:ee.IOS,os:"iOS"},{r:ee.ANDROID,os:"Android"},{r:ee.LINUX,os:"Linux"},{r:ee.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:ee.OSX,os:"Mac OS X"}];function ie(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?te[n[1]]?te[n[1]]:n[1]:ne}function re(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var oe=function(e){if(e.populateOperatingSystemInfo){var t=this,n=Object(V.l)()||{},a=e.userAgent||n.userAgent||"",i=e.userAgentData||n.userAgentData||{};if(a){var r=function(e){for(var t=0;t<ae.length;t++){var n=ae[t];if(n.r&&e.match(n.r))return n.os;if(n.s&&-1!==e.indexOf(n.s))return n.os}return ne}(a.toLowerCase());t.name=r,t.ver=function(e,t){return"Windows"===t?ie(e,"Windows NT"):"Android"===t?ie(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var a=re(n);return a?n.split(a)[0]:n}}return ne}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var a=re(n);return a?n.split(a)[0]:n}}return ne}(e):ne}(a,r)}t.name&&t.name!==ne||!Object(d.v)(i.platform)||(t.name=i.platform)}},se=n(103),ce="MicrosoftApplicationsTelemetryDeviceId",de=function(){function e(t,n){var a=0;Object(s.e)(e,this,function(e){var i=t.propertyStorageOverride;e.seq=a,e.epoch=Object(M.a)(!1).toString();var r=Object(k.a)(n,t);if(r.isEnabled()||i){var o=function(e,t,n){return t?t.getProperty(n)||"":Object(c.i)(e,n)}(r,i,ce);o||(o=Object(se.t)()),function(e,t,n,a){t?t.setProperty(n,a):e.set(n,a,31536e3)}(r,i,ce,o),e.installId=o}else r.purge(ce);e.getSequenceId=function(){return++a}})}return e.__ieDyn=1,e}(),le=function(e,t,n,a){var i=this;if(i.traceId=t||Object(se.e)(),e.enableDistributedTracing&&!n&&(n=Object(se.e)().substring(0,16)),i.parentId=n,e.enableApplicationInsightsTrace){i.name=a;var r=Object(V.c)();r&&r.pathname&&(i.name=r.pathname)}};function ue(){return this.getLocalId()}function fe(e){this.setLocalId(e)}var pe=function(){function e(t,n,a){var i,r=n,o=Object(k.a)(a,t);Object(s.e)(e,this,function(n){if(o&&o.isEnabled()&&(m(),r.enableApplicationInsightsUser)){var a=Object(c.i)(o,e.userCookieName);if(a){var s=a.split(e.cookieSeparator);s.length>0&&(n.id=s[0])}if(!n.id){n.id=Object(M.n)(t&&!Object(d.D)(t.idLength)?t.idLength:22);var l=Object(d.R)(new Date);n.accountAcquisitionDate=l;var u=[n.id,l],f=r.cookieDomain?r.cookieDomain:void 0;o.set(e.userCookieName,u.join(e.cookieSeparator),31536e3,f)}}if("undefined"!=typeof navigator){var p=navigator;n.locale=p.userLanguage||p.language}function m(){if(!r.hashIdentifiers&&!r.dropIdentifiers){var e=Object(c.i)(o,"MUID");e&&(i="t:"+e)}return i}n.getLocalId=function(){return i||m()},n.setLocalId=function(e){i=e}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void Object(d.x)(e.prototype,"localId",ue,fe),e}(),me=function(e){var t=this;t.popSample=100,t.eventFlags=0,e.hashIdentifiers&&(t.eventFlags=1048576|t.eventFlags),e.dropIdentifiers&&(t.eventFlags=2097152|t.eventFlags),e.scrubIpOnly&&(t.eventFlags=4194304|t.eventFlags)},_e=["Required","Analytics","SocialMedia","Advertising"],he="Unknown",be="Edg/",ge=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:be,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],ve=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function ye(e,t){return t.indexOf(e)>-1}function Se(e,t){for(var n=0;n<t.length;n++)if(e==t[n].brand)return t[n].version;return null}function De(){return this.getUserConsent()}var Ie=function(){function e(t,n){var a=Object(k.a)(n),i=t||{};Object(s.e)(e,this,function(e){var t=Object(V.c)();if(t){var n=t.hostname;n&&(e.domain="file:"===t.protocol?"local":n)}if(i.populateBrowserInfo){var r=i.userAgent,o=(i.userAgentData||{}).brands,s=Object(V.l)();s&&(r=r||s.userAgent||"",o=o||(s.userAgentData||{}).brands),function(t,n){if(Object(d.l)(n))try{for(var a=0;a<ve.length;a++){var i=Se(ve[a].br,n);if(i)return e.browser=ve[a].b,void(e.browserVer=i)}}catch(e){}if(t){var r=function(e){if(e)for(var t=0;t<ge.length;t++)if(ye(ge[t].ua,e))return ge[t].b;return he}(t);e.browser=r,e.browserVer=function(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&ye(be,t)&&(e="Edg");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n||"Opera"===e&&(n=t.match(new RegExp("OPR/([\\d,.]+)")))?n[1]:he}(t,e)}(t,r)}}(r,o);var l=function(){var e={h:0,w:0},t=Object(V.f)();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=l.w+"X"+l.h}Object(d.D)(i.gpcDataSharingOptIn)?e.gpcDataSharingOptIn=null:e.gpcDataSharingOptIn=i.gpcDataSharingOptIn,e.getUserConsent=function(){return i.userConsented||!!Object(c.i)(a,i.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){var t=null;try{var n=i.callback;if(n&&n.userConsentDetails){var a=n.userConsentDetails();if(a){t=i.disableConsentDetailsSanitize?a:{};for(var r=0;r<_e.length;r++){var o=_e[r];t[o]=a[o]||!1}}}var s=e.gpcDataSharingOptIn;return null!==s&&((t=t||{}).GPC_DataSharingOptIn=!!s),t?JSON.stringify(t):null}catch(e){}},Object(d.x)(e,"userConsent",e.getUserConsent)})}return e._staticInit=void Object(d.x)(e.prototype,"userConsent",De),e}();function xe(e,t,n,a,i){var r=t.ext[_[e]];if(r)try{Object(d.O)(a,function(e,t){if(Object(d.v)(t)||Object(d.b)(t)||Object(d.u)(t)){var a=r[n[e]];!i&&(a||Object(d.v)(a)||Object(d.b)(a)||Object(d.u)(a))&&(t=a),r[n[e]]=t}})}catch(e){}return r}var Ce=function(){function e(t,n,a){Object(s.e)(e,this,function(e){e.app=new q(n,a),e.cloud=new Q,e.user=new pe(t,n,a),e.os=new oe(n),e.web=new Ie(n,a);var i=new de(t,a),r=new Z(n,a),o=new me(n);e.loc=new $,e.device=new Y;var s=new j(a,n);e.session=new N;var c,l,u,f=(c=new le(n),l=_(),u=c||{},{getName:function(){return u.name},setName:function(e){l&&l.setName(e),u.name=e},getTraceId:function(){return u.traceId},setTraceId:function(e){l&&l.setTraceId(e),Object(A.t)(e)&&(u.traceId=e)},getSpanId:function(){return u.parentId},setSpanId:function(e){l&&l.setSpanId(e),Object(A.e)(e)&&(u.parentId=e)},getTraceFlags:function(){return u.traceFlags},setTraceFlags:function(e){l&&l.setTraceFlags(e),u.traceFlags=e}}),p=!(n||{}).eventContainExtFields;function m(){var t=e.session;if(t&&Object(d.v)(t.customId))return t.customId;s.update();var n=s.automaticSession;if(n){var a=n.getId();a&&Object(d.v)(a)&&(t.automaticId=a)}return t.automaticId}function _(){var e=f;return a&&a.getTraceCtx&&(e=a.getTraceCtx(!1)||f),e}e.getTraceCtx=function(){return f},e.getSessionId=m,e.applyApplicationContext=function(t){var n,a=e.app;xe(4,t,h,((n={})[0]=a.id,n[1]=a.ver,n[2]=a.name,n[3]=a.locale,n[4]=a.getExpId(),n[5]=a.env,n),p)},e.applyUserContext=function(t){var n,a=e.user;xe(0,t,g,((n={})[1]=a.getLocalId(),n[0]=a.locale,n[2]=a.id,n),p)},e.applyWebContext=function(t){var n,a=e.web;xe(3,t,b,((n={})[0]=a.domain,n[1]=a.browser,n[2]=a.browserVer,n[3]=a.screenRes,n[5]=a.getUserConsentDetails(),n[4]=a.getUserConsent(),n),p)},e.applyOsContext=function(t){var n,a=e.os;xe(5,t,v,((n={})[0]=a.name,n[1]=a.ver,n),p)},e.applySdkContext=function(e){var t;xe(6,e,y,((t={})[2]=i.installId,t[1]=i.getSequenceId(),t[3]=i.epoch,t),p)},e.applyIntWebContext=function(e){var t;xe(7,e,S,((t={})[0]=r.getMsfpc(),t[1]=r.getAnid(),t[2]=r.serviceName,t),p)},e.applyUtcContext=function(e){var t,n=((t={})[0]=o.popSample,t);o.eventFlags>0&&(n[1]=o.eventFlags),xe(8,e,D,n,p)},e.applyLocContext=function(t){var n;xe(9,t,I,((n={})[0]=e.loc.tz,n),p)},e.applySessionContext=function(e){var t;xe(4,e,x,((t={})[0]=m(),t),p)},e.applyDeviceContext=function(t){var n,a=e.device;xe(1,t,C,((n={})[0]=a.localId,n[2]=a.make,n[3]=a.model,n[1]=a.deviceClass,n),p)},e.applyCloudContext=function(t){var n,a=e.cloud;xe(10,t,O,((n={})[0]=a.role,n[1]=a.roleInstance,n[2]=a.roleVer,n),p)},e.applyAITraceContext=function(e){var t;if(n.enableApplicationInsightsTrace){var a=_();a&&xe(2,e,w,((t={})[0]=a.getTraceId(),t[1]=a.getName(),t[2]=a.getSpanId(),t),!1)}},e.applyDistributedTraceContext=function(e){var t,n=_();if(n){var a=((t={})[0]=n.getTraceId(),t[1]=n.getSpanId(),t),i=n.getTraceFlags();Object(d.h)(i)||(a[2]=i),xe(11,e,E,a,!1)}}})}return e.__ieDyn=1,e}(),Oe=[_[4],_[0],_[3],_[5],_[6],_[7],_[8],_[9],_[1],_[2],_[11],_[10]],we=function(e){function t(){var n,a,i,r=e.call(this)||this;return r.identifier="SystemPropertiesCollector",r.priority=3,r.version="3.2.15",Object(s.e)(t,r,function(e,t){function r(){n=null,a={}}r(),e.initialize=function(a,r,o){t.initialize(a,r,o),i=e._getTelCtx().getExtCfg(e.identifier),n=new Ce(a,i,r),r&&r.setTraceCtx&&r.setTraceCtx(n.getTraceCtx())},e.processTelemetry=function(t,r){Object(c.f)(t,e.identifier),r=e._getTelCtx(r);var o,s,l=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},Object(d.e)(Oe,function(e){l[e]=l[e]||{}}),n&&(n.applyUtcContext(t),n.applyApplicationContext(t),n.applyUserContext(t),n.applyWebContext(t),n.applyOsContext(t),n.applySdkContext(t),n.applyIntWebContext(t),n.applyLocContext(t),n.applySessionContext(t),n.applyDeviceContext(t),i.enableApplicationInsightsTrace&&n.applyAITraceContext(t),i.enableDistributedTracing&&n.applyDistributedTraceContext(t),n.applyCloudContext(t)),Object(d.e)(Object(d.E)(l),function(e){0===Object(d.E)(l[e]).length&&delete l[e]}),o=a,s=t.data,o&&Object(d.O)(o,function(e,t){s[e]||(s[e]=t)}),e.processNext(t,r)},e.getPropertiesContext=function(){return n},e.setProperty=function(e,t){a[e]=t},e._doTeardown=function(e,t){var a=(e||{}).core();if(a&&a.getTraceCtx&&n){var i=a.getTraceCtx(!1);i&&i===n.getTraceCtx()&&a.setTraceCtx(null)}r()}}),r}return Object(o.e)(t,e),t.__ieDyn=1,t}(l.e),Ee=n(362),Ae=n(110),Le=d.m;function ke(e,t,n){return function(a){e[t]=a,n()}}var Me=function(){function e(t){var n=0,a=null,i=[];function r(){if(i.length>0){var e=i.slice();i=[],setTimeout(function(){for(var t=0,n=e.length;t<n;++t)try{e[t]()}catch(e){}},0)}}function o(e){0===n&&(a=e,n=1,r())}function c(e){0===n&&(a=e,n=2,r())}Object(s.e)(e,this,function(t){t.then=function(t,o){return new e(function(s,c){!function(t,o,s,c){i.push(function(){var i;try{(i=1===n?Le(t)?t(a):a:Le(o)?o(a):a)instanceof e?i.then(s,c):2!==n||Le(o)?s(i):c(i)}catch(e){return void c(e)}}),0!==n&&r()}(t,o,s,c)})},t.catch=function(e){return t.then(null,e)}}),function(){if(!Le(t))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{t(o,c)}catch(e){c(e)}}()}return e.resolve=function(t){return t instanceof e?t:t&&Le(t.then)?new e(function(e,n){try{t.then(e,n)}catch(e){n(e)}}):new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.all=function(t){if(t&&t.length)return new e(function(e,n){try{for(var a=[],i=0,r=0;r<t.length;r++){var o=t[r];o&&Le(o.then)?(i++,o.then(ke(a,r,function(){0==--i&&e(a)}),n)):a[r]=o}0===i&&setTimeout(function(){e(a)},0)}catch(e){n(e)}})},e.race=function(t){return new e(function(e,n){if(t&&t.length)try{for(var a=function(a){var i=t[a];i&&Le(i.then)?i.then(e,n):setTimeout(function(){e(i)},0)},i=0;i<t.length;i++)a(i)}catch(e){n(e)}})},e}(),Pe=0,Te=[],Ue=[],Fe=[];function He(){return(new Date).getTime()}var Re,Ne=function(){function e(t,n){var a=0,i=(t||"<unnamed>")+"."+Pe;function r(e){var t=Object(P.e)();t&&t.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+e)}function o(e){Object(L.a)(n,"ESPromiseScheduler["+i+"] "+e)}Pe++,Object(s.e)(e,this,function(e){var t=null,n=0;function s(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e.splice(n,1)[0];return null}e.scheduleEvent=function(e,c,d){var l=i+"."+n;n++,c&&(l+="-("+c+")");var u=l+"{"+a+"}";a++;var f,p,m,_={evt:null,tm:He(),id:u,isRunning:!1,isAborted:!1};return _.evt=t?(f=_,p=t,m=new Me(function(e,t){var n=He()-p.tm,a=p.id;r("["+l+"] is waiting for ["+a+":"+n+" ms] to complete before starting -- ["+Ue.length+"] waiting and ["+Te.length+"] running"),f.abort=function(e){f.abort=null,s(Ue,l),f.isAborted=!0,t(new Error(e))},p.evt.then(function(n){s(Ue,l),S(f).then(e,t)},function(n){s(Ue,l),S(f).then(e,t)})}),Ue.push(f),m):S(_),(t=_).evt._schId=u,_.evt;function h(e){for(var t=He(),n=t-6e5,a=e.length,i=0;i<a;){var r=e[i];if(r&&r.tm<n){var s=null;r.abort?(s="Aborting ["+r.id+"] due to Excessive runtime ("+(t-r.tm)+" ms)",r.abort(s)):s="Removing ["+r.id+"] due to Excessive runtime ("+(t-r.tm)+" ms)",o(s),e.splice(i,1),a--}else i++}}function b(e,n){var a=!1,i=s(Te,e);if(i||(i=s(Fe,e),a=!0),i){i.to&&(clearTimeout(i.to),i.to=null);var c=He()-i.tm;n?a?o("Timed out event ["+e+"] finally complete -- "+c+" ms"):r("Promise ["+e+"] Complete -- "+c+" ms"):(Fe.push(i),o("Event ["+e+"] Timed out and removed -- "+c+" ms"))}else r("Failed to remove ["+e+"] from running queue");t&&t.id===e&&(t=null),h(Te),h(Ue),h(Fe)}function g(e,t){return function(n){return b(e,!0),t&&t(n),n}}function v(e,t,n,a){t.then(function(t){return t instanceof Me?(r("Event ["+e+"] returned a promise -- waiting"),v(e,t,n,a),t):g(e,n)(t)},g(e,a))}function y(e,t){var n=e.id;return new Me(function(a,i){r("Event ["+n+"] Starting -- waited for "+(e.wTm||"--")+" ms"),e.isRunning=!0,e.abort=function(t){e.abort=null,e.isAborted=!0,b(n,!1),i(new Error(t))};var o=t(n);o instanceof Me?(d&&(e.to=setTimeout(function(){b(n,!1),i(new Error("Timed out after ["+d+"] ms"))},d)),v(n,o,function(t){r("Event ["+n+"] Resolving after "+(He()-e.tm)+" ms"),a(t)},i)):(r("Promise ["+n+"] Auto completed as the start action did not return a promise"),a())})}function S(t){var n=He();return t.wTm=n-t.tm,t.tm=n,t.isAborted?Me.reject(new Error("["+l+"] was aborted")):(Te.push(t),y(t,e))}}})}return e.incomplete=function(){return Te},e.waitingToStart=function(){return Ue},e}(),Be=n(45);function je(e){return Object(d.b)(e)&&e>=1&&e<=2}!function(e){e[e.LocalStorage=1]="LocalStorage",e[e.SessionStorage=2]="SessionStorage",e[e.IndexedDb=3]="IndexedDb"}(Re||(Re={}));var Ve="DBError: Unable to open database",ze="Database is not open",Ge="DBError: Failed to delete the database",Ke=["indexedDB"],We=d.m,qe=d.v;function Qe(e,t){Object(V.o)("QUnit")&&console&&console.log("IndexedDbHelper ["+e+"] "+t)}function Ye(e,t,n){e&&e.warnToConsole("IndexedDbHelper ["+t+"] "+n)}function Je(e,t,n,a){return function(i){n(new Error(t)),Qe(e,"["+a+"] event rejected")}}var Xe=[];function Ze(e,t){for(var n=null,a=0;a<Xe.length;a++)if((n=Xe[a]).name===e)return n;return n={name:e,sch:new Ne("IndexedDbHelper["+e+"]",t),dbHdl:[],add:function(t){n.dbHdl.push(t),Qe(e,"- dbOpened (add) -- hdls ["+n.dbHdl.length+"]")},remove:function(t){for(var a=n.dbHdl,i=0;i<a.length;i++)if(a[i]===t){a.splice(i,1);break}Qe(e,"- dbClosed (remove) -- hdls ["+n.dbHdl.length+"]")},isOpen:function(){return n.dbHdl.length>0},openHdl:function(){return n.dbHdl.length>0?n.dbHdl[0]:null}},Xe.push(n),n}var $e=function(){function e(t){Object(s.e)(e,this,function(e){var n=function(){var e=Object(P.e)()||{},t=null;if(e)try{for(var n=0;n<Ke.length;n++)if((t=e[Ke[n]])&&We(t.open))return t}catch(e){t=null}return t||null}()||null;function a(e,n){var a=e.db.transaction(n,"readwrite");return a.onabort=function(){Ye(t,e.dbName,"txn.onabort")},a.onerror=function(){Ye(t,e.dbName,"txn.onerror")},a.oncomplete=function(){Qe(e.dbName,"txn.oncomplete")},{db:e,store:a.objectStore(n),tx:a,tbl:n,openCursor:function(t,a){return r(e,n,t,a)},newTransaction:function(t){return i(e,n,t)}}}function i(e,t,n){if(!e||!e.db)return Me.reject(new Error(ze));try{var i=n(a(e,t));return i instanceof Me?i:Me.resolve(i)}catch(e){return Me.reject(e)}}function r(e,t,n,i){if(!e||!e.db)return Me.reject(new Error(ze));var r=null;return n&&qe(n)?r=new et(n):n&&n.isMatch&&(r=n),new Me(function(n,o){var s=[],c=null,d=null;r&&r.keyRange&&(d=r.keyRange());var l=a(e,t);(c=d?l.store.openCursor(d):l.store.openCursor()).onerror=Je(l.db.dbName,"DBError: Failed to Open Cursor",o,"openCursor"),c.onsuccess=function(e){var t=e.target.result;if(t){var a={store:l,cursor:t,continue:function(){t.continue()},done:function(){n(s)}},c=t.value;if(!r||r.isMatch(c))if(i)try{switch(i(a,c,s)){case 2:n(s);break;case 1:break;default:a.continue()}}catch(e){o(e)}else s.push(c),a.continue();else a.continue()}else n(s)}})}function o(e,t,n,a){return Ze(e).sch.scheduleEvent(n,t,a)}e.isAvailable=function(){return!!n},e.openDb=function(e,a,s,c){return o(e,"openDb",function(o){return new Me(function(d,l){var u=!1;function f(t,n,o,s,c){var d={db:n,dbName:e,dbVersion:a,ctx:null,isNew:s,txn:o?o.transaction:null};return c||(d.openStore=function(e,t){return i(d,e,t)},d.openCursor=function(e,t,n){return r(d,e,t,n)}),d}var p=Ze(e);if(null==n)l(new Error("No available storage factory"));else if(p.isOpen()){var m=f(0,p.openHdl(),null,!1);s(m).then(d,l)}else{var _=n.open(e,a);_.onblocked=function(n){Ye(t,e,"Db Open Blocked event ["+o+"] - "+(_.error||"")),l(new Error(Ve))},_.onerror=function(n){Ye(t,e,"Db Open Error event ["+o+"] - "+(_.error||"")),l(new Error(Ve))},_.onupgradeneeded=function(t){Qe(e,"Db Open Create/Upgrade needed event ["+o+"]");try{var n=t.target.result;if(!n)return void l(new Error(Ve));!function(e,t){var n=f(0,e,t,!0,!0);if(c)u=!0,c(n).then(function(){n.txn||(n.txn=t.transaction)},function(e){try{t.transaction&&t.transaction.abort()}finally{l(e)}});else try{t.transaction&&t.transaction.abort()}finally{l(new Error("DBError: Database upgrade required"))}}(n,_)}catch(t){Je(e,Ve,l,o)(t)}},_.onsuccess=function(n){var a=n.target.result;a?function(n,a){var i=Ze(e);i.add(n),n.onabort=function(a){Ye(t,e,"onabort -- closing the Db"),i.remove(n)},n.onerror=function(a){Ye(t,e,"onerror -- closing the Db"),i.remove(n)},n.onclose=function(a){Ye(t,e,"onclose -- closing the Db"),i.remove(n)},n.onversionchange=function(a){Ye(t,e,"onversionchange -- force closing the Db"),n.close(),i.remove(n)};var r,o=null;i.dbHdl.length>0&&(o=i.dbHdl[0]),r=f(0,o,a,u);try{s(r).then(function(e){d(e)},l)}catch(e){l(e)}}(a,_):l(new Error(Ve))}}})})},e.closeDb=function(e){o(e,"closeDb",function(t){var n=Ze(e),a=n.dbHdl,i=a.length;if(i>0){for(var r=0;r<i;r++)a[r].close();n.dbHdl=[]}return Me.resolve(1)})},e.deleteDb=function(e){return null==n?Me.resolve(!1):o(e,"deleteDb",function(a){var i=Ze(e),r=i.dbHdl,o=r.length;if(o>0){Ye(t,e,"Db is open ["+o+"] force closing");for(var s=0;s<o;s++)r[s].close();i.dbHdl=[]}return new Me(function(i,r){setTimeout(function(){try{Qe(e,"["+a+"] starting");var o=n.deleteDatabase(e);o.onerror=function(n){Ye(t,e,"["+a+"] error!!"),r(new Error(Ge))},o.onblocked=function(n){Ye(t,e,"["+a+"] blocked!!"),r(new Error(Ge))},o.onupgradeneeded=function(n){Ye(t,e,"["+a+"] upgrade needed!!"),r(new Error(Ge))},o.onsuccess=function(t){Qe(e,"["+a+"] complete"),i(!0)},Qe(e,"["+a+"] started")}catch(n){Ye(t,e,"["+a+"] threw - "+n),r(new Error(Ge+" - "+n))}},0)})})},e.getDbDetails=function(e){return o(e,"getDbDetails",function(t){return null!=n&&n.databases?new Me(function(t,a){n.databases().then(function(n){for(var i=0;i<n.length;i++)if(n[i].name===e)return void t(n[i]);a(new Error("DBError: Database does not exist"))},a)}):Me.reject(new Error("DBError: Feature not supported"))},2e3)}})}return e.__ieDyn=1,e}(),et=function(){function e(t){var n=[],a=null;Object(s.e)(e,this,function(e){e.keyRange=function(){return a},e.parseQuery=function(t){if(n=[],t)for(var i=t.split(";"),r=0;r<i.length;r++){var o=i[r],s=o.indexOf("=");if(-1!==s){var c=o.substring(0,s),d=o.substring(s+1);0===c.indexOf("#")&&(c=c.substring(1),a||(a=IDBKeyRange.bound(d,d+"ï¿¿"))),e.startsWith(c,d)}}},e.startsWith=function(e,t){n.push({name:e,value:t,type:0})},e.contains=function(e,t){n.push({name:e,value:t,type:1})},e.isMatch=function(e){if(!n||0===n.length)return!0;if(!e)return!1;for(var t=0;t<n.length;t++){var a=n[t],i=e[a.name];if(i)if(0===a.type){if(0!==i.indexOf(a.value))return!1}else if(1===a.type&&-1===i.indexOf(a.value))return!1}return!0},t&&e.parseQuery(t)})}return e.__ieDyn=1,e}(),tt=1008e4,nt="DBError: Unable to add event",at="Evts",it="iKey",rt=je;function ot(){return(new Date).getTime()}function st(e){return e.openStore(it,function(t){return new Me(function(n,a){var i,r={iKey:e.ctx.iKey,tm:ot()},o=t.store.put(r);o.onsuccess=function(e){n(o.result.toString())},o.onerror=function(e){a(new Error(nt))},o.onerror=(i=a,function(e){return i(new Error("DBError: Unable to update iKey"))})})})}function ct(e){for(var t=[],n=2;n>=1;n--)for(var a=0;a<e.length;a++){var i=e[a];i&&i.evt.persistence===n&&t.push(i.evt)}return t}function dt(e){return function(t){return e.continue()}}function lt(e){var t=e.cursor.delete();return t.onerror=dt(e),t.onsuccess=dt(e),1}function ut(e,t,n){return e.openCursor(at,t,function(e,t,a){return n(t)?(a.push(t),lt(e)):0})}var ft=function(){function e(t){Object(s.e)(e,this,function(e){var n=null,a=null,i="Unknown",r=null,o=null,s=null,c=-1,d=0;function l(e){return n.openDb(a,1,function(t){return new Me(function(n,a){var c={iKey:i,storageId:r,iKeyPrefix:function(){return o},evtKeyPrefix:function(){return s}};t.ctx=c,st(t).then(function(){e(t).then(n,a)},a)})},function(e){return new Me(function(t,n){var a;(a=e.db).objectStoreNames.contains(at)||a.createObjectStore(at,{keyPath:"key"}).createIndex("EvntId","key",{unique:!1}),a.objectStoreNames.contains(it)||a.createObjectStore(it,{keyPath:"iKey"}).createIndex("iKey","iKey",{unique:!0}),t()})})}function u(e,t,n){return new Me(function(a,i){function r(t,n){(function(e,t){return new Me(function(n,a){var i=0,r=e.ctx.evtKeyPrefix();function o(){n(i)}function s(e,t){return new Me(function(n){var a=e.store.delete(t.key);a.onsuccess=function(e){i++,n()},a.onerror=function(e){n()}})}e.openCursor(at,"#key="+r,function(e,n,a){return n.evt.persistence<=t&&0===n.key.indexOf(r)&&(function(e,t){for(var n=0;n<e.length;n++)if(t.tm<e[n].tm)return void e.splice(n,0,t);e.push(t)}(a,n),a.length>10&&a.splice(a.length-1,1)),0}).then(function(t){0!==t.length?e.openStore(at,function(e){for(var n=[],a=0;a<t.length;a++)n.push(s(e,t[a]));return Me.all(n).then(o,o)}):o()},function(){n(0)})})})(e,t).then(function(e){e>0&&(d-=e),n(e)},function(e){n(0)})}function o(e){a(t.evt)}function s(){e.openStore(at,function(s){var c=s.store.put(t);c.onsuccess=function(i){n&&st(e).then(o,o),d++,a(t.evt)},c.onerror=function(o){function s(n){0===n&&i(new Error(nt)),u(e,t,!1).then(function(e){a(t.evt)},function(){i(new Error(nt))})}n?r(1,function(e){e>0?s(e):t.evt.persistence>=2?r(2,function(e){s(e)}):i(new Error(nt))}):i(new Error(nt))}})}c>0&&d>=c?r(1,function(e){0===e?t.evt.persistence>=2?r(2,function(e){s()}):i(new Error(nt)):s()}):s()})}e.id=t,e.initialize=function(t){var d=t.itemCtx.diagLog();if(!(n=new $e(d)).isAvailable())return n=null,!1;var u=t.itemCtx.getCfg(),f=t.storageConfig||{};return a=f.indexedDbName||"AppInsightEvents.1",i=u.instrumentationKey||i,r=e.id||t.id||Object(se.t)(),s=(o=i+"::")+r+"::",c=f.maxStorageItems>0?f.maxStorageItems:c,l(function(e){return e.isNew?Me.resolve(!0):function(e){return new Me(function(t,n){(function(e){return new Me(function(t,n){var a=!1;e.openCursor(it,null,function(e,t,n){var i=t.tm;return ot()-i<tt?0:(a=!0,2)}).then(function(){if(a){var i={};ut(e,null,function(e){if(!e||!e.evt||!e.evt.iKey)return!0;var t=e.tm;return ot()-t>tt||(i[e.evt.iKey]=1,!1)}).then(function(){var a=[];e.openCursor(it,null,function(e,t,n){var r=t.tm;return ot()-r<tt||i[t.iKey]?0:(a.push(t),lt(e))}).then(function(){t(a)},n)},n)}else t([])},n)})})(e).then(function(){(function(e){return e.openCursor(at,"#key="+e.ctx.iKeyPrefix(),function(t,n){var a,i=n.key;if(0===i.indexOf(e.ctx.iKeyPrefix())&&-1===i.indexOf(e.ctx.evtKeyPrefix())&&(a=n.tm,ot()-a>6e5)){n.key=e.ctx.evtKeyPrefix()+n.id;var r=t.store.store.put(n);return r.onerror=dt(t),r.onsuccess=function(e){try{lt(t)}catch(e){t.continue()}},1}return 0})})(e).then(t,t)},n)})}(e)}).then(function(e){},function(e){d.warnToConsole("IndexedDbProvider failed to initialize - "+(e||"<unknown>")),n=null}),!0},e.supportsSyncRequests=function(){return!1},e.getAllEvents=function(){return null!=n&&n.isAvailable()?l(function(e){return new Me(function(t,n){(function(e,t){return e.openCursor(at,t,function(e,t,n){return n.push(t),0})})(e,"#key="+e.ctx.evtKeyPrefix()).then(function(e){d=e.length,t(ct(e))},n)})}):Me.resolve([])},e.addEvent=function(e,t,a){return null!=n&&n.isAvailable()?(t.id=t.id||Object(se.t)(),rt(t.persistence)||(t.persistence=1),l(function(n){var a=e||t.id,i={key:n.ctx.evtKeyPrefix()+a,id:a,evt:t,tm:ot(),v:1};return u(n,i,!0)})):Me.resolve(t)},e.removeEvents=function(e){if(null==n||!n.isAvailable())return Me.resolve([]);var t=[];return new Me(function(n,a){l(function(n){return n.openCursor(at,"#key="+n.ctx.iKey,function(n,a,i){if(-1!==function(e,t){for(var n=t.length,a=0;a<n;a++)if(e===t[a].id)return a;return-1}(a.id,e)){var r=n.cursor.delete();return r.onerror=dt(n),r.onsuccess=function(){t.push(a.evt),n.continue()},1}return 0})}).then(function(e){d-=t.length,n(t)},function(e){d-=t.length,n(t)})})},e.clear=function(){return null!=n&&n.isAvailable()?new Me(function(e,t){l(function(e){return ut(e,"#key="+e.ctx.evtKeyPrefix(),function(t){return 0===t.key.indexOf(e.ctx.evtKeyPrefix())})}).then(function(t){d=0,e(ct(t))},t)}):Me.resolve([])},e.teardown=function(){n&&n.closeDb(a)}})}return e.__ieDyn=1,e}(),pt="AWTEvents";function mt(e,t){if(e)for(var n=Object(d.E)(e),a=0;a<n.length;a++){var i=n[a];if(!t(e[i],i))break}}function _t(e){var t=!0;return mt(e,function(e,n){return e&&(t=!1),t}),t}function ht(e,t){for(var n=1,a=0,i=function(){var e=[],i=t[n];if(mt(i,function(t,n){return e.push(n),++a<10}),a>0){for(var r=0;r<e.length;r++)delete i[e[r]];return{value:!0}}n++};n<=e&&a<10;){var r=i();if("object"==typeof r)return r.value}return a>0}var bt=je,gt=function(){function e(t,n){Object(s.e)(e,this,function(e){var a=null,i=pt,r=null,o=null,s=null,d=5e6,l=null,u=null;function f(e,t){return{key:e,db:t}}function p(e,t){void 0===t&&(t=!0);var n=null;if(a){var i=a.getItem(e);if(i)try{n=JSON.parse(i)}catch(t){a.removeItem(e)}}return t&&!n&&(n={events:{1:{},2:{},3:{}},lastAccessTime:0}),f(e,n)}function m(e,t){void 0===t&&(t=!0);var n=!0,i=e.db;if(i){t&&(i.lastAccessTime=(new Date).getTime());for(var r=1;r<=2;r++)if(!_t(i.events[r])){n=!1;break}}try{if(n)a&&a.removeItem(e.key);else{var o=JSON.stringify(i);if(o.length>d)return!1;a&&a.setItem(e.key,o)}}catch(e){return!1}return!0}e.id=n,a=function(e){var t=Object(P.e)()||{},n=null;try{if(n=t[e]){var a="__storage_test__";n.setItem(a,a),n.removeItem(a)}}catch(e){(function(e,t){var n=!1;return t instanceof DOMException&&(22!==t.code&&"QuotaExceededError"!==t.name&&1014!==t.code&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||e&&0!==e.length&&(n=!0)),n})(n,e)||(n=null)}return n}(t)||null,e.initialize=function(t){if(!a)return!1;var n=t.storageConfig||{};return d=n.maxStorageSizeInBytes>0?n.maxStorageSizeInBytes:d,i=n.storageKey||pt,r=e.id||t.id||Object(se.t)(),u=i+"."+r,l=i+"Version",o=t.itemCtx.getCfg().instrumentationKey,s=Object(c.r)(o)||o,function(){if(a){for(var e=a.getItem(l),t=[],n=p(u),r=!1,o=0;o<a.length;o++){var d=a.key(o);if(0===d.indexOf(i)&&d!==l){if("3"!==e){t.push(f(d,null));continue}var _=p(d,!1),h=_.db;if(h){if((new Date).getTime()-h.lastAccessTime>6e5){for(var b=1,g=function(){var e=h.events[b],t=n.db.events[b];mt(e,function(n,a){return(Object(c.r)(n.iKey)||n.iKey)===s&&(t[a]=n,delete e[a]),!0}),b++};b<=2;)g();r=!0,t.push(_)}}else t.push(f(d,null))}}for(o=0;o<t.length;o++)m(t[o],!1);r&&m(n),a.setItem(l,"3")}}(),!0},e.supportsSyncRequests=function(){return!0},e.getAllEvents=function(){try{var e=[],t=p(u,!1).db;if(t)for(var n=t.events,a=2;a>=1;a--)mt(n[a],function(t){return t&&(Object(c.r)(t.iKey)||t.iKey)===s&&e.push(t),!0});return Me.resolve(e)}catch(e){return Me.reject(e)}},e.addEvent=function(e,t,n){try{var a=p(u);t.id=t.id||Object(se.t)(),bt(t.persistence)||(t.persistence=1);for(var i=t.persistence,r=t.id,o=a.db.events;;){if(o[i][r]=t,m(a))return Me.resolve(t);if(delete o[i][r],!ht(i,o))return Me.reject(new Error("Unable to free up event space"))}}catch(e){return Me.reject(e)}},e.removeEvents=function(e){try{var t=p(u,!1),n=t.db;if(n){var i=n.events;try{for(var r=0;r<e.length;++r){var o=e[r];delete i[o.persistence][o.id]}if(m(t))return Me.resolve(e)}catch(e){}e=function(e){var t=[],n=p(e,!1),i=n.db;if(i){var r=i.events;try{for(var o=1;o<=2;o++)mt(r[o],function(e,n){return e&&t.push(e),!0})}catch(e){}a&&a.removeItem(n.key)}return t}(t.key)}return Me.resolve(e)}catch(e){return Me.reject(e)}},e.clear=function(){try{var e=[],t=p(u,!1),n=t.db;if(n){for(var a=n.events,i=function(t){var n=a[t];mt(n,function(t){return t&&(Object(c.r)(t.iKey)||t.iKey)===s&&(delete n[t.id],e.push(t)),!0})},r=2;r>=1;r--)i(r);m(t)}return Me.resolve(e)}catch(e){return Me.reject(e)}},e.teardown=function(){try{var e=p(u,!1),t=e.db;t&&(t.lastAccessTime=0,m(e,!1))}catch(e){}}})}return e.__ieDyn=1,e}(),vt=je,yt=function(e){function t(){var n=e.call(this)||this;return n.identifier="LocalStorage",n.priority=1009,n.version="3.2.15",Object(s.e)(t,n,function(e,t){var n,a,i,r;function o(){n=!1,a=!1,i=null,r=[]}function s(e,t){i||(i=new Ne("LocalStorage")),i.scheduleEvent(function(e){return t(e)},e)}function l(t){Object(Ae.t)(e.core,function(){return"LocalStorageChannel:_sendStoredEventsToNextPlugin"},function(){s("sendToNext",function(n){return t.provider.getAllEvents().then(function(n){for(var a=0;a<n.length;a++)try{var i=n[a];(Object(c.r)(i.iKey)||i.iKey)===t.tenantId&&e.processNext(i,t.coreRootCtx.createNew())}catch(e){}})})},function(){return{iKeyConfig:t}})}function u(t,n){Object(Ae.t)(e.core,function(){return"LocalStorageChannel:_removeEvents"},function(){s("removeEvents",function(e){var a=[];return Object(d.e)(n,function(e){(Object(c.r)(e.iKey)||e.iKey)===t.tenantId&&a.push(e)}),a.length>0?t.provider.removeEvents(a).then(function(e){}).catch(function(e){}):Me.resolve()})},function(){return{iKeyConfig:t,events:n}})}function f(e){var t=new ft;return t.initialize(e)||(t=null),t}function p(e,t){var n=new gt(e);return n.initialize(t)||(n=null),n}o(),e.initialize=function(a,o,s,d){Object(Ae.t)(o,function(){return"LocalStorageChannel.initialize"},function(){n||(t.initialize(a,o,s),t.setInitialized(!1),n=!0,i=new Ne("LocalStorage",o.logger)),function(t,n,a,i){var o=e.identifier,s=t.extensionConfig=t.extensionConfig||[],d=s[o]=s[o]||{};d.providers||(d.providers=[Re.LocalStorage,Re.IndexedDb]);var m=function(t,n,a,i){t&&(t.extensionConfig=t.extensionConfig||[]),!i&&n&&(i=n.getProcessTelContext().getNext());var r=null,o=e._getTelCtx().getNext();return o&&(r=o.getPlugin()),new Be.e(i,t,n,r)}(t,n,0,i),_={itemCtx:m,storageConfig:d,id:e.id},h=function(e){for(var t=e.storageConfig.providers,n=null,a=0;!n&&a<t.length&&a<5;)switch(t[a++]){case Re.LocalStorage:n=p("localStorage",e);break;case Re.SessionStorage:n=p("sessionStorage",e);break;case Re.IndexedDb:n=f(e)}return n}(_);if(h){var b={iKey:t.instrumentationKey,tenantId:Object(c.r)(t.instrumentationKey)||t.instrumentationKey,minPersistenceCacheLevel:1,coreRootCtx:m,providerContext:_,provider:h};vt(d.minPersistenceLevel||-1)&&(b.minPersistenceCacheLevel=d.minPersistenceLevel),r.push(b),n.addNotificationListener({eventsSent:function(e){u(b,e)},eventsDiscarded:function(e,t){u(b,e)}}),l(b)}}(a,o,0,d)},function(){return{coreConfig:a,core:o,extensions:s,pluginChain:d}})},e.processTelemetry=function(t,i){var o,l,u=t;if(n&&!a){i=e._getTelCtx(i),Object(c.f)(t,e.identifier);var f=null;Object(d.e)(r,function(e){e.iKey===t.iKey&&(f=e)});var p=f?f.provider:null;if(u.sync||!p)return void e.processNext(u,i);u.id=u.id||Object(se.t)(),je(u.persistence)||(u.persistence=1),o=f,!((l=u).sync||l.persistence<o.minPersistenceCacheLevel)&&s("processTelemetry",function(e){return p.addEvent(u.id,u,i)})}e.processNext(u,i)},e.pause=function(){a=!0},e.resume=function(){Object(Ae.t)(e.core,function(){return"LocalStorageChannel:resume"},function(){a=!1,Object(d.e)(r,function(e){e.provider&&l(e)})})},e._doTeardown=function(e,t){Object(d.e)(r,function(e){var t=e.provider;t&&t.teardown()}),o()},e.flush=function(e,t){void 0===e&&(e=!0)}}),n}return Object(o.e)(t,e),t.__ieDyn=1,t}(l.e),St=["ACCDA","ACCDB","ACCDC","ACCDE","ACCDR","ACCDT","ACCDU","ACCDW","ACCFT","ADE","ADN","ADP","AVI","BMP","CSV","DOC","DOCX","DOT","DOTX","ERR","FON","GIF","HTML","ISO","JPEG","JPG","LACCDB","LDB","LOG","MAD","MAF","MAG","MAM","MAQ","MAR","MAS","MAT","MAU","MAV","MAW","MDA","MDBHTML","MDE","MDN","MDT","MDW","MOV","MP3","MPD","MPG","MPP","MPT","MPW","MPX","MSG","OLS","ONE","ONEPKG","ONETOC","ONETOC2","OST","PDF","PNG","POT","POTHTML","POTX","PPA","PPS","PPSX","PPT","PPTHTML","PPTMHTML","PPTX","PPTXML","PST","PUB","PWZ","RTF","SLDM","SLDX","SLK","THMX","TIF","TIFF","TSX","TTF","TXT","VDW","VDX","VHD","VSD","VSDM","VSDX","VSIX","VSL","VSS","VSSM","VSSX","VST","VSTM","VSTX","VSU","VSW","VSX","WAV","WIZHTML","WMA","WMV","WPL","XLS","XLSHTML","XLSMHTML","XLSX","XLTHTML","XLTM","XLTX","XLW","XLXML","XPS","ZIP"],Dt=function(){function e(){this.map={},this.isWord=!1,this.isInitialized=!1}return e.prototype.search=function(e){return this.find(e,0,this)},e.prototype.init=function(){if(!this.isInitialized){for(var e=0,t=St;e<t.length;e++){var n=t[e];this.add(n,0,this)}this.isInitialized=!0}},e.prototype.add=function(t,n,a){if(n!==t.length)return a.map[t.charAt(n)]||(a.map[t.charAt(n)]=new e),this.add(t,n+1,a.map[t.charAt(n)]);a.isWord=!0},e.prototype.find=function(e,t,n){return t===e.length?!!n.isWord:!!n.map[e[t]]&&this.find(e,t+1,n.map[e.charAt(t)])},e}(),It=/([A-Z0-9_]|\.|%2E){1,50}(@|_AT_|%40)([A-Z0-9_]{1,50}(\.|_|%2E))+(COM|ORG|GOV|EDU)/,xt=/([A-Z]:|\\)(\\\\{0,1}\w+)+/,Ct=/((<HTML>)|(\{\\RTF)|(<\?XML)|(MIME-VERSION)|(<ASP:))/,Ot=function(){function e(){var t=[],n=!1,a=!0,i=!0,r=[],o=new Dt;Object(s.e)(e,this,function(e,s){function c(e){return e=(e=e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")).replace(/\-/g,"-?"),new RegExp(e)}function l(e,t){for(var n=0,a=e.split(" ");n<a.length;n++){var i=a[n];i.length>=4&&(!t||t&&-1===Object(d.t)(t,i))&&r.push(i)}}function u(e,t){if(!e||0===e.length||!t||0===t.length)return!1;var n=e.indexOf(t)-1,a=n+t.length+1;if(n>=-1&&a>=0){var i=e.charCodeAt(a);return n>-1?!f(e.charCodeAt(n))&&!f(i):!f(i)}return!1}function f(e){return e>=65&&e<=90||e>=97&&e<=122}function p(e){for(var t=0;t<e.length;t++)if(f(e.charCodeAt(t)))return!0;return!1}function m(e){return e.match(/MICROSOFT(\.|_|%2E)COM/)||e.match(/LINKEDIN(\.|_|%2E)COM/)?11:5}function _(e,t,n){if(n<0||n+t.length>=e.length)return!1;for(var a=0;a<t.length;a++)if(e[n+a]!==t[a])return!1;return!0}e.initialize=function(t){t?(i=!0!==t.disableAdvancedScans,void 0!==t.scanForUrls&&(a=!0===t.scanForUrls),t.context&&e.updateCommonContext(t.context)):Object(d.H)("PG:No Core"),o.init(),n=!0},e.isEnabled=function(){return n},e.setEnabled=function(e){return(n=e)===e},e.updateCommonContext=function(e){if(null===e&&Object(d.H)("PG:No Context"),e.UserName&&p(e.UserName)&&l(e.UserName,e.IgnoredNameParts),e.UserNames&&e.UserNames.length>0)for(var n=0,a=e.UserNames;n<a.length;n++){var r=a[n];p(r)&&l(r,e.IgnoredNameParts)}if(e.UserAlias&&p(e.UserAlias)&&t.push({stringIsolatedWord:e.UserAlias.replace(/[^a-zA-Z]/g,"").toUpperCase(),concern:19}),e.UserAliases&&e.UserAliases.length>0)for(var o=0,s=e.UserAliases;o<s.length;o++){var u=s[o];p(u)&&t.push({stringIsolatedWord:u.replace(/[^a-zA-Z]/g,"").toUpperCase(),concern:19})}if(e.MachineIds&&e.MachineIds.length>0)for(var f=0,m=e.MachineIds;f<m.length;f++){var _=m[f];t.push({stringValue:_.toUpperCase(),concern:14})}if(i&&e.OutOfScopeIdentifiers&&e.OutOfScopeIdentifiers.length>0)for(var h=0,b=e.OutOfScopeIdentifiers;h<b.length;h++){var g=b[h];t.push({regexpValue:c(g.toUpperCase()),concern:15})}},e.getAllPrivacyConcerns=function(e,n,s,c){var l=[],p=!1;c.length>1e3&&(c=c.substring(0,1e3),p=!0);var h=function(e){for(var t={hasAlphabets:!1,hasAtSign:!1,hasBackslash:!1,hasDash:!1,hasDot:!1,hasFileUrl:!1,hasFileSharingConcern:!1,hasFormatChars:!1,hasForwardSlash:!1,hasHttp:!1,hasPercentage:!1,hasSecurityAccessTokenConcern:!1,hasSecuritySignatureConcern:!1,hasUnderscore:!1,valueToCheck:e.toUpperCase()},n=t.valueToCheck,i=0;i<n.length;i++){var r=n.charAt(i);switch(t.hasAlphabets||(t.hasAlphabets=f(n.charCodeAt(i))),r){case"@":t.hasAtSign||(t.hasAtSign=i<n.length-3);break;case"\\":t.hasBackslash||(t.hasBackslash=!0);break;case"-":t.hasDash||(t.hasDash=!0);break;case".":t.hasDot||(t.hasDot=i<n.length-2);break;case"<":case"{":t.hasFormatChars||(t.hasFormatChars=!0);break;case"/":t.hasForwardSlash||(t.hasForwardSlash=!0),t.hasHttp&&a&&!t.hasFileSharingConcern&&(i<n.length-16&&(t.hasFileSharingConcern=_(n,"WOPI.ASHX/FILES",i+1),t.hasFileSharingConcern&&(i+=14)),!t.hasFileSharingConcern&&i<n.length-12&&(t.hasFileSharingConcern=_(n,"WOPI/FILES/",i+1),t.hasFileSharingConcern&&(i+=10)));break;case"_":t.hasUnderscore||(t.hasUnderscore=!0),!t.hasAtSign&&i<n.length-4&&(t.hasAtSign="A"===n.charAt(i+1)&&"T"===n.charAt(i+2)&&"_"===n.charAt(i+3),t.hasAtSign&&(i+=2));break;case"A":t.hasForwardSlash&&t.hasHttp&&!t.hasSecurityAccessTokenConcern&&(i<n.length-14&&(t.hasSecurityAccessTokenConcern=_(n,"WSACCESSKEYID",i+1),t.hasSecurityAccessTokenConcern&&(i+=12)),!t.hasSecurityAccessTokenConcern&&i<n.length-12&&(t.hasSecurityAccessTokenConcern=_(n,"CCESS_TOKEN",i+1),t.hasSecurityAccessTokenConcern&&(i+=10)));break;case"D":t.hasForwardSlash&&t.hasHttp&&a&&!t.hasFileSharingConcern&&i<n.length-12&&(t.hasFileSharingConcern=_(n,"ROPBOX.COM/",i+1),t.hasFileSharingConcern&&(i+=10));break;case"F":!t.hasFileUrl&&i<n.length-7&&(t.hasFileUrl=_(n,"ILE://",i+1),t.hasFileUrl&&(i+=5));break;case"%":t.hasPercentage||(t.hasPercentage=!0),!t.hasAtSign&&i<n.length-3&&(t.hasAtSign="4"===n.charAt(i+1)&&"0"===n.charAt(i+2),t.hasAtSign&&(i+=1));break;case"M":!t.hasFormatChars&&i<n.length-12&&(t.hasFormatChars=_(n,"IME-VERSION",i+1),t.hasFormatChars&&(i+=10));break;case"H":!t.hasHttp&&i<n.length-8&&(t.hasHttp=_(n,"TTP://",i+1)||_(n,"TTPS://",i+1),t.hasHttp&&(i+=5));break;case"S":t.hasForwardSlash&&t.hasHttp&&!t.hasSecuritySignatureConcern&&i<n.length-9&&(t.hasSecuritySignatureConcern=_(n,"IGNATURE",i+1),t.hasSecuritySignatureConcern&&(i+=7))}}return t}(c);if(!h.hasAlphabets)return l;if(h.hasForwardSlash&&i&&a&&(h.hasHttp||h.hasFileUrl)&&l.push({Concern:18,EventName:e,BaseType:n,FieldName:s}),h.hasFileUrl&&a&&l.push({Concern:8,EventName:e,BaseType:n,FieldName:s}),h.hasFileSharingConcern&&l.push({Concern:8,EventName:e,BaseType:n,FieldName:s}),h.hasSecurityAccessTokenConcern&&l.push({Concern:22,EventName:e,BaseType:n,FieldName:s}),h.hasSecuritySignatureConcern&&l.push({Concern:23,EventName:e,BaseType:n,FieldName:s}),h.hasBackslash){var b=function(e,t,n,a){var i=a.match(xt);if(!i)return null;var r=[],o=i[0];return o.length>4&&-1===o.search(/:\\U00/)&&-1===o.search(/(\\)+SOFTWARE(\\)+MICROSOFT(\\)+/)&&r.push({Concern:4,EventName:e,BaseType:t,FieldName:n}),r}(e,n,s,h.valueToCheck);b&&(l=l.concat(b))}h.hasFormatChars&&Ct.test(h.valueToCheck)&&l.push({Concern:1,EventName:e,BaseType:n,FieldName:s}),h.hasDot&&(b=function(e,t,n,a,i){for(var r=a.indexOf(".");-1!==r&&a.length>r;){var s=a.indexOf(".",r+1),c=a.indexOf("_",r+1),d=a.length;s>0&&c>0?d=Math.min(c,s):s>0?d=s:c>0&&(d=c);var l=d-r;if(l>=3&&l<=5){var u=a.substring(r+1,r+l);if(o.search(u)&&(-1!=s||!a.endsWith(u)||!i))return{Concern:7,EventName:e,BaseType:t,FieldName:n}}r=s}return null}(e,n,s,h.valueToCheck,p),b&&l.push(b));var g=!1;if(h.hasAtSign&&(h.hasDot||h.hasUnderscore||h.hasPercentage)&&(g=It.test(h.valueToCheck))){var v=h.valueToCheck.match(It)[0];g&&l.push({Concern:m(v),EventName:e,BaseType:n,FieldName:s})}var y=function(e,n,a,i){for(var r=[],o=!1,s=0;s<t.length;s++){var c=t[s],d=c.stringValue;if(d&&-1!==i.indexOf(d))r.push({Concern:c.concern,EventName:e,BaseType:n,FieldName:a});else{var l=c.stringIsolatedWord;if(l&&u(i,l))r.push({Concern:c.concern,EventName:e,BaseType:n,FieldName:a}),o=o||19===c.concern;else{var f=c.regexpValue;f&&f.test(i)&&r.push({Concern:c.concern,EventName:e,BaseType:n,FieldName:a})}}}return[r,o]}(e,n,s,h.valueToCheck);y[0]&&y[0].length>0&&(l=l.concat(y[0]));var S=y[1];if(!g){if(!S&&void 0!==r&&r.length>0){for(var D=!1,I=0;I<r.length;I++)if(u(c,r[I])){D=!0;break}D&&l.push({Concern:21,EventName:e,BaseType:n,FieldName:s})}h.valueToCheck.length>10&&(Object(d.T)(h.valueToCheck,"_SSPI")&&!Object(d.T)(h.valueToCheck,"*_SSPI")||Object(d.T)(h.valueToCheck,"_AD")&&!Object(d.T)(h.valueToCheck,"*_AD"))&&l.push({Concern:m(h.valueToCheck),EventName:e,BaseType:n,FieldName:s})}return l}})}return e.prototype.initialize=function(e){},e}(),wt=function(e){function t(){var n=e.call(this)||this;n.identifier="PrivacyGuardPlugin",n.priority=499,n.version="3.2.15";var a,i,r,o,c,l,u,f,p,m,_,h=null,b=null,g=null,v=[];return Object(s.e)(t,n,function(e,t){function n(e){(a=new Ot).initialize(e),e.notificationEventName&&Object(d.v)(e.notificationEventName)&&(o=e.notificationEventName),e.summaryEventName&&Object(d.v)(e.summaryEventName)&&(c=e.summaryEventName),e.iKey&&Object(d.v)(e.iKey)&&(r=e.iKey),a.setEnabled(!1!==e.enabled),l=!1!==e.useEventFieldPrefix,u=!0===e.useAbsoluteFieldName}function s(t,n,i,r){if(!e.isEnabled())return[];var o=[];return Object(d.h)(r)||Object(d.O)(r,function(e,r){var c=e;u&&i&&i.length>0&&(c=i+"."+e),Object(d.v)(r)?(_++,o=o.concat(a.getAllPrivacyConcerns(t,n,c,r))):r&&Object(d.g)(r)&&(o=o.concat(s(t,n,c,r)))}),o}function y(e){var t=!1;return Object(d.e)(v,function(n){e.Concern!==n.Concern||e.EventName!==n.EventName||e.FieldName!==n.FieldName||e.BaseType!==n.BaseType&&e.BaseType&&n.BaseType||(t=!0)}),t}function S(e){return e?{PG_ConcernsNotified:f,PG_EventsIgnored:p,PG_EventsInspected:m,PG_FieldsInspected:_}:{ConcernsNotified:f,EventsIgnored:p,EventsInspected:m,FieldsInspected:_}}function D(){a=null,i=null,r=null,o="PrivacyConcern",c="PrivacyGuardSummary",l=!0,u=!1,f=0,p=0,m=0,_=0}function I(e){switch(e){case 0:return"None";case 6:return"FieldNameImpliesLocation";case 11:return"InternalEmailAddress";case 15:return"OutOfScopeIdentifier";case 14:return"MachineName";case 20:return"UserDomain";case 12:return"IPAddress";case 5:return"ExternalEmailAddress";case 21:return"UserName";case 19:return"UserAlias";case 4:return"Directory";case 18:return"Url";case 7:return"FileNameOrExtension";case 1:return"Content";case 8:return"FileSharingUrl";case 17:return"Security";case 22:return"AccessToken";case 23:return"Signature"}return"Missing String value for "+e}D(),e.initialize=function(a,r,o){t.initialize(a,r,o);var s=a.extensionConfig[e.identifier];s?(i=r,n(h||s),Object(d.h)(b)||e.setEnabled(b),Object(d.h)(g)||e.updateCommonContext(g)):(Object(L.n)(r.logger,1,73,"Configuration not provided, PrivacyGuard disabled."),t.setInitialized(!1))},e.reset=function(e){(h=e)&&n(h)},e.isEnabled=function(){return a&&a.isEnabled()},e.isPrivacyGuardEnabled=function(){return e.isEnabled()},e.setEnabled=function(e){return b=e,a&&a.setEnabled(e)},e.updateCommonContext=function(e){g=e,a&&a.updateCommonContext(g)},e.processTelemetry=function(t,n){Object(Ae.t)(i,function(){return"PrivacyGuard:_processTelemetry"},function(){if(e.isEnabled()&&t.name!==o&&t.name!==c)if(t.data){var n;m++,Object(d.v)(t.baseType)?n=t.baseType:t.data&&t.data.baseType&&Object(d.v)(t.data.baseType)&&(n=t.data.baseType);var a=s(t.name,n,"",t.data);a.length>0&&e.notifyConcerns(a)}else p++}),e.processNext(t,n)},e.sendSummaryEvent=function(e){var t={name:c,ext:{metadata:{privTags:33554432,privLevel:110}}};t.data=S(l),r&&(t.iKey=r),i.track(t),e&&(f=0,p=0,m=0,_=0)},e.addIgnoredConcern=function(e){y(e)||v.push(e)},e.addIgnoredConcerns=function(t){if(0!==t.length)for(var n=0,a=t;n<a.length;n++){var i=a[n];e.addIgnoredConcern(i)}},e.notifyConcerns=function(e){Object(d.e)(e,function(e){if(!y(e)){var t={name:o,ext:{metadata:{privTags:33554432,privLevel:110}}};t.data=l?{PG_EventName:e.EventName,PG_FieldName:e.FieldName,PG_TypeAsText:I(e.Concern),PG_BaseType:e.BaseType}:{EventName:e.EventName,FieldName:e.FieldName,TypeAsText:I(e.Concern),BaseType:e.BaseType},r&&(t.iKey=r),i.track(t),f++}})},e._doTeardown=function(e,t){D()},e.getStats=function(){return S(!1)}}),n}return Object(o.e)(t,e),t.prototype.initialize=function(e,t,n){},t}(l.e),Et=n(202),At=n(191),Lt=n(254),kt=n(119),Mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="StringifyProperties",t.version="1.0",t}return Object(i.a)(t,e),t._stringifyObject=function(e){for(var n in e)if(void 0===e[n]||null===e[n]||"object"==typeof e[n])t._stringifyObject(e[n]);else try{e[n]=e[n].toString()}catch(t){e[n]="StringifyProperties toString error"}},t.prototype.processTelemetry=function(e,n){n=this._getTelCtx(n),t._stringifyObject(e.data),this.processNext(e,n)},t}(l.e),Pt=new RegExp("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)","gi"),Tt={defaultPIIScrubber:function(e){return e.includes("@")&&(e=e.replace(Pt,"[SCRUBBED EMAIL]")),e},truncate:function(e){return e.substring(0,20)+"[SCRUBBED]"},drop:function(e){return""}},Ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="DataScrubber",t.version="1.0",t._config={},t}return Object(i.a)(t,e),t.prototype.initialize=function(t,n,a){e.prototype.initialize.call(this,t,n,a),this._config=this._getTelCtx().getExtCfg(this.identifier)},t.prototype.processTelemetry=function(e,t){if(t=this._getTelCtx(t),this._config.scrubberFieldMap)for(var n=0,a=Object.keys(this._config.scrubberFieldMap);n<a.length;n++){var i=a[n],r=this._config.scrubberFieldMap[i],o=Tt[i];r&&o&&this.scrubEvent(e,o,r)}this.processNext(e,t)},t.prototype.scrubEvent=function(e,t,n){this._scrubObject(e.data||{},t,n)},t.prototype._scrubObject=function(e,t,n){if(this._scrubFields(e,t,n.fields),n.nestedFields)for(var a=0,i=Object.keys(n.nestedFields);a<i.length;a++){var r=i[a];"object"==typeof e[r]&&this._scrubObject(e[r],t,n.nestedFields[r])}},t.prototype._scrubFields=function(e,t,n){for(var a=0,i=n;a<i.length;a++){var r=i[a];"string"==typeof e[r]&&(e[r]=t(e[r]))}},t}(l.e),Ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="DebugTelemetry",t.version="1.0",t}return Object(i.a)(t,e),t._getEventId=function(e){var t,n,a,i,r,o,s;return[e.name,null===(t=e.data)||void 0===t?void 0:t.Name,null===(n=e.data)||void 0===n?void 0:n.Scenario,null===(a=e.data)||void 0===a?void 0:a.WebLog_EventType,null===(i=e.data)||void 0===i?void 0:i.ResultType,null===(r=e.data)||void 0===r?void 0:r.PG_EventName,null===(o=e.data)||void 0===o?void 0:o.PG_FieldName,null===(s=e.data)||void 0===s?void 0:s.PG_TypeAsText].reduce(function(e,t){return e?e.concat(t?"".concat(" ").concat(t):""):t})||"ev_<unknown?>"},t._flattenAndStringifyEvent=function(e,t){var n={};if(t<=0)return e;for(var a=function(t){Object.keys(e).forEach(function(a){var i=e[a];"object"==typeof i?1===t?n[a]=JSON.stringify(e[a]):Object.keys(i).forEach(function(e){n["".concat(a,".").concat(e)]=i[e]}):n[a]=e[a]}),e=Object(i.e)({},n),n={}},r=t;r>0;r--)a(r);return e},t._logGroup=function(e,t,n,a){t?console.groupCollapsed("%c".concat(e),n):console.group("%c".concat(e),n);try{a()}catch(e){console.error(e)}console.groupEnd()},t._logTable=function(e,n,a){t._logGroup(e,a,"font-size:12px;font-weight:bold",function(){console.table(n)})},t.prototype.processTelemetry=function(e,t){var n;if(t=this._getTelCtx(t),void 0===this._isUploadingTelemetry){var a=t.getCfg();this._isUploadingTelemetry=!(null===(n=a.channelConfiguration)||void 0===n?void 0:n.disableTelemetry)}this._logEvent(e),this.processNext(e,t)},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.flush=function(e,t){},t.prototype._getGroupCSS=function(e){var t="font-size:12px;font-weight:bold;border:1px solid gray;padding:2px;border-radius:5px;";return"ev_privacyguard"===e.name?t+="border-color:#ff0000; border-radius: 3px":void 0!==this._isUploadingTelemetry&&(t+=this._isUploadingTelemetry?"border-color:#00ff00;":"border-color:#077fe8"),t},t.prototype._logEvent=function(e){var n=t._getEventId(e),a=t._flattenAndStringifyEvent(e.ext||{},2),i=t._flattenAndStringifyEvent(e.data||{},2),r=this._getGroupCSS(e);t._logGroup(n,!0,r,function(){t._logTable("Data Fields",i,!1),t._logTable("Ext Fields",a,!0),console.log("Raw event:\n%o",e)})},t}(l.e),Ht="MicrosoftApplicationsTelemetryDeviceId",Rt=["ev_customerpromise","ev_qos","ev_engagement","ev_experimentflight","ev_pageusage","ev_rumonedataupload"],Nt=function(){function e(t,n,a){var o,s,c,d,l,u,f,p,m,_,h=this;this._seenEventNames=new Set(Rt),this._privacyGuard=new wt,this.logEvent=function(t){var n,a,r,o,s,c,d,l;if(!((null===(n=h._loggerConfig)||void 0===n?void 0:n.reduceRumoneLogging)&&(null===(a=t.eventName)||void 0===a?void 0:a.indexOf("RUMOneDataUpload"))>-1)||"SPAppBar"!==(null===(o=null===(r=t.data)||void 0===r?void 0:r.dictionary)||void 0===o?void 0:o.ScenarioId)&&""!==(null===(c=null===(s=t.data)||void 0===s?void 0:s.dictionary)||void 0===c?void 0:c.ScenarioId)){var u;t.vector&&(u=new Et.e({root:t.vector.root,current:t.vector.parent},t.vector.current));var f=Object(At.e)(t),p=f.name,m=f.values,_=Object(i.e)(Object(i.e)({},m),{CorrelationVector:null==u?void 0:u.toString()}),b=p.toLowerCase();(null===(d=h._loggerConfig)||void 0===d?void 0:d.enablePrivacyGuard)&&(h._seenEventNames.has(b)||(h._privacyGuard.addIgnoredConcern(e._getIgnoredConcernForEventName(b)),h._seenEventNames.add(b)));var g,v="vivaanalytics"===_.Engagement_extraData_baseType;_.Name&&("AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"===(g=_.Name)||"SPO.DashboardWebPart.Load"===g||"AdaptiveCardExtension.CardAction"===g||"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"===g||"TeamsSiteHeader.RefreshButtonClicked"===g||"TeamsSiteHeader.CopyLinkButtonClicked.successful"===g||"TeamsSiteHeader.GoToBrowserButtonClicked"===g||"VivaHome.Resources.CompanyLinks.Link.NavigationComponent.Click"===g||v)&&(v&&delete _.Engagement_extraData_baseType,_.baseType="vivaanalytics");var y={};(null===(l=h._loggerConfig)||void 0===l?void 0:l.enablePersistence)&&(y.persistence="Critical"===t.data.persistence?2:1),h._logger.track(Object(i.e)({name:b,data:_},y))}},this._context=n,this._loggerConfig=a,this._postChannel=new Ee.e,this._propertyStore=null===(s=this._loggerConfig)||void 0===s?void 0:s.propertyStorageOverride,this._logger=new r.e,this._propertiesPlugin=new we;var b=new Mt,g=new Ut,v=new yt,y=[this._postChannel],S="odsp_1ds_offline";if((null===(c=this._loggerConfig)||void 0===c?void 0:c.disableTelemetry)&&(y.pop(),t="00000000-0000-0000-0000-000000000000",S=S.concat("_dev")),null===(d=this._loggerConfig)||void 0===d?void 0:d.isDebug){var D=new Ft;y.push(D)}var I={storageKey:S,indexedDbName:S,providers:[Re.IndexedDb,Re.LocalStorage],maxStorageItems:1e4},x={scrubberFieldMap:Object(i.e)({defaultPIIScrubber:e._getDefaultScrubbingFields()},null===(l=this._loggerConfig)||void 0===l?void 0:l.scrubberFieldMap)};(null===(u=this._loggerConfig)||void 0===u?void 0:u.enableStorageChannel)&&y.unshift(v);var C=Object(i.e)({instrumentationKey:t,enableCompoundKey:!0,channels:[y],extensionConfig:(o={},o[this._privacyGuard.identifier]={notificationEventName:"ev_privacyguard",iKey:t},o[this._propertiesPlugin.identifier]=this._propertiesPluginConfig,o[g.identifier]=x,o[v.identifier]=I,o),channelConfiguration:{disableTelemetry:!!(null===(f=this._loggerConfig)||void 0===f?void 0:f.disableTelemetry)}},this._loggerConfig);this._propertiesPlugin.initialize(C,this._logger,[]),this._initializeProperties(n);var O=[this._propertiesPlugin];(null===(p=this._loggerConfig)||void 0===p?void 0:p.disableDataStringify)||(b.initialize(C,this._logger,[]),O=O.concat(b)),(null===(m=this._loggerConfig)||void 0===m?void 0:m.disableDataScrubbing)||(g.initialize(C,this._logger,[]),O=O.concat(g)),(null===(_=this._loggerConfig)||void 0===_?void 0:_.enablePrivacyGuard)&&(this._initializePrivacyGuard(),O=O.concat(this._privacyGuard)),this._logger.initialize(C,O)}return e._getDefaultScrubbingFields=function(){return{fields:["CustomerPromise_extraData_Veto","CustomerPromise_extraData_Endpoint","CustomerPromise_extraData_Product","CustomerPromise_extraData_Pillar","CustomerPromise_extraData_errorMessage","CustomerPromise_extraData_errorStack","caughtError_Stack","Error","ErrorCode","Qos_extraData_stack","Qos_extraData_trace","Trace_message","Veto"]}},e._getIgnoredConcernForEventName=function(e){return{Concern:5,EventName:e,FieldName:"UserInfo.Id"}},e.prototype.updateContext=function(e){this._context=Object(i.e)(Object(i.e)({},this._context),e),this._updateProperties(e)},e.prototype.flush=function(e,t){this._logger.flush(e,t)},e.prototype.setOffline=function(e){e?this._postChannel.pause():this._postChannel.resume(),this._propertiesPlugin.setProperty("Debug.IsOffline",e)},Object.defineProperty(e.prototype,"_propertiesPluginConfig",{get:function(){var e;return Object(i.e)({env:this._context.Environment,populateBrowserInfo:!0,populateOperatingSystemInfo:!0},null===(e=this._loggerConfig)||void 0===e?void 0:e.propertyConfiguration)},enumerable:!1,configurable:!0}),e.prototype._initializeProperties=function(e){var t,n,a,i;this._updateProperties(e);var r=(null===(t=this._propertyStore)||void 0===t?void 0:t.getProperty("AppInfo.Language"))||"undefined"!=typeof document&&(null===(n=null===document||void 0===document?void 0:document.documentElement)||void 0===n?void 0:n.lang)||"";this._propertiesPlugin.setProperty("AppInfo.Language",r);var o=(null===(a=this._logger.getCookieMgr())||void 0===a?void 0:a.get(Ht))||(null===(i=this._propertyStore)||void 0===i?void 0:i.getProperty(Ht))||"";this._propertiesPlugin.setProperty("DeviceInfo.Id",o),this._propertiesPlugin.setProperty("Debug.IsWorker",!!self.WorkerGlobalScope),this._propertiesPlugin.getPropertiesContext().user.localId=this._getPrefixedUserId(),this._propertiesPlugin.getPropertiesContext().app.ver=e.Version,this._propertiesPlugin.getPropertiesContext().app.locale=r},e.prototype._updateProperties=function(e){var t=this,n=e.Session,a=e.Version,r=e.OSName,o=e.OSVersion,s=e.Market,c=e.UserId,d=e.Manifest,l=Object(i.r)(e,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),u=Object(i.e)({"AppInfo.Session":n,"AppInfo.Manifest":d,"AppInfo.Version":a,"UserInfo.Language":s||"","UserInfo.Id":c&&Object(Lt.e)(c),"DeviceInfo.OsName":r,"DeviceInfo.OsVersion":o},l);Object.keys(u).forEach(function(e){var n=u[e];null!=n&&t._propertiesPlugin.setProperty(Object(kt.e)(e),n)})},e.prototype._getUserIdPrefix=function(){var e,t,n,a,i;return"Consumer"===(null===(e=this._context)||void 0===e?void 0:e.AccountType)||"ConsumerAnonymous"===(null===(t=this._context)||void 0===t?void 0:t.AccountType)||"ConsumerOnSPO"===(null===(n=this._context)||void 0===n?void 0:n.AccountType)?"m:":"Business"===(null===(a=this._context)||void 0===a?void 0:a.AccountType)||"BusinessAnonymous"===(null===(i=this._context)||void 0===i?void 0:i.AccountType)?"i:":"c:"},e.prototype._getPrefixedUserId=function(){var e=this._context.UserId;if(e&&e.length>2&&":"!==e[1]){var t=this._getUserIdPrefix();return"".concat(t).concat(e)}return e},e.prototype._initializePrivacyGuard=function(){var t=this;this._seenEventNames.forEach(function(n){t._privacyGuard.addIgnoredConcern(e._getIgnoredConcernForEventName(n))})},e}(),Bt=function(){var e=this;this._dataStore={},this.getProperty=function(t){return e._dataStore[t]},this.setProperty=function(t,n){return e._dataStore[t]=n}}}}]);