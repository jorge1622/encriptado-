/*! For license information please see owl.2495ec0588062b40c148.js.LICENSE.txt */
var Microsoft;!function(){"use strict";var n,e,t,o,i={1328:function(n,e,t){t.d(e,{X:function(){return u}});var o=t(9055),i=t(6768),r=t(823),u=function(n){function e(e){var t=n.call(this)||this;return t.H=e,t}return o.ZT(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype.A=function(e){var t=n.prototype.A.call(this,e);return t&&!t.closed&&e.next(this.H),t},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new r.N;return this.H},e.prototype.next=function(e){n.prototype.next.call(this,this.H=e)},e}(i.xQ)},826:function(n,e,t){t.d(e,{y:function(){return l}});var o=t(8267),i=t(3086),r=t(4932),u=t(9604);function a(n){return n}var s=t(6032),l=function(){function n(n){this.F=!1,n&&(this.A=n)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(n,e,t){var u=this.operator,a=function(n,e,t){if(n){if(n instanceof o.L)return n;if(n[i.b])return n[i.b]()}return n||e||t?new o.L(n,e,t):new o.L(r.c)}(n,e,t);if(u?a.add(u.call(a,this.source)):a.add(this.source||s.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this.A(a):this.P(a)),s.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},n.prototype.P=function(n){try{return this.A(n)}catch(e){s.v.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=e),function(n){for(;n;){var e=n,t=e.closed,i=e.destination,r=e.isStopped;if(t||r)return!1;n=i&&i instanceof o.L?i:null}return!0}(n)&&n.error(e)}},n.prototype.forEach=function(n,e){var t=this;return new(e=c(e))((function(e,o){var i;i=t.subscribe((function(e){try{n(e)}catch(n){o(n),i&&i.unsubscribe()}}),o,e)}))},n.prototype.A=function(n){var e=this.source;return e&&e.subscribe(n)},n.prototype[u.L]=function(){return this},n.prototype.pipe=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return 0===n.length?this:(0===(t=n).length?a:1===t.length?t[0]:function(n){return t.reduce((function(n,e){return e(n)}),n)})(this);var t},n.prototype.toPromise=function(n){var e=this;return new(n=c(n))((function(n,t){var o;e.subscribe((function(n){return o=n}),(function(n){return t(n)}),(function(){return n(o)}))}))},n.create=function(e){return new n(e)},n}();function c(n){if(n||(n=s.v.Promise||Promise),!n)throw new Error("no Promise impl found");return n}},4932:function(n,e,t){t.d(e,{c:function(){return r}});var o=t(6032),i=t(8750),r={closed:!0,next:function(n){},error:function(n){if(o.v.useDeprecatedSynchronousErrorHandling)throw n;(0,i.z)(n)},complete:function(){}}},6768:function(n,e,t){t.d(e,{xQ:function(){return d}});var o=t(9055),i=t(826),r=t(8267),u=t(1492),a=t(823),s=function(n){function e(e,t){var o=n.call(this)||this;return o.subject=e,o.subscriber=t,o.closed=!1,o}return o.ZT(e,n),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var n=this.subject,e=n.observers;if(this.subject=null,e&&0!==e.length&&!n.isStopped&&!n.closed){var t=e.indexOf(this.subscriber);-1!==t&&e.splice(t,1)}}},e}(u.w),l=t(3086),c=function(n){function e(e){var t=n.call(this,e)||this;return t.destination=e,t}return o.ZT(e,n),e}(r.L),d=function(n){function e(){var e=n.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o.ZT(e,n),e.prototype[l.b]=function(){return new c(this)},e.prototype.lift=function(n){var e=new f(this,this);return e.operator=n,e},e.prototype.next=function(n){if(this.closed)throw new a.N;if(!this.isStopped)for(var e=this.observers,t=e.length,o=e.slice(),i=0;i<t;i++)o[i].next(n)},e.prototype.error=function(n){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=n,this.isStopped=!0;for(var e=this.observers,t=e.length,o=e.slice(),i=0;i<t;i++)o[i].error(n);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.N;this.isStopped=!0;for(var n=this.observers,e=n.length,t=n.slice(),o=0;o<e;o++)t[o].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype.P=function(e){if(this.closed)throw new a.N;return n.prototype.P.call(this,e)},e.prototype.A=function(n){if(this.closed)throw new a.N;return this.hasError?(n.error(this.thrownError),u.w.EMPTY):this.isStopped?(n.complete(),u.w.EMPTY):(this.observers.push(n),new s(this,n))},e.prototype.asObservable=function(){var n=new i.y;return n.source=this,n},e.create=function(n,e){return new f(n,e)},e}(i.y),f=function(n){function e(e,t){var o=n.call(this)||this;return o.destination=e,o.source=t,o}return o.ZT(e,n),e.prototype.next=function(n){var e=this.destination;e&&e.next&&e.next(n)},e.prototype.error=function(n){var e=this.destination;e&&e.error&&this.destination.error(n)},e.prototype.complete=function(){var n=this.destination;n&&n.complete&&this.destination.complete()},e.prototype.A=function(n){return this.source?this.source.subscribe(n):u.w.EMPTY},e}(d)},8267:function(n,e,t){t.d(e,{L:function(){return c}});var o=t(9055),i=t(8973),r=t(4932),u=t(1492),a=t(3086),s=t(6032),l=t(8750),c=function(n){function e(t,o,i){var u=n.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=r.c;break;case 1:if(!t){u.destination=r.c;break}if("object"==typeof t){t instanceof e?(u.syncErrorThrowable=t.syncErrorThrowable,u.destination=t,t.add(u)):(u.syncErrorThrowable=!0,u.destination=new d(u,t));break}default:u.syncErrorThrowable=!0,u.destination=new d(u,t,o,i)}return u}return o.ZT(e,n),e.prototype[a.b]=function(){return this},e.create=function(n,t,o){var i=new e(n,t,o);return i.syncErrorThrowable=!1,i},e.prototype.next=function(n){this.isStopped||this._(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this.B(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.Y())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},e.prototype._=function(n){this.destination.next(n)},e.prototype.B=function(n){this.destination.error(n),this.unsubscribe()},e.prototype.Y=function(){this.destination.complete(),this.unsubscribe()},e.prototype.$=function(){var n=this.nn;return this.nn=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.nn=n,this},e}(u.w),d=function(n){function e(e,t,o,u){var a,s=n.call(this)||this;s.en=e;var l=s;return(0,i.m)(t)?a=t:t&&(a=t.next,o=t.error,u=t.complete,t!==r.c&&(l=Object.create(t),(0,i.m)(l.unsubscribe)&&s.add(l.unsubscribe.bind(l)),l.unsubscribe=s.unsubscribe.bind(s))),s.tn=l,s._=a,s.B=o,s.Y=u,s}return o.ZT(e,n),e.prototype.next=function(n){if(!this.isStopped&&this._){var e=this.en;s.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._,n)&&this.unsubscribe():this.__tryOrUnsub(this._,n)}},e.prototype.error=function(n){if(!this.isStopped){var e=this.en,t=s.v.useDeprecatedSynchronousErrorHandling;if(this.B)t&&e.syncErrorThrowable?(this.__tryOrSetError(e,this.B,n),this.unsubscribe()):(this.__tryOrUnsub(this.B,n),this.unsubscribe());else if(e.syncErrorThrowable)t?(e.syncErrorValue=n,e.syncErrorThrown=!0):(0,l.z)(n),this.unsubscribe();else{if(this.unsubscribe(),t)throw n;(0,l.z)(n)}}},e.prototype.complete=function(){var n=this;if(!this.isStopped){var e=this.en;if(this.Y){var t=function(){return n.Y.call(n.tn)};s.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(n,e){try{n.call(this.tn,e)}catch(n){if(this.unsubscribe(),s.v.useDeprecatedSynchronousErrorHandling)throw n;(0,l.z)(n)}},e.prototype.__tryOrSetError=function(n,e,t){if(!s.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this.tn,t)}catch(e){return s.v.useDeprecatedSynchronousErrorHandling?(n.syncErrorValue=e,n.syncErrorThrown=!0,!0):((0,l.z)(e),!0)}return!1},e.prototype.rn=function(){var n=this.en;this.tn=null,this.en=null,n.unsubscribe()},e}(c)},1492:function(n,e,t){t.d(e,{w:function(){return a}});var o=t(6839),i=t(5149),r=t(8973),u=function(){function n(n){return Error.call(this),this.message=n?n.length+" errors occurred during unsubscription:\n"+n.map((function(n,e){return e+1+") "+n.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=n,this}return n.prototype=Object.create(Error.prototype),n}(),a=function(){function n(n){this.closed=!1,this.nn=null,this.un=null,n&&(this.an=!0,this.rn=n)}var e;return n.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this,a=t.nn,l=t.an,c=t.rn,d=t.un;if(this.closed=!0,this.nn=null,this.un=null,a instanceof n)a.remove(this);else if(null!==a)for(var f=0;f<a.length;++f)a[f].remove(this);if((0,r.m)(c)){l&&(this.rn=void 0);try{c.call(this)}catch(n){e=n instanceof u?s(n.errors):[n]}}if((0,o.k)(d)){f=-1;for(var v=d.length;++f<v;){var h=d[f];if((0,i.K)(h))try{h.unsubscribe()}catch(n){e=e||[],n instanceof u?e=e.concat(s(n.errors)):e.push(n)}}}if(e)throw new u(e)}},n.prototype.add=function(e){var t=e;if(!e)return n.EMPTY;switch(typeof e){case"function":t=new n(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof n)){var o=t;(t=new n).un=[o]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=t.nn;if(null===i)t.nn=this;else if(i instanceof n){if(i===this)return t;t.nn=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}var r=this.un;return null===r?this.un=[t]:r.push(t),t},n.prototype.remove=function(n){var e=this.un;if(e){var t=e.indexOf(n);-1!==t&&e.splice(t,1)}},n.EMPTY=((e=new n).closed=!0,e),n}();function s(n){return n.reduce((function(n,e){return n.concat(e instanceof u?e.errors:e)}),[])}},6032:function(n,e,t){t.d(e,{v:function(){return i}});var o=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){o=n},get useDeprecatedSynchronousErrorHandling(){return o}}},9604:function(n,e,t){t.d(e,{L:function(){return o}});var o=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},3086:function(n,e,t){t.d(e,{b:function(){return o}});var o=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},823:function(n,e,t){t.d(e,{N:function(){return o}});var o=function(){function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n}()},8750:function(n,e,t){function o(n){setTimeout((function(){throw n}),0)}t.d(e,{z:function(){return o}})},6839:function(n,e,t){t.d(e,{k:function(){return o}});var o=function(){return Array.isArray||function(n){return n&&"number"==typeof n.length}}()},8973:function(n,e,t){function o(n){return"function"==typeof n}t.d(e,{m:function(){return o}})},5149:function(n,e,t){function o(n){return null!==n&&"object"==typeof n}t.d(e,{K:function(){return o}})},9055:function(n,e,t){t.d(e,{ZT:function(){return i}});var o=function(n,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])},o(n,e)};function i(n,e){function t(){this.constructor=n}o(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}},6709:function(n,e,t){t.d(e,{CR:function(){return a},Jh:function(){return r},XA:function(){return u},ev:function(){return s},mG:function(){return i},pi:function(){return o}});var o=function(){return o=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},o.apply(this,arguments)};function i(n,e,t,o){return new(t||(t=Promise))((function(i,r){function u(n){try{s(o.next(n))}catch(n){r(n)}}function a(n){try{s(o.throw(n))}catch(n){r(n)}}function s(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(u,a)}s((o=o.apply(n,e||[])).next())}))}function r(n,e){var t,o,i,r,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(u=0)),u;)try{if(t=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,o=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){u.label=a[1];break}if(6===a[0]&&u.label<i[1]){u.label=i[1],i=a;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(a);break}i[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(n,u)}catch(n){a=[6,n],o=0}finally{t=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function u(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,i,r=t.call(n),u=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)u.push(o.value)}catch(n){i={error:n}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(i)throw i.error}}return u}function s(n,e,t){if(t||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))}Object.create,Object.create},7783:function(n,e,t){var o;t.d(e,{O:function(){return o}}),function(n){n.blurFocus="blurFocus",n.boot="boot",n.completeCreateNew="completeCreateNew",n.continueAccessibilityLoop="continueAccessibilityLoop",n.createNew="createNew",n.dispose="dispose",n.grabFocus="grabFocus",n.moveToFolder="moveToFolder",n.popState="popState",n.sendChannelId="sendChannelId",n.sendConvId="sendConvId",n.teamsUsersReply="teamsUsersReply",n.teamsUserMentionReply="teamsUserMentionReply",n.backButtonPressed="backButtonPressed",n.getClientUrl="getClientUrl",n.getWebUrl="getWebUrl",n.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",n.rename="rename",n.completeSharedFilePicker="completeSharedFilePicker",n.sendAccessToken="sendAccessToken",n.sendAuthToken="sendAuthToken",n.sendCustomAuthConfig="sendCustomAuthConfig",n.sendEmbeddedViewUrl="sendEmbeddedViewUrl",n.sendFrameTrustResult="sendFrameTrustResult",n.sendHWRTelemetry="sendHWRTelemetry",n.sendSessionInfo="sendSessionInfo",n.sendUserAccessAndPermissions="sendUserAccessAndPermissions",n.sendWopiInfo="sendWopiInfo",n.sendDavUrl="sendDavUrl",n.switchMode="switchMode",n.signalShared="signalShared",n.postWacToken="postWacToken"}(o||(o={}))},6938:function(n,e,t){var o;t.d(e,{L8:function(){return d}}),function(n){n[n.Trace=0]="Trace",n[n.Assert=1]="Assert"}(o||(o={}));var i,r,u=t(280),a=t(721),s=function(){function n(n){var e=this;this.sn=3e4,this.ln=30,this.cn=0,this.dn=[],this.fn=(0,a.Ks)(),this.vn=[],this.hn="",this.pn=0,this.flushOnClose=function(){e.mn(!1,!1)},this.flush=function(){e.wn()},this.flushAndSetNewEndpoint=function(n,t){var o,i=e.gn(n);i.localeCompare(null!==(o=e.Sn)&&void 0!==o?o:"",void 0,{sensitivity:"accent"})&&(e.vn.push((function(){e.Sn=i,t&&t()})),e.mn(!0,!0))},this.gn=function(n){return n+"?usid="+e.hn+"&officeserverversion="+function(){try{return __VERSION_PLACEHOLDER__}catch(n){return"###VERSION###"}}()},this.wn=function(){window.setTimeout((function(){return e.mn(!0,!0)}),0)},this.mn=function(n,t){var o,i,r,u,s,l,c,d=(0,a.u3)();window.clearTimeout(e.bn),e.Sn&&(e.dn.length>0&&(e.cn+=1,function(n,e,t){if(e){var o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(e,n)}catch(n){}!function(n,e,t){var o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",e,t),o.send(n))}(n,e,t)}}((o=e.dn.splice(0,n?e.ln:e.dn.length),i=e.hn,r=e.cn,u=e.fn,s=[],l=o.map((function(n){return function(n,e,t){var o={};if(o.G=n.tag,o.T=n.timestamp-e,o.M=n.message,o.C=n.category,n.correlationId){var i=t.findIndex((function(e){return e===n.correlationId}));i<0&&(i=t.push(n.correlationId)-1),o.I=i}var r=1e3*n.type+n.level;return o.D=r,o}(n,u,s)})),c=function(n,e,t,o,i){var r={};return r.T=n,r.L=e,r.S=t,r.I=o,i&&i.length>0&&(r.W=i),r.V=1,r}(u,l,i,r,s),JSON.stringify(c)),e.Sn,t),e.fn=(0,a.Ks)()),0===e.dn.length&&e.vn.length>0&&(e.vn.forEach((function(n){"requestIdleCallback"in window?window.requestIdleCallback(n):window.setTimeout(n,0)})),e.vn=[]),n&&(e.bn=window.setTimeout((function(){e.wn()}),e.dn.length>e.ln||e.vn.length>0?1e3:e.sn)),e.pn+=(0,a.u3)()-d)},n&&this.configure(n)}return n.prototype.getTimeSpentLogging=function(){return this.pn},n.prototype.addLoggingTime=function(n){this.pn+=n},n.prototype.configure=function(n){var e=this,t=(0,a.u3)();if(n.uploadCadenceInMs&&(this.sn=n.uploadCadenceInMs),n.uploadTriggerSize&&(this.ln=n.uploadTriggerSize),n.sessionId&&(this.hn=n.sessionId),n.remoteUlsEndpoint){if(!n.sessionId&&this.Sn)throw new Error("Remote ULS endpoint is already set");this.Sn=this.gn(n.remoteUlsEndpoint),this.fn=(0,a.Ks)(),window.setTimeout((function(){return e.mn(!0,!0)}),0)}this.pn+=(0,a.u3)()-t},n.prototype.handleTrace=function(n){var e=(0,a.u3)();n.message.length>3072&&(n.message=n.message.substring(0,3059)+"... [Trimmed]"),this.dn.push(n),(this.dn.length>this.ln||n.level===u.G.Error)&&this.wn(),this.pn+=(0,a.u3)()-e},n.prototype.getUserSessionId=function(){return this.hn},n}(),l=[];!function(n){n.In="BootstrapperMaxUlsHeartbeatTime",n.Cn="BootstrapperNoCompleteWarning1Time",n.Hn="BootstrapperNoCompleteWarning2Time",n.An="RemoteUlsETag",n.yn="RemoteUlsSuppressions",n.Tn="BootstrapperSettingsFetchPeriod",n.Un="timestamp",n.Fn="BootstrapperUlsHeartbeatIntervalMs",n.Pn="BootstrapperUlsHeartBeatIsEnabled",n.En="BootstrapperUlsUploadCadenceMs",n.Nn="WordConsumptionViewToEditRedirectIsEnabled",n.kn="RequestedCallThrottlingDefaultToViewMinimumValue",n.Rn="BulsEndpointUrl",n.Dn="EnableCommonHostDiagnosticsParams",n.On="EnableICNForWord",n._n="EnableModernEmbedViewForPowerPoint",n.Wn="EnableModernReadingViewForPowerPoint",n.Mn="EnableDefaultToModernForPowerPoint",n.jn="ShouldLogJsApiKpisForWord",n.xn="EnableFramePageErrorReportingForWord",n.Gn="WordSwitchToViewInTeamsJsapiV1Enabled"}(r||(r={}));var c=6e4;function d(n){var e=new s(n);function t(n,t,i,r){var u=(0,a.u3)();if(!function(n){return 1===l[n]}(n)){var s={timestamp:(0,a.Ks)(),category:t,tag:n,level:i,type:o.Trace,message:r,correlationId:""};e.addLoggingTime((0,a.u3)()-u),e.handleTrace(s)}}return{ULS:{sendTraceTag:function(n,e,o,i){t(n,e,o,i)},shipAssertTag:function(n,e,o,i){o&&t(n,e,u.G.Error,i)},debugAssertTag:function(n,e,t,o){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose,setCorrelationId:function(){}},configure:function(n){e.configure(n)},settingsChangeHandler:function(n){var t,o;t=n.Ln.getValue(r.yn,""),o=n.Ln.getValue(r.An,""),i&&o===i||(l=[],i=o,t&&t.split(",").forEach((function(n){var e=parseInt(n,10);e&&(l[e]=1)}))),e.configure({uploadCadenceInMs:n.Ln.getValue(r.En,c)});var u=n.Ln.getValue(r.Rn,"").toString();""!==u&&e.flushAndSetNewEndpoint(u)},getTimeSpentLogging:function(){return e.getTimeSpentLogging()},getUserSessionId:function(){return e.getUserSessionId()},flushAndSetNewEndpoint:function(n,t){e.flushAndSetNewEndpoint(n,t)}}}},7350:function(n,e,t){t.d(e,{n:function(){return u}});var o=t(6709);function i(n){if(!n)return"";var e=Object.getOwnPropertyNames(n),t=Object.getOwnPropertyNames(Object.getPrototypeOf(n));return JSON.stringify(n,(0,o.ev)((0,o.ev)([],e,!0),t,!0))}var r=t(721);function u(){var n=new Uint8Array(31),e=function(n){var e={crypto:!1,perfNow:!1,exceptions:[]},t=window.crypto||window.msCrypto;if(t){e.crypto=!0;try{return t.getRandomValues(n),e}catch(n){e.exceptions.push("crypto: ".concat(i(n)))}}e.perfNow=r.Xm;for(var o=0;o<n.length;o+=1){try{if(r.Xm){var u=Math.floor(100*window.performance.now())%10;(u<0||u>9)&&(u=0);for(var a=0;a<u;a+=1)Math.random()}}catch(n){e.exceptions.push("Math.random: ".concat(i(n)))}n[o]=Math.floor(16*Math.random())}return e}(n),t=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var o=15&n[t];return t+=1,("x"===e?o:3&o|8).toString(16)})),e]}},721:function(n,e,t){t.d(e,{Ks:function(){return u},Xm:function(){return i},u3:function(){return r}});var o,i=function(){try{var n=window.performance;return n&&n.now&&n.now()!==1/0}catch(n){return!1}}();function r(){return i?window.performance.now():Date.now()}function u(){if(!o){var n=window.performance;o=i&&n.timing&&n.timing.navigationStart?function(){return Math.round(n.now()+n.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return o()}},7784:function(n,e,t){t.d(e,{o:function(){return o}});var o,i=t(6277),r=t(6709),u=function(){function n(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return n.prototype.isEventBlocked=function(n){var e=this.blockedEvents.get(n);return!!e&&(Date.now()>=e?(this.unblockEvent(n),!1):(this.aggregateEventCount(n),!0))},n.prototype.blockEvent=function(n,e){var t=Date.now()+e;this.blockedEvents.set(n,t),this.updateEventHitCount(n,0),this.eventDurations.delete(n),this.eventDurationsTotal.delete(n)},n.prototype.unblockEvent=function(n){this.blockedEvents.delete(n)},n.prototype.getEventHitCount=function(n){return this.eventHitCounts.get(n)},n.prototype.updateEventHitCount=function(n,e){this.eventHitCounts.set(n,e)},n.prototype.aggregateEventCount=function(n){var e=this.getEventHitCount(n);"number"==typeof e&&this.updateEventHitCount(n,++e)},n.prototype.getEventDurations=function(n){return this.eventDurations.get(n)},n.prototype.aggregateEventDuration=function(n,e){var t,o=(null!==(t=this.getEventHitCount(n))&&void 0!==t?t:0)+1,i=this.eventDurationsTotal.get(n),u=this.eventDurations.get(n);if(void 0!==u){var a=(0,r.ev)([],u,!0);u[0]>e&&(a[0]=e),u[1]<e&&(a[1]=e);var s=void 0;void 0!==i&&i.length<10?(i.push(e),s=i.reduce((function(n,e){return n+e}),0)/o):(s=u[2]+(e-u[2])/o,this.eventDurationsTotal.delete(n)),a[2]=s,this.eventDurations.set(n,a)}else this.eventDurations.set(n,[e,e,e]),this.eventDurationsTotal.set(n,[e])},n}(),a=function(){function n(n,e,t,o,i){this.healthLogger=n,this.featureConfig=e,this.kpiUsageEventBlocker=t,this.kpiFailureEventBlocker=o,this.kpiSuccessEventBlocker=i}return n.prototype.logKpiUsage=function(e,t,o,i){var r=this.getKpiKey(e+n.USAGE_KPI,null==o?void 0:o.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(o),this.recordKpiUsage(e,t,o,r),0!==i){var u=null!=i?i:3e5;this.kpiUsageEventBlocker.blockEvent(r,u)}return!0},n.prototype.logKpiFailure=function(e,t,o,i,r){var u,a,s,l=this.getKpiKey(e+n.FAILURE_KPI+t,null===(u=null==o?void 0:o.additionalValues)||void 0===u?void 0:u.extendedProperties);if("number"==typeof(null===(a=null==o?void 0:o.additionalValues)||void 0===a?void 0:a.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(l,o.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(l))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(e,t,o,l),i&&this.recordQosError(null!==(s=i.errorNameOverride)&&void 0!==s?s:t,i.name,i),0!==r){var c=null!=r?r:3e5;this.kpiFailureEventBlocker.blockEvent(l,c)}return!0},n.prototype.logKpiSuccess=function(e,t,o){var i,r,u=this.getKpiKey(e+n.SUCCESS_KPI,null===(i=null==t?void 0:t.additionalValues)||void 0===i?void 0:i.extendedProperties);if("number"==typeof(null===(r=null==t?void 0:t.additionalValues)||void 0===r?void 0:r.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(u,t.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(u))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(e,t,u),0!==o){var a=null!=o?o:3e5;this.kpiSuccessEventBlocker.blockEvent(u,a)}return!0},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(e){var t,i=this.featureConfig.topLevelKpiName,r=this.getKpiKey(this.featureConfig.topLevelKpiName,null==e?void 0:e.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=r?r:"")){this.recordKpiUsage(i,o.FailureBased,e);var u=null!==(t=this.featureConfig.vetoPillar)&&void 0!==t?t:this.featureConfig.areaName;u&&n.QOS_PILLARS_LIST.includes(u)&&this.healthLogger.addQosPillar(u),this.kpiUsageEventBlocker.blockEvent(null!=r?r:"",864e5)}},n.prototype.recordKpiUsage=function(n,e,t,o){void 0===t&&(t={});var i=t||{},r=i.extendedProperties,u=i.isForAlertableKpi,a=this.createExtendedPropertiesWithMoreFields(r,o);u?this.healthLogger.recordKpiUsageForAlertableKpi(n,this.featureConfig.crewAlias,a):this.healthLogger.recordKpiUsage(n,e,this.featureConfig.crewAlias,a)},n.prototype.getKpiKey=function(n,e){var t=this.getKpiAreaName(e),o=this.getKpiFeatureName(e),i=this.getKpiPivot(e);return"".concat(t,".").concat(o,".").concat(null!=n?n:"").concat(i&&0===i.length?"."+i:"")},n.prototype.getKpiAreaName=function(e){var t,o,i;return null!==(i=null!==(o=null!==(t=null==e?void 0:e.get(n.AREA_NAME_COLUMN_KEY))&&void 0!==t?t:this.featureConfig.areaName)&&void 0!==o?o:this.featureConfig.vetoPillar)&&void 0!==i?i:""},n.prototype.getKpiFeatureName=function(e){var t,o;return null!==(o=null!==(t=null==e?void 0:e.get(n.FEATURE_NAME_COLUMN_KEY))&&void 0!==t?t:this.featureConfig.featureName)&&void 0!==o?o:""},n.prototype.getKpiPivot=function(e){var t=null==e?void 0:e.get(n.PIVOT_TYPE_COLUMN_KEY),o=null==e?void 0:e.get(n.PIVOT_VALUE_COLUMN_KEY);return t&&0!==t.length&&o&&0!==o.length?"".concat(t,"=").concat(o):""},n.prototype.recordKpiFailure=function(n,e,t,o){void 0===t&&(t={});var i=t||{},r=i.isIntentional,u=i.isInternal,a=i.additionalValues,s=i.hasImpliedUsage,l=this.createAdditionalValuesWithMoreFields(a,o);!1===s?this.healthLogger.recordKpiFailure(n,e,r,u,l):this.healthLogger.recordKpiImpliedFailure(n,e,r,u,this.featureConfig.crewAlias,l)},n.prototype.recordKpiSuccess=function(n,e,t){void 0===e&&(e={});var o=e||{},i=o.additionalValues,r=o.hasImpliedUsage,u=this.createAdditionalValuesWithMoreFields(i,t);!1===r?this.healthLogger.recordKpiSuccess(n,u):this.healthLogger.recordKpiImpliedSuccess(n,this.featureConfig.crewAlias,u)},n.prototype.recordQosError=function(n,e,t){void 0===t&&(t={});var o=t.isIntentional,i=t.isInternal,r=t.alertOnPillar,u=t.isSessionEndingError,a=t.additionalValues,s=this.createAdditionalValuesWithMoreFields(a);this.healthLogger.recordQosError(n,[e],o,i,r,u,s)},n.prototype.createExtendedPropertiesWithMoreFields=function(e,t){var o=new Map(e||new Map);if(o.get(n.FEATURE_NAME_COLUMN_KEY)||o.set(n.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(e)),o.set(n.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(o)),o.has(n.SKIP_ARIA_COLUMN_KEY)||o.has("skipAria")||o.set(n.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&t){var i=this.getEventBlocker(t);if(i){var r=i.getEventHitCount(t);if(r){o.set(n.AGGREGATED_COUNT_COLUMN_KEY,r.toString());var u=i.getEventDurations(t);r>1&&u&&o.set(n.AGGREGATED_DURATION_COLUMN_KEY,u.map((function(n){return Math.round(100*n)/100})).toString())}}}return o},n.prototype.createAdditionalValuesWithMoreFields=function(n,e){var t={};return(t=(0,r.pi)({},n)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==n?void 0:n.extendedProperties,e),t},n.prototype.getEventBlocker=function(e){return e.endsWith(n.USAGE_KPI)?this.kpiUsageEventBlocker:e.includes(n.FAILURE_KPI)?this.kpiFailureEventBlocker:e.endsWith(n.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},n.FEATURE_NAME_COLUMN_KEY="FeatureName",n.AREA_NAME_COLUMN_KEY="AreaName",n.AGGREGATED_COUNT_COLUMN_KEY="AggCount",n.AGGREGATED_DURATION_COLUMN_KEY="AggMs",n.SKIP_ARIA_COLUMN_KEY="SkipAria",n.PIVOT_TYPE_COLUMN_KEY="PivotType",n.PIVOT_VALUE_COLUMN_KEY="PivotValue",n.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],n.USAGE_KPI=".Usage",n.SUCCESS_KPI=".Success",n.FAILURE_KPI=".Failure.",n}(),s=function(){function n(e,t,i,u,s){var l,c,d,f=this;this.healthLogger=e,this.featureConfig=t,this.kpiUsageEventBlocker=i,this.kpiFailureEventBlocker=u,this.kpiSuccessEventBlocker=s,this.featureUsageAndHealthLogger=new a(this.healthLogger,this.featureConfig,null!==(l=this.kpiUsageEventBlocker)&&void 0!==l?l:n.kpiUsageBlocker,null!==(c=this.kpiSuccessEventBlocker)&&void 0!==c?c:n.kpiFailureBlocker,null!==(d=this.kpiFailureEventBlocker)&&void 0!==d?d:n.kpiSuccessBlocker),this.executeCallbackWithLogging=function(n,e){var t,i,u,a=function(n){return"VetoFailureLoggingParams".includes(n)};(null==e?void 0:e.kpiUsageLoggingParams)?(i="Usage",u=null==e?void 0:e.kpiUsageLoggingParams):(null==e?void 0:e.kpiSuccessLoggingParams)?(i="UsageWithSuccess",u=null==e?void 0:e.kpiSuccessLoggingParams):(null==e?void 0:e.kpiFailureLoggingParams)?(i="UsageWithFailure",u=null==e?void 0:e.kpiFailureLoggingParams):(i="UsageWithVetoFailure",u=null==e?void 0:e.vetoFailureLoggingParams);var s=null==u?void 0:u.usageName,l=null==u?void 0:u.usageKpiType;f.logKpiUsage({kpiName:s,kpiType:null!=l?l:o.FailureBased});try{null==n||n(),"UsageWithSuccess"===i&&"KpiSuccessLoggingParams".includes(u)&&f.logKpiSuccess({kpiName:s,optionalProperties:u.successOptionalProperties})}catch(n){if("UsageWithFailure"===i&&"KpiFailureLoggingParams".includes(u)||"UsageWithVetoFailure"===i&&a(u)){var c=void 0;a(u)&&(c=(0,r.pi)({name:null!==(t=u.vetoName)&&void 0!==t?t:""},u.vetoOptionalProperties)),f.logKpiFailure({kpiName:u.usageName,errorName:u.failureErrorName,optionalProperties:u.failureOptionalProperties,optionalVeto:c})}throw n}}}return n.getInstance=function(e,t,o,i,r){return new n(e,t,o,i,r)},n.prototype.logKpiUsage=function(n){var e;return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(n.kpiName,null!==(e=n.kpiType)&&void 0!==e?e:o.FailureBased,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiFailure=function(n){return!!(n&&n.kpiName&&n.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(n.kpiName,n.errorName,n.optionalProperties,n.optionalVeto,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiSuccess=function(n){return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(n.kpiName,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(n){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(n)},n.kpiUsageBlocker=new u,n.kpiFailureBlocker=new u,n.kpiSuccessBlocker=new u,n}(),l=function(){function n(){}return n.prototype.getHealthInstance=function(n){if(n)return i.S9.getInstance().initialize(n),i.S9.getInstance()},n.prototype.getExtendedHealthInstance=function(n,e){if(n&&e)return s.getInstance(n,e)},n}();!function(n){n[n.FailureBased=0]="FailureBased",n[n.SuccessBased=1]="SuccessBased"}(o||(o={})),new l},6277:function(n,e,t){t.d(e,{S9:function(){return v}});var o,i=t(6709);function r(n){if(n){var e={};return n.forEach((function(n,t){t&&(e[t]=n)})),e}}function u(n,e){var t=[],o=new Set;return n.concat(e).forEach((function(n){return o.add(n)})),o.forEach((function(n){return t.push(n)})),t}!function(n){n[n.Failure=0]="Failure",n[n.ImpliedUsageFailure=1]="ImpliedUsageFailure",n[n.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",n[n.Success=3]="Success",n[n.Usage=4]="Usage"}(o||(o={}));var a,s,l,c,d,f=t(7784);!function(n){n[n.BSqmError=0]="BSqmError",n[n.Kpi=1]="Kpi",n[n.QosError=2]="QosError",n[n.QosPillar=3]="QosPillar",n[n.DiagnosticLog=4]="DiagnosticLog",n[n.OfflineWorkerInit=5]="OfflineWorkerInit",n[n.OfflineWorkerFlush=6]="OfflineWorkerFlush",n[n.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(a||(a={})),function(n){n.HealthDimensions="d",n.PartCDimensions="a",n.BSqmErrors="b",n.QosErrors="e",n.Heartbeat="h",n.QosPillars="q",n.Kpis="k",n.DiagnosticLogs="l",n.ClientSendTime="t"}(s||(s={})),function(n){n[n.AttemptToUseFunctionalityBeforeIitialization=0]="AttemptToUseFunctionalityBeforeIitialization",n[n.WorkerApiIsNotAvailable=1]="WorkerApiIsNotAvailable",n[n.InvalidWorkerUrl=2]="InvalidWorkerUrl",n[n.InstallingOfflineWorker=3]="InstallingOfflineWorker",n[n.OfflineWorkerMessage=4]="OfflineWorkerMessage",n[n.FailedToProcessMessageFromOfflineWorker=5]="FailedToProcessMessageFromOfflineWorker",n[n.FailedToInstallOfflineWorker=6]="FailedToInstallOfflineWorker",n[n.InitializedHealth=7]="InitializedHealth",n[n.BatchesOfHealthEventsInIndexedDB=8]="BatchesOfHealthEventsInIndexedDB",n[n.IndexedDbTransactionFailed=9]="IndexedDbTransactionFailed",n[n.InstalledOfflineWorker=10]="InstalledOfflineWorker",n[n.IndexedDdIsNotSupported=11]="IndexedDdIsNotSupported",n[n.GetAllKeysIsNotSupported=12]="GetAllKeysIsNotSupported",n[n.FailedToProcessMessage=13]="FailedToProcessMessage",n[n.FailedToLoadWorkerScript=14]="FailedToLoadWorkerScript",n[n.FailedToSendEventToWorker=15]="FailedToSendEventToWorker",n[n.FailedToJsonStringifyEvent=16]="FailedToJsonStringifyEvent"}(l||(l={})),function(n){n[n.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",n[n.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",n[n.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",n[n.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",n[n.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(c||(c={})),function(n){n[n.SendSucceeded=0]="SendSucceeded",n[n.SendFailed=1]="SendFailed",n[n.DidNotAttempt=2]="DidNotAttempt"}(d||(d={}));var v=function(){function n(){var n=this;this.Vn={},this.Kn={},this.Jn=[],this.qn={},this.zn=0,this.Qn={Xn:3e5,Zn:!1,Yn:!1,$n:!1,ne:3e4,ee:25,te:"",oe:864e5,ie:"",re:"",ue:3,ae:3,se:15e3,le:new Set},this.ce=!1,this.de=-1,this.fe=!1,this.ve=0,this.he=!0,this.pe=function(){return!1},this.me={},this.we=[],this.Se=0,this.be=0,this.Ie=void 0,this.Ce=[],this.He=[],this.Ae=[],this.ye=[],this.Te=0,this.Ue=0,this.Fe=0,this.Pe=[],this.Ee=!1,this.Ne=0,this.ke=!1,this.Re=function(){n.Te&&(window.clearTimeout(n.Te),n.Te=0)},this.De=function(){n.we=[],n.Ce=[],n.He=[],n.Ie=void 0,n.Ae=[],n.ye=[],n.Se=0,n.be=0},this.Oe=function(){try{if(n.Se<=0)return;var e=n._e();n.We(e,n.zn,n.Qn.ae),n.De()}catch(n){}},this._e=function(){return{d:n.qn,a:n.Me(),b:n.we,e:n.He,h:n.Ie,q:n.Ae,k:n.Ce,l:n.ye,type:"h_v2"}},this.Me=function(){return n.Qn.$n&&(n.we&&n.we.length>0||n.He&&n.He.length>0)&&Object.keys(n.Kn).length>0?(0,i.pi)((0,i.pi)({},n.Vn),n.Kn):n.Vn},this.je=function(e,t,o,i){var r;if(void 0===i&&(i=!1),t&&!n.Qn.le.has(o))if(n.he){switch(e){case a.BSqmError:n.we.push(t);break;case a.Kpi:n.Ce.push(t);break;case a.QosError:n.He.push(t);break;case a.QosPillar:-1===n.Ae.map((function(n){return n.n})).indexOf(t.n)&&n.Ae.push(t);break;case a.DiagnosticLog:n.ye.push(t)}if(n.Se+=1,e!==a.DiagnosticLog&&e!==a.QosPillar&&(n.be+=1),n.pe()&&!i)return void n.Oe();n.Se>=n.Qn.ee&&(n.Re(),n.xe())}else t.o=(new Date).toJSON(),null===(r=n.Ge)||void 0===r||r.postMessage({t:e,k:"".concat(n.qn.w,".").concat(n.zn),m:n.qn,c:n.Me(),v:t})},this.Le=function(){n.Re(),n.Te=window.setTimeout((function(){n.xe()}),n.Qn.ne)},this.xe=function(e){void 0===e&&(e=!1),e&&n.be<=0||(n.Oe(),n.Le())},this.Be=function(){if(n.Pe||n.me){n.Ie&&-1!==n.de||(n.de=(n.de+1)%1e3),n.Ie||(n.Se+=1);var e={p:n.Ie?u(n.Ie.p,n.Pe):n.Pe,k:n.Ie?u(n.Ie.k,n.Jn):n.Jn,i:n.Qn.Xn,o:n.de};n.Ie=e}},this.Ve=function(e,t,o,i,u,s,l,c,d,f){if(e&&(!t||n.me[e])){t||n.Ke(e,c,d,f);var v=n.me[e],h={n:v.k,e:o,t:v.t,a:v.a,f:v.o,d:null==i?void 0:i.durationMs,p:r(null==i?void 0:i.extendedProperties)};if(u){var p={n:u,x:l,z:s};h.k=p}n.je(a.Kpi,h,e)}},this.Je=function(){var e,t,o,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,b,I,C,H,A,y,T,U,F,P,E,N,k,R,D,O,_,W,M=n.Qn.qn;M&&(n.qn={a:null!==(e=M.application)&&void 0!==e?e:void 0,b:null!==(t=M.applicationLcid)&&void 0!==t?t:void 0,c:null!==(o=M.applicationMode)&&void 0!==o?o:void 0,d:null!==(i=M.applicationModeExtended)&&void 0!==i?i:void 0,e:null!==(r=M.arrVersion)&&void 0!==r?r:void 0,f:null!==(u=M.browser)&&void 0!==u?u:void 0,g:null!==(a=M.browserLcid)&&void 0!==a?a:void 0,h:null!==(s=M.browserMajorVersion)&&void 0!==s?s:void 0,i:null!==(l=M.browserVersion)&&void 0!==l?l:void 0,j:null!==(c=M.clientVersion)&&void 0!==c?c:void 0,k:null!==(d=M.datacenter)&&void 0!==d?d:void 0,l:null!==(f=M.dataCulture)&&void 0!==f?f:void 0,m:null!==(v=M.flightsImpressionId)&&void 0!==v?v:void 0,n:null!==(h=M.host)&&void 0!==h?h:void 0,o:null!==(p=M.isAnonymousUser)&&void 0!==p?p:void 0,p:null!==(m=M.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(w=M.isEduUser)&&void 0!==w?w:void 0,r:null!==(g=M.isSynthetic)&&void 0!==g?g:void 0,s:null!==(S=M.loggableUserId)&&void 0!==S?S:void 0,t:null!==(b=M.loggableUserIdSpace)&&void 0!==b?b:void 0,u:null!==(I=M.ring)&&void 0!==I?I:void 0,v:null!==(C=M.serverDocId)&&void 0!==C?C:void 0,w:null!==(H=M.session_id)&&void 0!==H?H:void 0,x:null!==(A=M.sessionOrigin)&&void 0!==A?A:void 0,y:null!==(y=M.tenantId)&&void 0!==y?y:void 0,z:null!==(T=M.uiHost)&&void 0!==T?T:void 0,aa:null!==(U=M.wfeVersion)&&void 0!==U?U:void 0,ab:null!==(F=M.fileExtension)&&void 0!==F?F:void 0,ac:null!==(P=M.uiHostIntegrationType)&&void 0!==P?P:void 0,ad:null!==(E=M.osVersion)&&void 0!==E?E:void 0,af:null!==(N=M.networkDownlink)&&void 0!==N?N:void 0,ag:null!==(k=M.networkDownlinkMax)&&void 0!==k?k:void 0,ah:null!==(R=M.networkEffectiveType)&&void 0!==R?R:void 0,ai:null!==(D=M.networkRTT)&&void 0!==D?D:void 0,aj:null!==(O=M.networkSaveData)&&void 0!==O?O:void 0,ak:null!==(_=M.networkType)&&void 0!==_?_:void 0,al:null!==(W=M.userLicenseType)&&void 0!==W?W:void 0})},this.qe=function(){n.Be(),n.ve=window.setTimeout((function(){n.qe()}),n.Qn.Xn)},this.ze=function(){n.Pe&&n.Pe.forEach((function(e){e&&n.Qe(e,!0)}))},this.Qe=function(e,t){var o={};o.n=e,n.je(a.QosPillar,o,e,t)},this.Xe=function(){n.Pe&&(n.Ue=Date.now(),n.ze()),n.Ze()},this.Ze=function(e){void 0===e&&(e=n.Qn.oe),n.Fe=window.setTimeout((function(){n.Xe()}),e)},this.Ye=function(){n.ce||(n.ce=!0,n.fe=!0,n.qe())},this.$e=function(){0!==n.Fe&&(window.clearTimeout(n.Fe),n.Fe=0)},this.nt=function(){if(n.Qn.Zn&&n.Qn.Yn&&n.Qn.re&&""!==n.Qn.re&&n.Qn.te&&""!==n.Qn.te)try{if("undefined"==typeof Worker)return void n.et(l.WorkerApiIsNotAvailable);if(!n.Qn.te)return void n.et(l.InvalidWorkerUrl);n.et(l.InstallingOfflineWorker);var e=new Blob(["try{importScripts('".concat(encodeURI(n.Qn.te),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});n.Ge=new Worker(URL.createObjectURL(e)),n.Ge.onmessage=function(e){try{var t=e.data;n.et(t.i,t.r)}catch(e){n.et(l.FailedToProcessMessageFromOfflineWorker,e.toString())}},n.Ge.postMessage({t:a.OfflineWorkerInit,v:n.Qn.re}),n.Ge.postMessage({t:a.OfflineWorkerFlush})}catch(e){n.et(l.FailedToInstallOfflineWorker,e.toString())}},this.tt=function(e,t){var o;if(e.b.length>0||e.e.length>0||e.q.length>0||e.k.length>0||e.l.length>0)try{return null===(o=n.Ge)||void 0===o||o.postMessage({t:a.OfflineWorkerFailedUpload,k:"".concat(e.d.w,".").concat(t),v:e}),d.SendSucceeded}catch(e){var i=n.ot(e);return n.et(l.FailedToSendEventToWorker,i),d.SendFailed}return d.DidNotAttempt},this.Ke=function(e,t,o,i){e&&void 0!==t&&(n.me[e]||(n.me[e]={k:e,t,a:!0===o,o:null!=i?i:void 0},o&&(n.Jn.push(e),n.Be())))},this.it=function(e){n.de=-1,e?(n.Ue=Date.now(),n.Ze(),n.Ye()):n.Be()},this.rt=function(e){return!!n.ke||(n.et(l.AttemptToUseFunctionalityBeforeIitialization,null==e?void 0:e.toString()),!1)},this.We=function(e,t,o){if(e){var r=n.Qn.ie;if(n.Ee&&(o<=0||!n.he)&&n.tt(e,t)!==d.SendFailed)return;if(!(o<=0)){var u=n.ut(e,!1);if(null!==u){if(n.pe())try{if(void 0!==navigator.sendBeacon){if(u.length>=65536&&n.Qn.$n){var a=(0,i.pi)((0,i.pi)({},e),{a:n.Vn}),s=n.ut(a,!0);if(null===s)return;navigator.sendBeacon(r,s)}else navigator.sendBeacon(r,u);return}}catch(n){}var l=new XMLHttpRequest;l.open("POST",r,!0),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&(200===l.status?n.Ee||(n.Ee=!0):n.Ne<n.Qn.ue?(n.Ne+=1,window.setTimeout((function(){n.Ne-=1,n.We(e,t,o-1)}),n.Qn.se)):n.Ee&&n.tt(e,t))},l.send(u)}}}},this.et=function(e,t){var o={i:e,r:t};n.je(a.DiagnosticLog,o,e.toString())},this.ot=function(n){var e=void 0;return"string"==typeof n?e=n:n instanceof Error&&(e=n.name+" "+n.message,n.stack&&(e+=" "+n.stack)),e},this.ut=function(e,t){try{return i=e,JSON.stringify(i)}catch(e){var o=n.ot(e);return o="ModifiedPayload: "+t+" | "+o,n.et(l.FailedToJsonStringifyEvent,o),null}var i}}return n.getInstance=function(){return n.st||(n.st=new n),this.st},n.prototype.initialize=function(n){if(n)try{return this.Qn=function(n){var e,t,o,i,r,u,a,s,l,c,d,f,v,h,p;return{qn:null!==(e=n.dimensions)&&void 0!==e?e:void 0,Xn:null!==(t=n.heartbeatIntervalMs)&&void 0!==t?t:3e5,Zn:null!==(o=n.isHealthEnabled)&&void 0!==o&&o,Yn:null!==(i=n.isOfflineEnabled)&&void 0!==i&&i,$n:null!==(r=n.isErrorPartCEnabled)&&void 0!==r&&r,ne:null!==(u=n.loggerMaxIntervalMs)&&void 0!==u?u:3e4,ee:null!==(a=n.loggerMaxQueueSize)&&void 0!==a?a:25,te:null!==(s=n.offlineWorkerUrl)&&void 0!==s?s:"",re:null!==(l=n.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==l?l:"",oe:null!==(c=n.recordPillarToWarmPipelineIntervalMs)&&void 0!==c?c:864e5,ie:null!==(d=n.remoteTelemetryUrl)&&void 0!==d?d:"",ue:null!==(f=n.maxConcurrentRetries)&&void 0!==f?f:3,ae:null!==(v=n.retryMaxAttempts)&&void 0!==v?v:3,se:null!==(h=n.retryDelayMs)&&void 0!==h?h:15e3,le:null!==(p=n.disabledHealthEvents)&&void 0!==p?p:new Set}}(n),this.Je(),this.Le(),this.nt(),this.ke=!0,void this.et(l.InitializedHealth)}catch(n){}this.ke=!1},n.prototype.addOrUpdatePartCDimension=function(n,e){this.rt(c.AttemptedToAddOrUpdatePartCDimension)&&n&&(this.Vn.hasOwnProperty(n)&&this.Vn[n]===e||(this.xe(!0),this.Vn[n]=e,this.zn+=1,this.Be(),this.ze()))},n.prototype.addOrUpdateErrorPartCDimension=function(n,e){this.Qn.$n&&n&&(this.Kn[n]=e)},n.prototype.addQosPillar=function(n){if(n){var e=0===this.Pe.length;-1===this.Pe.indexOf(n)&&(this.Pe.push(n),this.Qe(n,!1),this.it(e))}},n.prototype.recordBsqmQosError=function(n,e,t){if(this.rt(c.AttemptedToRecordBSqmQosError)&&(this.lt(!1),this.ze(),n)){var o={b:n,v:e,d:null==t?void 0:t.durationMs,p:r(null==t?void 0:t.extendedProperties),s:this.Pe,i:null==t?void 0:t.inStaging};this.je(a.BSqmError,o,n),this.shutdown(!0)}},n.prototype.recordKpiFailure=function(n,e,t,i,r){this.Ve(n,!0,o.Failure,r,e,i,t)},n.prototype.recordKpiImpliedFailure=function(n,e,t,i,r,u){this.Ve(n,!1,o.ImpliedUsageFailure,u,e,i,t,f.o.FailureBased,!1,r)},n.prototype.recordKpiImpliedSuccess=function(n,e,t){this.Ve(n,!1,o.ImpliedUsageSuccess,t,void 0,void 0,void 0,f.o.FailureBased,!1,e)},n.prototype.recordKpiSuccess=function(n,e){this.Ve(n,!0,o.Success,e)},n.prototype.recordKpiUsage=function(n,e,t,i){this.Ve(n,!1,o.Usage,{extendedProperties:i},void 0,void 0,void 0,e,!1,t)},n.prototype.recordKpiUsageForAlertableKpi=function(n,e,t){if(n){var i=!0,r=this.me[n];r&&(i=r.t===f.o.FailureBased),this.Ve(n,!1,o.Usage,{extendedProperties:t},void 0,void 0,void 0,f.o.FailureBased,!0,e),i&&this.Ye()}},n.prototype.recordQosError=function(n,e,t,o,i,u,s){if((!u||this.rt(c.AttemptedToRecordSessionEndingQosError))&&n&&e){var l={n,x:t,z:o,l:i,v:e,e:u,d:null==s?void 0:s.durationMs,p:r(null==s?void 0:s.extendedProperties),s:this.Pe,i:null==s?void 0:s.inStaging};this.je(a.QosError,l,n),u&&(this.lt(!1),this.ze(),this.shutdown(!0))}},n.prototype.removeQosPillar=function(n){if(n){var e=this.Pe.indexOf(n);e>-1&&(this.Pe.splice(e,1),this.it(!1)),0===this.Pe.length&&this.$e()}},n.prototype.resumeAllHealthTimers=function(){if(this.ce&&!this.fe&&this.qe(),0===this.Fe&&0!==this.Ue){var n=Date.now()-this.Ue;n>=this.Qn.oe||n<=0?this.Xe():this.Ze(this.Qn.oe-n)}},n.prototype.setHandlerForIsAppShuttingDown=function(n){n&&(this.pe=n)},n.prototype.setIsAppOnline=function(n){var e;this.rt(c.AttemptedToSetAppOnlineStatus)&&(!this.he&&n&&(null===(e=this.Ge)||void 0===e||e.postMessage({t:a.OfflineWorkerFlush,v:this.pe()})),this.he=n)},n.prototype.shutdown=function(n){var e;void 0===n&&(n=!1),this.Qn.Zn&&(this.Re(),this.lt(!1),this.pe=function(){return!0},this.Oe(),(!n||n&&this.he)&&(null===(e=this.Ge)||void 0===e||e.terminate()))},n.prototype.stopAllHealthTimers=function(){this.lt(!0)},n.prototype.lt=function(n){this.fe=!1,this.de=-1,0!==this.ve&&(window.clearTimeout(this.ve),this.ve=0),this.$e(),n&&this.Oe()},n.prototype.updatePartADimensions=function(n){var e=this;if(n&&this.rt(c.AttemptedToUpdatePartADimensions)){var t=!1;Object.keys(n).forEach((function(o){void 0!==n[o]&&null!==n[o]&&""!==n[o]&&e.Qn.qn[o]!==n[o]&&(e.Qn.qn[o]=n[o],t=!0)})),t&&(this.xe(),this.Je(),this.zn+=1,this.Be(),this.ze())}},n.prototype.flushAndSetNewEndpoint=function(n,e){var t;n.localeCompare(null!==(t=this.Qn.ie)&&void 0!==t?t:"",void 0,{sensitivity:"accent"})&&(this.xe(!1),this.Qn.ie=n,e&&e())},n}()},5796:function(n,e,t){var o;t.d(e,{W:function(){return o}}),function(n){n[n.ct=0]="msoulscat_ES_EWAJS",n[n.ft=1]="msoulscat_ES_EWAJSGrid",n[n.vt=6]="msoulscat_ES_EWAJSChart",n[n.ht=202]="msoulscat_MSOSP_FileMenuCommands",n[n.wt=220]="msoulscat_MSOSP_AddInCommands",n[n.gt=225]="msoulscat_MSOSP_OTelJS",n[n.St=227]="msoulscat_MSOSP_OTelJSInWebWoker",n[n.bt=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",n[n.It=301]="msoulscat_Wac_WordViewer",n[n.Ct=306]="msoulscat_Wac_BrowserGeneral",n[n.Ht=320]="msoulscat_Wac_TaskPane",n[n.At=339]="msoulscat_Wac_OneNoteGeneral",n[n.yt=340]="msoulscat_Wac_Ribbon",n[n.Tt=356]="msoulscat_Wac_WacFeedback",n[n.Ut=379]="msoulscat_Wac_WopiPendingApplication",n[n.Ft=383]="msoulscat_Wac_Telemetry",n[n.Pt=391]="msoulscat_Wac_WacCatchUpActivities",n[n.Et=394]="msoulscat_Wac_Dictation",n[n.Nt=395]="msoulscat_Wac_OneNoteSync",n[n.kt=700]="msoulscat_Wac_VisioApp",n[n.Rt=1601]="msoulscat_OneNoteOnline_EditableCache",n[n.Dt=800]="msoulscat_Wac_PptAnimation",n[n.Ot=833]="msoulscat_Wac_PptLive",n[n._t=834]="msoulscat_Wac_PptMWeb",n[n.Wt=835]="msoulscat_Wac_PptGc2General",n[n.Mt=836]="msoulscat_Wac_PptGc2GraphicHost",n[n.jt=837]="msoulscat_Wac_PptGc2Operation",n[n.xt=844]="msoulscat_Wac_PptDataSync",n[n.Gt=848]="msoulscat_Wac_PptFluidRuntime",n[n.Lt=815]="msoulscat_Wac_PptShape",n[n.Bt=817]="msoulscat_Wac_PptSession",n[n.Vt=830]="msoulscat_Wac_PptSlideshow",n[n.Kt=822]="msoulscat_Wac_PptView",n[n.Jt=846]="msoulscat_Wac_PptVideos",n[n.qt=1303]="msoulscat_Uci_Insights",n[n.zt=2300]="msoulscat_Wac_VersionHistory",n[n.Qt=302]="msoulscat_Wac_WordPresence",n[n.Xt=3e3]="msoulscat_Wac_OAuth",n[n.Zt=3005]="msoulscat_Wac_WordVersionHistory",n[n.Yt=3006]="msoulscat_Wac_LivePersonaCard",n[n.$t=3012]="msoulscat_Wac_CatchUpFlyout",n[n.no=3016]="msoulscat_Wac_WordDesigner",n[n.eo=3021]="msoulscat_Wac_ModernFontPicker",n[n.oo=3027]="msoulscat_Wac_UnifiedUiHost",n[n.io=3033]="msoulscat_Wac_EquationTools",n[n.ro=1401]="msoulscat_Osf_Latency",n[n.uo=1402]="msoulscat_Osf_Notification",n[n.ao=1403]="msoulscat_Osf_Runtime",n[n.so=3041]="msoulscat_Wac_AiMaker",n[n.lo=3043]="msoulscat_Wac_AiRewrite",n[n.co=3044]="msoulscat_Wac_AiInsert",n[n.do=3047]="msoulscat_Wac_AiSummarize",n[n.fo=3048]="msoulscat_Wac_CopilotCompose",n[n.vo=3049]="msoulscat_Wac_Skittles"}(o||(o={}))},280:function(n,e,t){var o;t.d(e,{G:function(){return o}}),function(n){n[n.Error=10]="Error",n[n.Warning=15]="Warning",n[n.Important=20]="Important",n[n.Info=50]="Info",n[n.Verbose=100]="Verbose",n[n.Spam=200]="Spam"}(o||(o={}))},933:function(n,e,t){t.d(e,{o:function(){return a}});var o=t(5796),i=t(280),r=t(2544),u=t(8959);function a(n,e,t,s,l,c,d){void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===c&&(c=1),void 0===d&&(d=!1);var f=(0,u.a)();return(0,u.l5)("wopiDataStartTime"),e(n,s,l,t).then((function(e){var a,s,l,c;if(!e){var d="Graph call failed";return null==t||t.ULS.sendTraceTag(553726284,o.W.oo,i.G.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(d,"]")),Promise.reject(d)}var v={docUrl:null!==(a=e.webDavUrl)&&void 0!==a?a:n.docUrl,driveId:null!==(l=null===(s=null==e?void 0:e.parentReference)||void 0===s?void 0:s.driveId)&&void 0!==l?l:n.driveId,docId:null!==(c=null==e?void 0:e.id)&&void 0!==c?c:n.docId,fileName:e.name};null==t||t.ULS.sendTraceTag(553726285,o.W.oo,i.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!v,"]"));var h=(0,r.YI)(e,t);null==t||t.ULS.sendTraceTag(553726287,o.W.oo,i.G.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!h,"]"));var p={startTime:f,endTime:(0,u.a)()};return(0,u.l5)("wopiDataEndTime"),{documentIdentifier:v,wopiHostData:h,fetchDiagnostics:p}})).catch((function(r){var u;return null==t||t.ULS.sendTraceTag(520729472,o.W.oo,i.G.Warning,"GetWopiData: General getWopiData error. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),c>0&&(null==r?void 0:r.retry)?(null==t||t.ULS.sendTraceTag(544306772,o.W.oo,i.G.Error,"GetWopiData: Retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),new Promise((function(n){var e=function(n){if(0===n)throw new Error("Retry count should not be 0");return 1===n?window.crypto.getRandomValues(new Uint32Array(1))[0]%291+10:10}(c);setTimeout(n,e),null==t||t.ULS.sendTraceTag(508035599,o.W.oo,i.G.Warning,"GetWopiData: Retrying getWopiData with ".concat(c," retries left. Delaying retry for ").concat(e,"ms."))})).then((function(){return a(n,e,t,s,l,c-1)})).catch((function(n){return null==t||t.ULS.sendTraceTag(508035598,o.W.oo,i.G.Error,"GetWopiData: Failed to delay retry getWopiData. [Error: ".concat(n.message,"]")),Promise.reject(n)}))):c>0&&d&&"accessDenied"===(null==r?void 0:r.errorCode)?new Promise((function(n){setTimeout(n,3e3),null==t||t.ULS.sendTraceTag(523269073,o.W.oo,i.G.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]"))})).then((function(){return a(n,e,t,s,l,0)})):(null==t||t.ULS.sendTraceTag(544306773,o.W.oo,i.G.Error,"GetWopiData: Not retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][ShouldRetry: ").concat(c>0,"][FailureReason: ").concat(null!==(u=null==r?void 0:r.failure)&&void 0!==u?u:null==r?void 0:r.message,"]")),Promise.reject(r))}))}},4086:function(n,e,t){t.d(e,{n:function(){return d},g:function(){return c}});var o,i=t(6709),r=t(5796),u=t(280),a=t(8959),s=t(759);function l(n,e,t,i){if(null==o||o.delete(t),i&&"PRODUCTION"===i){var r=new URL(n);return r.hostname="res-1.cdn.office.net",c(r.toString(),e,t,!1,i)}return c(n,e,t,!1,i)}function c(n,e,t,c,f,v){return void 0===c&&(c=!0),(0,i.mG)(this,void 0,void 0,(function(){var h,p,m=this;return(0,i.Jh)(this,(function(w){return o||(o=new Map),(h=o.get(t))?[2,h]:(p=new Promise((function(o,h){return(0,i.mG)(m,void 0,void 0,(function(){var p,m,w,g,S,b=this;return(0,i.Jh)(this,(function(I){switch(I.label){case 0:return p=(0,a.a)(),(m=document.getElementById("".concat(t,"_bootstrapper")))?(w=(0,i.CR)(d(t),2),g=w[0],!w[1]&&g?[3,2]:[4,new Promise((function(n,e){m.onload=function(){n()},m.onerror=function(){e("JSAPI script failed to load in parallel with OWL")}})).catch((function(){null==v||v.ULS.sendTraceTag(507531682,r.W.oo,u.G.Error,"JSAPI failed to load ".concat(s.T[t]," bootstrapper in parallel with OWL")),h("JSAPI script failed to load in parallel with OWL")}))]):[3,3];case 1:I.sent(),I.label=2;case 2:return S=(0,a.a)(),null==v||v.ULS.sendTraceTag(507531681,r.W.oo,u.G.Important,"JSAPI script successfully loaded for ".concat(s.T[t]," with OWL")),[2,o({bootstrapperUrl:n,applicationUrl:e,performance:{startTime:p,endTime:S}})];case 3:return function(n,e,t,o,i,r,u){if(void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),!document)return null;if(i){var a=document.getElementById(i);if(null!=a)return e&&e(),a}var s=document.createElement("script");if(s.src=n,i&&(s.id=i),e&&(s.onload=e),t&&(s.onerror=function(){var n;u&&(null===(n=s.parentNode)||void 0===n||n.removeChild(s)),t()}),r&&(s.crossOrigin="anonymous"),o){var l=document.getElementsByTagName("script")[0];if(l&&l.parentNode)return l.parentNode.insertBefore(s,l)}document.body.appendChild(s)}(n,(function(){var i=(0,a.a)();null==v||v.ULS.sendTraceTag(507834582,r.W.oo,u.G.Important,"JSAPI fetch succeeded for ".concat(s.T[t]," bootstrapper. OnRetry: false")),o({bootstrapperUrl:n,applicationUrl:e,performance:{startTime:p,endTime:i}})}),(function(){return(0,i.mG)(b,void 0,void 0,(function(){var d;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(!c)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l(n,e,t,f)];case 2:return i.sent(),d=(0,a.a)(),null==v||v.ULS.sendTraceTag(507834581,r.W.oo,u.G.Important,"JSAPI fetch succeeded for ".concat(s.T[t]," bootstrapper. OnRetry: true")),o({bootstrapperUrl:n,applicationUrl:e,performance:{startTime:p,endTime:d}}),[3,4];case 3:return i.sent(),null==v||v.ULS.sendTraceTag(507834580,r.W.oo,u.G.Error,"JSAPI fetch failed for ".concat(s.T[t]," bootstrapper. OnRetry: true")),h("Load bootstrapper script failed"),[3,4];case 4:return[3,6];case 5:null==v||v.ULS.sendTraceTag(507834579,r.W.oo,u.G.Error,"JSAPI fetch failed for ".concat(s.T[t]," bootstrapper. OnRetry: false")),h("Load bootstrapper script failed"),i.label=6;case 6:return[2]}}))}))}),!1,"".concat(s.T[t],"_bootstrapper"),!1,c),[2]}}))}))})),o.set(t,p),[2,p])}))}))}function d(n){var e=window.Microsoft;if(void 0===e)return[void 0,"Microsoft is undefined"];var t=e.Office,o=s.T[n];return t&&t[o]?[t[o],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(o)]}},8396:function(n,e,t){t.d(e,{Zl:function(){return k},Tq:function(){return R}});var o=t(6709),i=t(7783),r=t(9055),u=t(6768),a=t(1492),s=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return r.ZT(e,n),e.prototype.A=function(e){return this.hasError?(e.error(this.thrownError),a.w.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),a.w.EMPTY):n.prototype.A.call(this,e)},e.prototype.next=function(n){this.hasCompleted||(this.value=n,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||n.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&n.prototype.next.call(this,this.value),n.prototype.complete.call(this)},e}(u.xQ),l=t(826),c=t(1507),d=t(2506),f=t(7571),v=t(5796),h=t(280),p=t(2199),m=t(1208),w=t(3594);function g(n,e,t,o,i,r){if(t){var u=(0,w.vJ)(w.Fh.FeatureGate_DisableEUDBBrowserULSRouting,i);n.then((function(n){if(n&&((0,w.dt)(w.Fh.FeatureGate_DisableEUDBBrowserULSRouting,u,t),!u)){var o=S(n),i=(0,p.fy)(e,o.dataBoundary);t.flushAndSetNewEndpoint(i,(function(){null==t||t.ULS.sendTraceTag(509612803,v.W.oo,h.G.Info,"Updated ULS endpoint. Environment: ".concat(e,", DataBoundary: ").concat(o.dataBoundary,", Region: ").concat(o.region))}))}})).catch((function(n){null==t||t.ULS.sendTraceTag(509875042,v.W.oo,h.G.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(n.message))}))}if(o){var a=(0,w.vJ)(w.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,i);n.then((function(n){if(n&&((0,w.dt)(w.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,a,t),!a)){var i=S(n),u=(0,p.S$)(e,r,i.dataBoundary);o.flushAndSetNewEndpoint(u,(function(){null==t||t.ULS.sendTraceTag(509612802,v.W.oo,h.G.Info,"Updated Health endpoint. Environment: ".concat(e,", DataBoundary: ").concat(i.dataBoundary,", Region: ").concat(i.region))}))}})).catch((function(n){null==t||t.ULS.sendTraceTag(509875041,v.W.oo,h.G.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(n.message))}))}}function S(n){var e,t=(e=n.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i))&&e[1]?e[1]:"public";return{region:t,dataBoundary:(0,m.g)(t)}}var b=t(759),I=t(8959),C=t(1328),H=t(4285),A=t(2294),y=t(8334),T=t(4086),U=t(2544),F=t(3979);function P(n,e,t,i,r,u,a,s){var f=this,p=n.loadFunctionSubject,m=n.documentBootInfo,g=n.correlationId,S=n.wopiFetchData,P=void 0===S?{wopiHostData:void 0,fetchDiagnostics:void 0}:S,E=m.fileType,N=m.wdOrigin,k=m.puid,R=m.uiCulture,D=m.dataCulture,O=m.clickTime,_=m.rebootOverrideData,W=P.wopiHostData,M=P.fetchDiagnostics,j=null==t?void 0:t.logger,x=null==t?void 0:t.health;if(!(W&&W.wac&&W.wac.bootstrapperUrl&&W.wac.applicationUrl)){var G=!!W,L=!!(null==W?void 0:W.wac),B=new Map([["WopiHostDataPresent","".concat(G)],["WopiWacDataPresent","".concat(L)]]),V=JSON.stringify(Array.from(B.entries())),K={wacErrorName:c.AU.ho,qosErrorName:c.DG.QosError_VroomWopiFailure,errorMessage:V};return null==j||j.ULS.sendTraceTag(554964098,v.W.oo,h.G.Info,"".concat(c.AU.ho,": Failed to get wopi data for the item, ").concat(V)),void(i&&i(K))}var J=s||W.wac.bootstrapperUrl,q=W.wac.applicationUrl;W.wac.userId&&(null==x||x.updatePartADimensions({loggableUserId:W.wac.userId}));var z=new Promise((function(n,e){setTimeout((function(){return e("jsApi timed out after 60 seconds")}),6e4)})),Q=new Promise((function(n,s){return(0,o.mG)(f,void 0,void 0,(function(){var f;return(0,o.Jh)(this,(function(S){return p.subscribe((function(){return n("jsApi successfully loaded")})),f=function(n,i){var s,f,S=(0,F.e8)(W,q,null!==(s=null==e?void 0:e.uiHostName)&&void 0!==s?s:"UUIH",m,null==e?void 0:e.uiEmbed),T=(0,U.ss)(S,j);(0,F.ZR)(E,null==e?void 0:e.featureGates,j)?(null==x||x.addOrUpdatePartCDimension("JsApiVersion","V2"),f=function(s){var f=s.container,p=s.flushTime;return new l.y((function(s){var l,U,P,E,k,R,x,G,L,B,V,K=(0,H.Z)(m,J,e,t,W),q=d.r.isCreateNewFlowExecuting&&d.r.application?d.r.application:n.createApplication(K),z={hostSessionId:g},Q=d.r.isCreateNewFlowExecuting&&d.r.session?d.r.session:q.createSession(z);u&&u(q,W,m,Q),(0,w.vJ)("UseNewEuplReporting",null==e?void 0:e.featureGates)&&m.fileType!==b.T.Excel||!r||r();var X={appUrl:S,file:(0,o.pi)({name:W.fileName,getUrl:(null===(E=W.wac)||void 0===E?void 0:E.fileGetUrl)||W.downloadUrl,size:W.fileSize,eTag:W.eTag},m.docId&&{uniqueId:m.docId}),customFontCatalogUrl:W.wac.customFontCatalogUrl,contentBundle:{majorVersion:W.bundleVersion?Number(W.bundleVersion):0,url:null!==(k=W.bundleUrl)&&void 0!==k?k:"",staleness:W.bundleStaleness||0},newFileTemplate:m.newFileTemplate,container:f,wopi:{source:W.wac.wopiSrc,accessToken:W.wac.accessToken,expiry:parseInt(W.wac.accessTokenExpiry,10),wacToken:null==t?void 0:t.wacToken},bootParams:{readOnly:W.readOnly,irmEnabled:W.irmEnabled,supportsDecryptedContentDownload:W.protectionEnabled,viewOnly:W.blocksDownload,disableChat:!0,openViewByDefault:"view"===m.intent,dataLanguage:D},diagnostics:(null===(R=null==t?void 0:t.bootDiagnostics)||void 0===R?void 0:R.legacyPerformanceData)?(0,o.pi)((0,o.pi)((0,o.pi)({},(0,F.xL)(null===(x=null==t?void 0:t.bootDiagnostics)||void 0===x?void 0:x.legacyPerformanceData.host,null===(G=null==t?void 0:t.bootDiagnostics)||void 0===G?void 0:G.legacyPerformanceData.owlFrame)),(0,F.YV)(O,p,N,M,i.performance,t,null==e?void 0:e.featureGates)),{legacyPerformanceData:null===(L=null==t?void 0:t.bootDiagnostics)||void 0===L?void 0:L.legacyPerformanceData}):(0,F.ge)(O,p,N,M,i.performance,t,null==e?void 0:e.featureGates),sessionContext:T||(0,F.l_)(),preseededSession:{key:W.preSeededSessionKey,id:W.preSeededWacSessionId},wdParams:(0,o.pi)((0,o.pi)((0,o.pi)({},m.templateId&&(l={},l.wdTpl=m.templateId,l)),_&&_.lcid&&(U={},U.wdlcid=_.lcid,U)||m.uiCulture&&(P={},P.wdlcid=m.uiCulture,P)),(0,F.q6)(m.wdValue)),hostGeneratedSessionId:null==t?void 0:t.sessionId,meeting:null==t?void 0:t.meeting,rebootOverride:_,throttling:{protection:null===(B=W.wac)||void 0===B?void 0:B.clientThrottlingProtection,request:null===(V=W.wac)||void 0===V?void 0:V.requestedCallThrottling}};(0,I.l5)(A.r_.OwlWacBootStart),(d.r.isCreateNewFlowExecuting?d.r.completeCreateNewPromise:Q.boot(X,a)).then((function(n){var e,t,o;if("success"===n.completion)s.next({wopiHostData:W,officeApplication:q,bootedDocumentInfo:new C.X(m),officeDocumentSession:Q,wacBootDiagnostics:null===(e=null==Q?void 0:Q.diagnostics)||void 0===e?void 0:e.appInitDiagnostics}),s.complete();else if("cancelled"===n.completion)null==j||j.ULS.sendTraceTag(509646293,v.W.oo,h.G.Info,"User cancelled document session boot");else{var i=n.completion,r=!!(null===(t=n.error)||void 0===t?void 0:t.documentLoadedWithTabSwitch);try{null===(o=n.error)||void 0===o||delete o.documentLoadedWithTabSwitch}catch(n){null==j||j.ULS.sendTraceTag(507568407,v.W.oo,h.G.Warning,'Failed to delete "documentLoadedWithTabSwitch" from error object, Error: '.concat(n))}var u={wacErrorName:c.AU.po,qosErrorName:c.DG.QosError_EncounteredJsApiError,errorMessage:i,error:n.error,documentLoadedWithTabSwitch:r},a=(0,y.x)(u),l=JSON.stringify(Array.from(a.entries()));null==j||j.ULS.sendTraceTag(575419404,v.W.oo,h.G.Error,l),s.error(u)}})).catch((function(n){return null==j?void 0:j.ULS.sendTraceTag(512337547,v.W.oo,h.G.Error,"officeDocumentSession.boot threw error: ".concat(n))}))}))}):(null==x||x.addOrUpdatePartCDimension("JsApiVersion","V1"),f=function(o){var u=o.container,a=o.flushTime;return new l.y((function(o){var s=(0,F.N6)(W?W.wac.userId:k,g,R,D,e,t,(0,F.q6)(m.wdValue),T),l=(0,F.EN)(m,W),d=(0,F.ge)(O,a,N,M,i.performance,t,null==e?void 0:e.featureGates),f=null==e?void 0:e.uiHostName,p=(0,F.v1)(W.wac),w=(0,F.UI)(u,i,p,s,l,d,(function(n,e){o.next({wopiHostData:W,officeApplication:n,bootedDocumentInfo:new C.X(m),wopiPendingApp:b,wacBootDiagnostics:e}),o.complete()}),(function(n){var e=n.errorObject.message,t={wacErrorName:c.AU.mo,qosErrorName:c.DG.QosError_EncounteredJsApiError,errorName:n.errorType,errorMessage:e,error:n},i=(0,y.x)(t),r=JSON.stringify(Array.from(i.entries()));null==j||j.ULS.sendTraceTag(575419405,v.W.oo,h.G.Error,r),o.error(t)}),f,m,W,null==e?void 0:e.showCloseButton,null==e?void 0:e.supportsShare,null==e?void 0:e.openInBrowserEnabled,null==e?void 0:e.ellipsisDownloadACopyButtonEnabled,null==e?void 0:e.copyLinkEnabled,null==e?void 0:e.uiEmbed,null==e?void 0:e.supportsHostUiControls,null==e?void 0:e.conversationButtonEnabled,null==t?void 0:t.additionalApplicationParameters),S=(0,I.a)();null==j||j.ULS.sendTraceTag(576578583,v.W.oo,h.G.Info,"BootStrapFile: About to call InitializeWopiPending");var b=n.Application.InitializeWopiPending(w,void 0,null==t?void 0:t.sessionId),H=(0,I.a)()-S;null==j||j.ULS.sendTraceTag(570775769,v.W.oo,h.G.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!b,"][TimeElapsed: ").concat(H,"]"));var A=(0,I.a)();if(b){r&&r(),b.Complete(p);var U=(0,I.a)(),P=U-A,E=U-S;null==j||j.ULS.sendTraceTag(570775770,v.W.oo,h.G.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(P,"][TimeElapsedSinceInitializeWopiPending: ").concat(E,"]"))}else{var _={wacErrorName:c.AU.wo,qosErrorName:c.DG.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"},x=(0,y.x)(_),G=JSON.stringify(Array.from(x.entries()));o.error(_),null==j||j.ULS.sendTraceTag(575419406,v.W.oo,h.G.Error,G)}}))}),p.next(f),p.complete()},d.r.isTwoStepCreateNew&&d.r.bootstrapperLoadPromise?d.r.bootstrapperLoadPromise.then((function(n){n?f(d.r.bootstrapper,d.r.bootstrapperInfo):null==j||j.ULS.sendTraceTag(507778322,v.W.oo,h.G.Warning,"Office bootstrapper failed to load for 2-step create new, check previous logs for more details")})).catch((function(n){return null==j?void 0:j.ULS.sendTraceTag(507778321,v.W.oo,h.G.Error,"Encountered error loading Office bootstrapper for 2-step create new: ".concat(n))})):(0,T.g)(J,W.wac.applicationUrl,E,!0,null==t?void 0:t.wiseEnvironment,j).then((function(n){var e=(0,o.CR)((0,T.n)(E),2),t=e[0],r=e[1];if(!r&&t)f(t,n);else{var u=null!=r?r:"Error message undefined. BootStrapped not loaded: ".concat(!t);null==j||j.ULS.sendTraceTag(575419403,v.W.oo,h.G.Error,u);var a={wacErrorName:c.AU.So,qosErrorName:c.DG.QosError_OfficeBootstrapperNotLoaded,errorMessage:u,error:r,inStaging:!1};i&&i(a)}})).catch((function(n){s(n)})),[2]}))}))}));Promise.race([z,Q]).catch((function(n){var e=(null!=n?n:"Failed to load the document")+", bootstrapperUrl: ".concat(J.replace(/^https?:\/\//,"")),t={wacErrorName:c.AU.wo,qosErrorName:c.DG.QosError_FailedToLoadDocument,errorMessage:e,error:n,inStaging:!1};null==j||j.ULS.sendTraceTag(575419407,v.W.oo,h.G.Error,"".concat(c.AU.wo,": ").concat(e)),i&&i(t)}))}var E,N=t(933);function k(n){return E?"".concat(n,".").concat(E.size):n}function R(n,e,t,r,u,a,v,h,p,m,w,S){if(void 0===v&&(v=!1),E||(E=new Map),!n.isNewFile||!n.createNewInfo&&!n.isTwoStepCreateNew){var b=(0,U.q_)(n);if(!b)return{correlationId:e,bootstrapperObservable:("Not enough document information was provided",new l.y((function(n){return n.error("Not enough document information was provided")}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var I=E.get(b);if(I)return I}return function(n,e,t,r,u,a,l,v,h,p,m,w){var S,b;void 0===l&&(l=!1);var I=k(e),C=null==u?void 0:u.logger,H=new s,A=null!=w?w:P;if(!d.r.isTwoStepCreateNew||!d.r.hostSessionId||!(null==u?void 0:u.createNewParams)){var y=(0,N.o)(n,t,C,l,!(!n.isNewFile&&!n.templateId),1,!!(null==u?void 0:u.meeting));y.then((function(e){var t;A({documentBootInfo:(0,o.pi)((0,o.pi)({},n),e.documentIdentifier),correlationId:I,loadFunctionSubject:H,wopiFetchData:e},r,u,a,v,h,p,null===(t=null==m?void 0:m.get(n.fileType))||void 0===t?void 0:t.jsApiUrl)})).catch((function(e){if(d.r.isTwoStepCreateNew&&d.r.session&&d.r.session.run(i.O.completeCreateNew,{state:"failure",reason:"wopiFetchFailed"},p),a){var t=JSON.stringify(e),o={wacErrorName:c.AU.bo,qosErrorName:c.DG.QosError_VroomWopiFailure,errorMessage:t,error:e,httpErrorCode:e.status,networkError:(0,f.eE)(e)};a(o,n)}}));var T={correlationId:I,bootstrapperObservable:H.asObservable(),fileNamePromise:n.fileName?Promise.resolve(n.fileName):y.then((function(n){return n.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(n,e){y.then((function(e){var t,o;return n(null===(o=null===(t=null==e?void 0:e.wopiHostData)||void 0===t?void 0:t.wac)||void 0===o?void 0:o.applicationUrl)})).catch((function(n){e(n)}))}))};return u&&u.wiseEnvironment&&g(T.applicationUrlPromise,u.wiseEnvironment,C,u.health,null==r?void 0:r.featureGates,u.sessionId),T}A({documentBootInfo:n,correlationId:I,loadFunctionSubject:H,wopiFetchData:(0,U.PI)(u.createNewParams,n)},r,u,a,v,h,p,null===(S=null==m?void 0:m.get(n.fileType))||void 0===S?void 0:S.jsApiUrl);var F={correlationId:d.r.hostSessionId,bootstrapperObservable:H.asObservable(),fileNamePromise:Promise.resolve(n.fileName),applicationUrlPromise:Promise.resolve(null===(b=null==u?void 0:u.createNewParams)||void 0===b?void 0:b.appUrl)};return u&&u.wiseEnvironment&&g(F.applicationUrlPromise,u.wiseEnvironment,C,u.health,null==r?void 0:r.featureGates,u.sessionId),F}(n,e,t,r,u,a,v,h,p,m,w,S)}},2544:function(n,e,t){t.d(e,{PI:function(){return f},VN:function(){return d},YI:function(){return c},q_:function(){return l},ss:function(){return v}});var o=t(6709),i=t(5796),r=t(280),u=t(759),a=t(2506),s=t(3979);function l(n){return n.shareUrl?n.shareUrl:n.docId&&n.driveId?"".concat(n.driveId,"_").concat(n.docId):n.docUrl?n.docUrl:n.isNewFile&&n.fileName?"".concat(n.fileName,"_").concat(u.T[n.fileType]):n.baseUrl&&n.fileId?"".concat(n.baseUrl,"_").concat(n.fileId):void 0}function c(n,e){var t,u,a,s,l,c,d,f,v,h=!!(null==n?void 0:n.openWith),p=!!(null===(t=null==n?void 0:n.openWith)||void 0===t?void 0:t.wac);return null==e||e.ULS.sendTraceTag(553916429,i.W.oo,r.G.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(h,"][ValidWac: ").concat(p,"]")),{bundleStaleness:n.officeBundle?n.officeBundle.bundleStaleness:0,bundleUrl:n.officeBundle?n.officeBundle.url:"",bundleVersion:n.officeBundle?n.officeBundle.version:"",sharepointSiteUrl:n.sharepointIds?n.sharepointIds.siteUrl:"",downloadUrl:n["@content.downloadUrl"]||n["@microsoft.graph.downloadUrl"],eTag:n.eTag,fileName:n.name,fileSize:n.size,irmEnabled:(null===(u=n.file)||void 0===u?void 0:u.contentSensitivityLabelProtected)||(null===(a=n.file)||void 0===a?void 0:a.irmEffectivelyEnabled)||(null===(s=n.sensitivityLabel)||void 0===s?void 0:s.protectionEnabled)||(null===(l=n.file)||void 0===l?void 0:l.irmEnabled),protectionEnabled:(null===(c=n.sensitivityLabel)||void 0===c?void 0:c.protectionEnabled)||(null===(d=n.file)||void 0===d?void 0:d.contentSensitivityLabelProtected),isNewFile:!1,readOnly:n.currentUserRole&&n.currentUserRole.readOnly,blocksDownload:n.currentUserRole&&n.currentUserRole.blocksDownload,wac:n.openWith.wac,sharePointInfo:(0,o.pi)({},n.sharepointIds),webUrl:n.webUrl,preSeededSessionKey:null===(f=null==n?void 0:n.wacSession)||void 0===f?void 0:f.preSeededSessionKey,preSeededWacSessionId:null===(v=null==n?void 0:n.wacSession)||void 0===v?void 0:v.preSeededWacSessionId,webDavUrl:n.webDavUrl}}function d(n,e,t,i,r){var u,l,c,d,f,h,p,m,w,g,S,b,I,C,H,A,y,T,U,F,P,E,N,k,R;if(!n.appUrl)throw new Error("appUrl must be provided in CreateNewParams");return{appUrl:(0,s.e8)(void 0,n.appUrl,(null==i?void 0:i.uiHostName)||"OWL-2-step-create-new",e,null==i?void 0:i.uiEmbed),file:(0,o.pi)({name:null===(c=n.file)||void 0===c?void 0:c.name,getUrl:null===(d=n.file)||void 0===d?void 0:d.getUrl,size:null===(f=n.file)||void 0===f?void 0:f.size,eTag:null===(h=n.file)||void 0===h?void 0:h.eTag},e.docId&&{uniqueId:e.docId}),customFontCatalogUrl:n.customFontCatalogUrl,contentBundle:{majorVersion:(null===(p=n.contentBundle)||void 0===p?void 0:p.majorVersion)?Number(null===(m=n.contentBundle)||void 0===m?void 0:m.majorVersion):0,url:null!==(g=null===(w=n.contentBundle)||void 0===w?void 0:w.url)&&void 0!==g?g:"",staleness:(null===(S=n.contentBundle)||void 0===S?void 0:S.staleness)||0},newFileTemplate:e.newFileTemplate,container:t,bootParams:{readOnly:null===(b=n.bootParams)||void 0===b?void 0:b.readOnly,irmEnabled:null===(I=n.bootParams)||void 0===I?void 0:I.irmEnabled,supportsDecryptedContentDownload:null===(C=n.bootParams)||void 0===C?void 0:C.supportsDecryptedContentDownload,viewOnly:null===(H=n.bootParams)||void 0===H?void 0:H.viewOnly,disableChat:!0,openViewByDefault:"view"===e.intent,dataLanguage:e.dataCulture},diagnostics:(null===(A=null==r?void 0:r.bootDiagnostics)||void 0===A?void 0:A.legacyPerformanceData)?(0,o.pi)((0,o.pi)((0,o.pi)({},(0,s.xL)(null===(y=null==r?void 0:r.bootDiagnostics)||void 0===y?void 0:y.legacyPerformanceData.host,null===(T=null==r?void 0:r.bootDiagnostics)||void 0===T?void 0:T.legacyPerformanceData.owlFrame)),(0,s.YV)(e.clickTime,0,e.wdOrigin,void 0,null===(U=a.r.bootstrapperInfo)||void 0===U?void 0:U.performance,r,null==i?void 0:i.featureGates)),{legacyPerformanceData:null===(F=null==r?void 0:r.bootDiagnostics)||void 0===F?void 0:F.legacyPerformanceData}):(0,s.ge)(e.clickTime,0,e.wdOrigin,void 0,null===(P=a.r.bootstrapperInfo)||void 0===P?void 0:P.performance,r,null==i?void 0:i.featureGates),sessionContext:v(n.appUrl)||(0,s.l_)(),preseededSession:{key:null===(E=n.preseededSession)||void 0===E?void 0:E.key,id:null===(N=n.preseededSession)||void 0===N?void 0:N.id},wdParams:(0,o.pi)((0,o.pi)((0,o.pi)({},e.templateId&&(u={},u.wdTpl=e.templateId,u)),e.uiCulture&&(l={},l.wdlcid=e.uiCulture,l)),(0,s.q6)(e.wdValue)),hostGeneratedSessionId:null==r?void 0:r.sessionId,meeting:null==r?void 0:r.meeting,throttling:{protection:null===(k=n.throttling)||void 0===k?void 0:k.protection,request:null===(R=n.throttling)||void 0===R?void 0:R.request}}}function f(n,e){var t,o,i,r,u,s,l,c,d,f,v,h;return{documentIdentifier:{docUrl:e.docUrl,driveId:e.driveId,docId:e.docId,fileName:null===(t=n.file)||void 0===t?void 0:t.name},wopiHostData:{bundleStaleness:null===(o=n.contentBundle)||void 0===o?void 0:o.staleness,bundleUrl:null===(i=n.contentBundle)||void 0===i?void 0:i.url,bundleVersion:null===(r=n.contentBundle)||void 0===r?void 0:r.majorVersion.toString(),downloadUrl:null===(u=n.file)||void 0===u?void 0:u.getUrl,eTag:null===(s=n.file)||void 0===s?void 0:s.eTag,fileName:null===(l=n.file)||void 0===l?void 0:l.name,fileSize:null===(c=n.file)||void 0===c?void 0:c.size,irmEnabled:null===(d=n.bootParams)||void 0===d?void 0:d.irmEnabled,protectionEnabled:null===(f=n.bootParams)||void 0===f?void 0:f.supportsDecryptedContentDownload,isNewFile:!!e.isNewFile,readOnly:!!(null===(v=n.bootParams)||void 0===v?void 0:v.readOnly),blocksDownload:!!(null===(h=n.bootParams)||void 0===h?void 0:h.viewOnly),sharePointInfo:{},wac:{bootstrapperUrl:a.r.bootstrapperUrl,applicationUrl:n.appUrl,userId:e.puid}},fetchDiagnostics:{}}}function v(n,e){var t;try{t=new URLSearchParams(new URL(n).search).get("sc")||void 0}catch(n){null==e||e.ULS.sendTraceTag(520135565,i.W.oo,r.G.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(n)))}return t}},3979:function(n,e,t){t.d(e,{EN:function(){return m},N2:function(){return v},N6:function(){return p},UI:function(){return U},YV:function(){return b},ZR:function(){return A},e8:function(){return y},fG:function(){return g},ge:function(){return S},l_:function(){return h},q6:function(){return T},t1:function(){return H},v1:function(){return w},xL:function(){return I}});var o=t(6709),i=t(5796),r=t(280),u=t(8959),a=t(759),s=t(1507),l=t(681),c=t(4048),d=t(3594),f=t(1305),v="officecom";function h(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function p(n,e,t,o,i,r,u,a){return{HostName:"office.com",HostSessionId:e,UserId:n,OwnerId:void 0,UiLocale:t,DataLocale:o,DisableChat:!0,CookieCompliant:!0,WdParams:u,DisableFocusOnBoot:!1,SessionContext:a||h(),HighContrastMode:null==r?void 0:r.highContrastMode,HideHeader:null==i?void 0:i.hideHeader,HideAppLauncherInHeader:null==i?void 0:i.hideAppLauncherInHeader,HideSearchInHeader:null==i?void 0:i.hideSearchInHeader,HideMeInHeader:null==i?void 0:i.hideMeInHeader,HideChatInHeader:null==i?void 0:i.hideChatInHeader,HideWorkflowInHeader:null==i?void 0:i.hideWorkflowInHeader,HideSettingsInHeader:null==i?void 0:i.hideSettingsInHeader,ShowAppIconInHeader:null==i?void 0:i.showAppIconInHeader,UseNeutralColorInHeader:null==i?void 0:i.useNeutralColorInHeader,SupportsDocReboot:null==i?void 0:i.supportsDocumentReboot,SupportsCreateNewDocument:null==i?void 0:i.supportsCreateNewDocument,SupportsAuthToken:null==i?void 0:i.supportsAuthToken,SupportsAtMentions:null==i?void 0:i.supportsAtMentions,SupportsMoveToFolder:null==i?void 0:i.supportsMoveToFolder,SupportsCommonFilePicker:null==i?void 0:i.supportsCommonFilePicker,SupportsDirectPrint:null==i?void 0:i.supportsDirectPrint,SupportsDirectDownload:null==i?void 0:i.supportsDirectDownload,MetaUiHostVersion:null==r?void 0:r.metaUiHostVersion,SupportsAccessibilityLoop:null==i?void 0:i.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==i?void 0:i.supportsExcelExternalLinks,UiHostIntegrationType:null==i?void 0:i.uiHostIntegrationType,OpenLinksInNewWindow:null==i?void 0:i.openLinksInNewWindow,UiHostTabId:null==r?void 0:r.uiHostTabId,Upn:null==r?void 0:r.upn,TenantId:null==r?void 0:r.tenantId,Meeting:null==r?void 0:r.meeting,SupportsCustomAuthConfig:null==i?void 0:i.supportsCustomAuthConfig,ContentAssemblyMode:null==i?void 0:i.contentAssemblyMode,SupportsRefreshAccessToken:null==i?void 0:i.supportsRefreshAccessToken,IsSynthetic:null==r?void 0:r.isSynthetic,OwlVersion:null==r?void 0:r.owlVersion,OwlRollout:null==r?void 0:r.owlRollout}}function m(n,e){var t,i,r,u=n.docId,a=n.isNewFile,s=n.fileName,l=n.intent;return e?(0,o.pi)((0,o.pi)({FileName:e.fileName,FileGetUrl:(null===(t=e.wac)||void 0===t?void 0:t.fileGetUrl)||e.downloadUrl,CustomFontCatalogUrl:e.wac.customFontCatalogUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion,BundleStaleness:e.bundleStaleness},ReadOnly:e.readOnly,IrmEnabled:e.irmEnabled,ViewOnly:e.blocksDownload,ETag:e.eTag,ClientThrottlingProtection:null===(i=e.wac)||void 0===i?void 0:i.clientThrottlingProtection,RequestedCallThrottling:null===(r=e.wac)||void 0===r?void 0:r.requestedCallThrottling,IsNewFile:!!a||e.isNewFile},u&&{DocUniqueId:u}),{OpenViewByDefault:"view"===l}):(0,o.pi)({FileName:s,IsNewFile:!0},u&&{DocUniqueId:u})}function w(n){return{WopiSrc:n.wopiSrc,AccessToken:n.accessToken,AccessTokenExpiry:new Date(parseInt(n.accessTokenExpiry,10)),WacToken:n.wacToken}}function g(n){switch((0,l.aE)(n)){case l.o4.OneDrive:return"OneDrive";case l.o4.SharePoint:return"SharePoint Online";default:return"Unknown"}}function S(n,e,t,i,r,u,a){void 0===i&&(i={startTime:0,endTime:0}),void 0===r&&(r={startTime:0,endTime:0});var s=window.performance.timing,l=window.performance.navigation,c=l.redirectCount||0,d=s.navigationStart||0,f=s.fetchStart||0,v=s.responseEnd||0,h=s.requestStart||0,p=s.responseStart||0,m=s.responseEnd||0,w=s.domComplete||0,g="UNKNOWN";switch(l.type){case 0:g="NAVIGATE";break;case 1:g="RELOAD";break;case 2:g="BACK_FORWARD";break;case 255:g="RESERVED"}return(0,o.pi)((0,o.pi)({},b(n,e,t,i,r,u,a)),{hostPageNavigationStartTime:d,hostPageFetchStartTime:f,hostPageFetchEndTime:v,hostPageRequestStartTime:h,hostPageResponseStartTime:p,hostPageResponseEndTime:m,hostPageDomCompleteTime:w,hostPageRedirectCount:c,hostPageNavigationType:g})}function b(n,e,t,a,l,d,v){void 0===a&&(a={startTime:0,endTime:0}),void 0===l&&(l={startTime:0,endTime:0});var h=l.startTime||0,p=l.endTime||0,m=(0,u.a)();(0,u.l5)("officeInitializationTime");var w,g,S=null==d?void 0:d.logger,b=(null==d?void 0:d.bootDiagnostics)||{},I=b.tabsCacheHit,C=b.packageEntryTime,H=b.isTestMode,A=b.ringId;n&&(w=m-n),C&&(g=m-C);var y=(0,o.pi)((0,o.pi)((0,o.pi)({},b),s.c),{bootStrapStartTime:(null==l?void 0:l.startTime)||0,bootStrapEndTime:(null==l?void 0:l.endTime)||0,wopiDataStartTime:(null==a?void 0:a.startTime)||0,wopiDataEndTime:(null==a?void 0:a.endTime)||0,isCookieBlocked:!c.X,createNewEndTime:b.createNewStartTime?(0,u.a)():void 0,owlFeatureGates:v?(0,f.d)(v):void 0});return s.c.accessTokenStartTime=void 0,s.c.accessTokenEndTime=void 0,s.c.driveItemStartTime=void 0,s.c.driveItemEndTime=void 0,s.c.driveItemFromWacStartTime=void 0,s.c.driveItemFromWacEndTime=void 0,s.c.spRequestGuid=void 0,s.c.createNewStartTime=void 0,s.c.createNewEndTime=void 0,s.c.loadManifestStartTime=void 0,s.c.loadManifestEndTime=void 0,s.c.getManifestFromRemoteTimeElapsed=void 0,s.c.loadManifestServerTimeElapsed=void 0,s.c.loadOwlStartTime=void 0,s.c.loadOwlEndTime=void 0,s.c.isVroom21=!1,null==S||S.ULS.sendTraceTag(556613895,i.W.oo,r.G.Info,"getDiagnostics: [SessionOrigin: ".concat(t,"][TabsCacheHit: ").concat(I,"][IsTestMode: ").concat(H,"][RingId: ").concat(A,"][TimeElapsedSinceUserClick:").concat(w,"][TimeElapsedSincePackageEntry: ").concat(g,"]")),{entryPoint:t,hostPageFirstFlushTime:e,userClickTime:n,officeBootstrapperStartTime:h,officeBootstrapperEndTime:p,officeInitializationTime:m,unifiedUiHostDiagnostics:y}}function I(n,e){var t="UNKNOWN";switch(null==n?void 0:n.navigation.type){case 0:t="NAVIGATE";break;case 1:t="RELOAD";break;case 2:t="BACK_FORWARD";break;case 255:t="RESERVED"}var o="UNKNOWN";switch(null==e?void 0:e.navigation.type){case 0:o="NAVIGATE";break;case 1:o="RELOAD";break;case 2:o="BACK_FORWARD";break;case 255:o="RESERVED"}return{hostPageNavigationStartTime:(null==n?void 0:n.timing.navigationStart)||0,hostPageFetchStartTime:(null==n?void 0:n.timing.fetchStart)||0,hostPageFetchEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageRequestStartTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageResponseStartTime:(null==n?void 0:n.timing.responseStart)||0,hostPageResponseEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageDomCompleteTime:(null==n?void 0:n.timing.domComplete)||0,hostPageRedirectCount:(null==n?void 0:n.navigation.redirectCount)||0,hostPageNavigationType:t,owlFramePageNavigationStartTime:(null==e?void 0:e.timing.navigationStart)||0,owlFramePageFetchStartTime:(null==e?void 0:e.timing.fetchStart)||0,owlFramePageFetchEndTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageRequestStartTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageResponseStartTime:(null==e?void 0:e.timing.responseStart)||0,owlFramePageResponseEndTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageDomCompleteTime:(null==e?void 0:e.timing.domComplete)||0,owlFramePageRedirectCount:(null==e?void 0:e.navigation.redirectCount)||0,owlFramePageNavigationType:o}}var C=function(n){var e=new URL(n);return e.searchParams.delete("wopisrc"),e.href};function H(n){return function(e){var t=e;switch(e){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":t="unifiedUiHostInTeams"}if((null==n?void 0:n.experiments)&&t in(null==n?void 0:n.experiments))return function(n){switch(n){case 0:return!1;case 1:return!0;default:return}}(null==n?void 0:n.experiments[t])}}function A(n,e,t){switch(n){case a.T.Word:case a.T.PowerPoint:case a.T.Excel:case a.T.Visio:return!0;case a.T.OneNote:var o=(0,d.vJ)(d.Fh.FeatureGate_OneNoteJsApiV2Gate,e);return(0,d.dt)(d.Fh.FeatureGate_OneNoteJsApiV2Gate,o,t),o;default:return!1}}function y(n,e,t,o,i){var r,u,a=n?(null===(r=n.wac)||void 0===r?void 0:r.applicationUrl)||(null===(u=n.wac)||void 0===u?void 0:u.editUrl):C(e);return a?function(n,e,t,o,i,r){var u="".concat(n,"&uih=").concat(e);return(null==r||r)&&(u="".concat(u,"&uiEmbed=1")),o&&(u="".concat(u,"&wdTpl=").concat(o)),i&&(u="".concat(u,"&wdlcid=").concat(i)),t&&(u="".concat(u,"&actNavId=").concat(t)),u}(a,t,o.navId,o.templateId,o.rebootOverrideData?o.rebootOverrideData.lcid:o.uiCulture,i):""}function T(n){var e;return n?((e={}).wd=encodeURIComponent(n),e):{}}function U(n,e,t,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,b){var I=e.applicationUrl,C=e.bootstrapperUrl;void 0===l&&(l="officecom"),void 0===b&&(b={});var A={HostUIControls:g?[{id:"close",visibility:f?1:0},{id:"share",visibility:v?1:0},{id:"ellipsisOpenInBrowser",visibility:h?1:0},{id:"ellipsisDownload",visibility:p?1:0},{id:"copyLink",visibility:m?1:0},{id:"conversation",visibility:S?1:0}]:void 0,additionalApplicationParameters:b},T=y(d,I,l,c,w);return(0,o.pi)({BootstrapperUrl:C,Container:n,SessionInformation:i,ApplicationUrl:T,WopiPrecheckInfo:r,ApplicationCustomSettings:A,Diagnostics:u,FnOnInitializeSuccess:a,FnOnInitializeFailure:s,FnIsFeatureEnabled:H(),RebootOverrideData:c.rebootOverrideData},t?{WopiInfo:t}:{})}},3821:function(n,e,t){t.d(e,{X$:function(){return o},a6:function(){return a},gP:function(){return u},oZ:function(){return r},ok:function(){return s}});var o,i=t(6709),r=[];function u(){r=[]}function a(n){var e=this;return function(o){return(0,i.mG)(e,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([t.e(5415),t.e(3648)]).then(t.bind(t,4347))];case 1:return[4,e.sent().wopiInfoFromUrlHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}function s(n){var e=this;return function(o){return(0,i.mG)(e,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([t.e(5415),t.e(3648)]).then(t.bind(t,4347))];case 1:return[4,e.sent().davUrlFromIdsHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}!function(n){n[n.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",n[n.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(o||(o={}))},3065:function(n,e,t){t.d(e,{R:function(){return a}});var o=t(5796),i=t(280),r=t(5540),u=t(7783);function a(n,e,t,a,s){if(a){var l=function(n){switch(n){case r.KX.PostMessage_RefreshSessionInfo:return u.O.sendSessionInfo;case r.KX.PostMessage_GrantPermissions:return u.O.sendUserAccessAndPermissions;case r.KX.PostMessage_SetAuthToken:return u.O.sendAuthToken;case r.KX.PostMessage_HostAccessibilityLoopComplete:return u.O.continueAccessibilityLoop;case r.KX.PostMessage_SetHostWopiInfoFromUrl:return u.O.sendWopiInfo;case r.KX.PostMessage_MoveToFolderCompleted:return u.O.moveToFolder;case r.KX.PostMessage_CompleteFilePicker:return u.O.completeSharedFilePicker;case r.KX.PostMessage_SendCustomAuthConfig:return u.O.sendCustomAuthConfig;case r.KX.PostMessage_SetDavUrlFromIds:return u.O.sendDavUrl;case r.KX.PostMessage_BlurFocus:return u.O.blurFocus;case r.KX.PostMessage_PopState:return u.O.popState;case r.KX.PostMessage_GrabFocus:return u.O.grabFocus;case r.KX.PostMessage_HostGetClientUrl:return u.O.getClientUrl;case r.KX.PostMessage_HostGetWebUrl:return u.O.getWebUrl;case r.KX.PostMessage_OwlFrameDiagnostics:return u.O.sendOwlFrameDiagnostics;case r.KX.PostMessage_HostBackButtonPressed:return u.O.backButtonPressed;case r.KX.PostMessage_HostSendChannelId:return u.O.sendChannelId;case r.KX.PostMessage_HostSendConversationId:return u.O.sendConvId;case r.KX.PostMessage_PostWacToken:return u.O.postWacToken;default:return}}(n);if(l){var c=l;a.run(c,e).catch((function(n){return null==s?void 0:s.ULS.sendTraceTag(512337544,o.W.oo,i.G.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(n))}))}}else t?t.then((function(t){t?function(n,e,t,r){var u,a=null;try{a=new URL(n)}catch(e){return void(null==r||r.ULS.sendTraceTag(541180047,o.W.oo,i.G.Warning,"Failed to send post message. could not create url from ".concat(n," with error: ").concat(e)))}var s=a.origin,l={MessageId:e,SendTime:(new Date).getTime(),Values:t},c=JSON.stringify(l),d=document.getElementById("WebApplicationFrame");d?null===(u=null==d?void 0:d.contentWindow)||void 0===u||u.postMessage(c,s):null==r||r.ULS.sendTraceTag(541180048,o.W.oo,i.G.Warning,"Failed to send post message. Could not find iframe")}(t,n,e,s):null==s||s.ULS.sendTraceTag(541180045,o.W.oo,i.G.Warning,"Failed to send post message. appUrl is null")})).catch((function(n){return null==s?void 0:s.ULS.sendTraceTag(512337543,o.W.oo,i.G.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(n))})):null==s||s.ULS.sendTraceTag(541180046,o.W.oo,i.G.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}},1208:function(n,e,t){var o;function i(n){var e=n.toUpperCase();return"CHC"===e||"DEC"===e||"EUC"===e||"EURPPC"===e||"FRC"===e||"SEC"===e||"NOC"===e?o.EuropeanUnion:o.RestOfWorld}t.d(e,{U:function(){return o},g:function(){return i}}),function(n){n[n.RestOfWorld=0]="RestOfWorld",n[n.EuropeanUnion=1]="EuropeanUnion"}(o||(o={}))},2199:function(n,e,t){t.d(e,{A8:function(){return s},PO:function(){return l},S$:function(){return u},XQ:function(){return a},Y6:function(){return d},fy:function(){return r},tf:function(){return f},w8:function(){return c},wl:function(){return i}});var o=t(1208);function i(n,e){switch(n){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return e===o.U.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function r(n,e){return i(n,e)+"RemoteUls.ashx"}function u(n,e,t){var o=i(n,t)+"RemoteTelemetry.ashx";return e&&(o+="?usid="+e),o}function a(n,e){return"".concat(i(n),"OpenDocument.ashx").concat(e?"?corrid=".concat(e,"&usid=").concat(e):"")}function s(n){switch(n){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function l(n){switch(n){case"TRAILBLAZER":return"https://admin.onedrive.us/share";case"PATHFINDER":return"https://od.apps.mil/share";case"AIRGAP08":return"https://odweba.svc.ms.eaglex.ic.gov";case"AIRGAP09":return"https://odweba.svc.ms.microsoft.scloud";default:return"https://www.odwebp.svc.ms/share"}}function c(){return"res.cdn.office.net/officehub"}function d(){return"https://microsoft-my.sharepoint.com"}function f(){return"https://microsoft.sharepoint.com"}},5904:function(n,e,t){t.d(e,{ep:function(){return r}});var o=t(5796),i=t(280),r=function(){function n(){}return n.toFeatureGateConfig=function(n,e){if(null==n||""===n||"null"===n)return[];try{return function(n,e,t){return l(n,e,a,t)}(JSON.parse(n),c(d("FeatureGateConfig")),e)}catch(t){return null==e||e.ULS.sendTraceTag(521413921,o.W.oo,i.G.Error,'Unable to parse JSON string: "'.concat(n,'", due to expection: ').concat(t)),[]}},n.featureGateConfigToJson=function(n,e){return JSON.stringify(function(n,e,t){return l(n,e,s,t)}(n,c(d("FeatureGateConfig")),e),null,2)},n}();function u(n,e,t,r){if(void 0===r&&(r=""),r?null==t||t.ULS.sendTraceTag(521414033,o.W.oo,i.G.Error,'Invalid value for key "'.concat(r,'". Expected type ').concat(JSON.stringify(n)," but got ").concat(JSON.stringify(e))):null==t||t.ULS.sendTraceTag(521414034,o.W.oo,i.G.Error,"Invalid value ".concat(JSON.stringify(e)," for type ").concat(JSON.stringify(n))),"boolean"==typeof n){if("string"==typeof e){var u=function(n){try{var e=JSON.parse(n.toLowerCase());return"boolean"==typeof e&&e}catch(n){return!1}}(e);if("boolean"==typeof u)return u}return!1}return"string"==typeof n?"":"number"==typeof n?0:typeof n==typeof[]?[]:"Date"===n?new Date:"array"===n?[]:"object"===n?{}:void 0}function a(n){if(void 0===n.jsonToJS){var e={};n.props.forEach((function(n){return e[n.json]={key:n.js,typ:n.typ}})),n.jsonToJS=e}return n.jsonToJS}function s(n){if(void 0===n.jsToJSON){var e={};n.props.forEach((function(n){return e[n.js]={key:n.json,typ:n.typ}})),n.jsToJSON=e}return n.jsToJSON}function l(n,e,t,o,i){void 0===i&&(i="");var r=e;if("any"===r)return n;if(null===r)return null===n?n:u(r,n,o);if(!1===r)return u(r,n,o);for(;"object"==typeof r&&void 0!==r.ref;)r=v[r.ref];return Array.isArray(r)?function(n,e){return-1!==n.indexOf(e)?e:u(n,e,o)}(r,n):"object"==typeof r?r.hasOwnProperty("unionMembers")?function(n,e){for(var i=n.length,r=0;r<i;r++){var a=n[r];try{return l(e,a,t,o)}catch(n){}}return u(n,e,o)}(r.unionMembers,n):r.hasOwnProperty("arrayItems")?function(n,e){return Array.isArray(e)?e.map((function(e){return l(e,n,t,o)})):u("array",e,o)}(r.arrayItems,n):r.hasOwnProperty("props")?function(n,e,i){if(null===i||"object"!=typeof i||Array.isArray(i))return u("object",i,o);var r={};return Object.getOwnPropertyNames(n).forEach((function(e){var u=n[e],a=Object.prototype.hasOwnProperty.call(i,e)?i[e]:void 0;r[u.key]=l(a,u.typ,t,o,u.key)})),Object.getOwnPropertyNames(i).forEach((function(u){Object.prototype.hasOwnProperty.call(n,u)||(r[u]=l(i[u],e,t,o,u))})),r}(t(r),r.additional,n):u(r,n,o):r===Date&&"number"!=typeof n?function(n){if(null===n)return null;var e=new Date(n);return isNaN(e.valueOf())?u("Date",n,o):e}(n):function(n,e){return typeof n==typeof e?e:u(n,e,o,i)}(r,n)}function c(n){return{arrayItems:n}}function d(n){return{ref:n}}var f,v={FeatureGateConfig:(f=[{json:"ConfigId",js:"ConfigId",typ:""},{json:"IsEnabled",js:"IsEnabled",typ:!0},{json:"SettingsRings",js:"SettingsRings",typ:""}],{props:f,additional:!1})}},4382:function(n,e,t){var o;t.d(e,{W:function(){return o}}),function(n){n[n.Unknown=0]="Unknown",n[n.OK=200]="OK",n[n.Created=201]="Created",n[n.NoContent=204]="NoContent",n[n.Unauthorized=401]="Unauthorized",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.RequestTimeout=408]="RequestTimeout",n[n.RequestEntityTooLarge=413]="RequestEntityTooLarge",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.Locked=423]="Locked",n[n.Throttled=429]="Throttled",n[n.InternalServiceError=500]="InternalServiceError",n[n.NotImplemented=501]="NotImplemented",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.UnexpectedResponse=700]="UnexpectedResponse",n[n.TokenRefreshFailed=701]="TokenRefreshFailed",n[n.TokenUnavailable=702]="TokenUnavailable",n[n.RetryFailed=703]="RetryFailed",n[n.AlternateResponse=704]="AlternateResponse",n[n.Cancelled=705]="Cancelled",n[n.Offline=706]="Offline",n[n.Timeout=707]="Timeout",n[n.DecryptionError=708]="DecryptionError",n[n.CacheMiss=709]="CacheMiss"}(o||(o={}))},5540:function(n,e,t){var o,i,r,u,a,s;t.d(e,{Bn:function(){return a},Dm:function(){return i},E_:function(){return o},KX:function(){return u}}),function(n){n.Event_DocumentReboot="DocReboot",n.Event_SetOverlayContent="SetOverlayContent",n.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",n.Event_Unloaded="Unloaded",n.Event_MoveToFolder="MoveToFolder",n.Event_SharedFilePicker="FilePicker",n.Event_GetCustomAuthConfig="GetCustomAuthConfig",n.Event_GetDavUrlFromIds="DavUrlFromIds"}(o||(o={})),function(n){n.PostMessage_FileRenamed="File_Rename",n.PostMessage_Close="UI_Close",n.PostMessage_EditModeSwitch="UI_Edit",n.PostMessage_FileVersion="UI_FileVersions",n.PostMessage_SaveStatus="UI_SaveStatus",n.PostMessage_Share="UI_Sharing",n.PostMessage_Workflow="UI_Workflow",n.PostMessage_UserActivity="User_Activity",n.PostMessage_EditNotification="Edit_Notification",n.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",n.PostMessage_PostMessageDocReboot="App_DocReboot",n.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",n.PostMessage_AppCreateNewDocument="App_CreateNewDocument",n.PostMessage_GetAuthToken="App_GetAuthToken",n.PostMessage_NavigateBackToHost="NavigateBackToHost",n.PostMessage_SendConversationId="App_SendConversationId",n.PostMessage_CloseTeamsConversation="CloseTeamsConversation",n.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",n.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",n.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",n.PostMessage_LoadingStatus="App_LoadingStatus",n.PostMessage_ActionComplete="Wac_ActionComplete",n.PostMessage_OpenInBrowser="UI_OpenInBrowser",n.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",n.PostMessage_AppPushState="App_PushState",n.PostMessage_CAAEMessage="CAAEMessage",n.PostMessage_FileEmbed="UI_FileEmbed"}(i||(i={})),function(n){n.Nav="actnavid"}(r||(r={})),function(n){n.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",n.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",n.PostMessage_SetOverlayContent="SetOverlayContent",n.PostMessage_SetAuthToken="Host_SetAuthToken",n.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",n.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",n.PostMessage_HostGetClientUrl="Host_GetClientUrl",n.PostMessage_HostGetWebUrl="Host_GetWebUrl",n.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",n.PostMessage_CompleteFilePicker="Host_FilePicker",n.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",n.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",n.PostMessage_BlurFocus="Blur_Focus",n.PostMessage_PopState="App_PopState",n.PostMessage_GrabFocus="Grab_Focus",n.PostMessage_OwlFrameDiagnostics="OwlFrameDiagnostics",n.PostMessage_HostSendChannelId="Host_SendChannelId",n.PostMessage_HostBackButtonPressed="Host_BackButtonPressed",n.PostMessage_HostSendConversationId="Host_SendConversationId",n.PostMessage_PostWacToken="Host_PostWacToken"}(u||(u={})),function(n){n.SameDocument="0",n.NewDocument="1"}(a||(a={})),function(n){n.AccessToken="AccessToken",n.FileGetUrl="FileGetUrl"}(s||(s={}))},167:function(n,e,t){t.d(e,{G2:function(){return a},pb:function(){return l},vb:function(){return c},zP:function(){return s}});var o=t(6709),i=t(6938),r=t(6277),u=t(2199),a=function(){function n(n,e){var t;"string"==typeof n?this.sessionId=n:(t=(0,o.CR)(n,1),this.sessionId=t[0]),this.environment=e,this.logger=this.setUlsLogger(this.sessionId)}return n.prototype.setUlsLogger=function(n){var e=(0,u.fy)(this.environment);return(0,i.L8)({remoteUlsEndpoint:e,sessionId:n})},n}(),s=function(n,e,t,o,i,a){var s,l=(0,u.S$)(t,n),c={application:e.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:n,clientVersion:null!=o?o:"n/a",isSynthetic:a};this.health=r.S9.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:l,dimensions:c}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",e.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",t.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(s=null==i?void 0:i.toString())&&void 0!==s?s:"n/a")};function l(){var n,e=null===(n=performance.getEntriesByType("navigation")[0])||void 0===n?void 0:n.toJSON();return{connectEnd:e.connectEnd,connectStart:e.connectStart,decodedBodySize:e.decodedBodySize,domainLookupEnd:e.domainLookupEnd,domainLookupStart:e.domainLookupStart,domComplete:e.domComplete,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domContentLoadedEventStart:e.domContentLoadedEventStart,domInteractive:e.domInteractive,duration:e.duration,encodedBodySize:e.encodedBodySize,entryType:e.entryType,fetchStart:e.fetchStart,initiatorType:e.initiatorType,loadEventEnd:e.loadEventEnd,loadEventStart:e.loadEventStart,nextHopProtocol:e.nextHopProtocol,redirectCount:e.redirectCount,redirectEnd:e.redirectEnd,redirectStart:e.redirectStart,requestStart:e.requestStart,responseEnd:e.responseEnd,responseStart:e.responseStart,secureConnectionStart:e.secureConnectionStart,serverTiming:e.serverTiming,startTime:e.startTime,transferSize:e.transferSize,type:e.type,unloadEventEnd:e.unloadEventEnd,unloadEventStart:e.unloadEventStart,workerStart:e.workerStart}}function c(){var n=window.performance.timing,e=window.performance.navigation,t={};return n&&(t.timing={navigationStart:n.navigationStart,redirectStart:n.redirectStart,redirectEnd:n.redirectEnd,fetchStart:n.fetchStart,domainLookupStart:n.domainLookupStart,domainLookupEnd:n.domainLookupEnd,connectStart:n.connectStart,connectEnd:n.connectEnd,secureConnectionStart:n.secureConnectionStart,requestStart:n.requestStart,responseStart:n.responseStart,responseEnd:n.responseEnd,domLoading:n.domLoading,domInteractive:n.domInteractive,domContentLoadedEventStart:n.domContentLoadedEventStart,domContentLoadedEventEnd:n.domContentLoadedEventEnd,domComplete:n.domComplete,loadEventStart:n.loadEventStart,loadEventEnd:n.loadEventEnd}),e&&(t.navigation={type:e.type,redirectCount:e.redirectCount}),t}},1507:function(n,e,t){var o,i,r,u,a,s;t.d(e,{$c:function(){return o},AU:function(){return a},DG:function(){return u},I$:function(){return s},J4:function(){return l},NF:function(){return c},c:function(){return d},cS:function(){return r},yv:function(){return i}}),function(n){n.DriveId="drive",n.ItemId="item",n.DocUrl="file",n.ContentUri="contenturi",n.Nav="nav"}(o||(o={})),function(n){n.Io="DavUrlFromIds",n.Co="WopiAuthRefresh",n.Ho="WopiAuthFetch",n.Ao="WopiInfoFromUrl"}(i||(i={})),function(n){n.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",n.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",n.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",n.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",n.QosVeto_FilePickerFailed="FilePickerFailed",n.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",n.QosVeto_OwlFrameExperienceFailed="OwlFrameExperienceFailed"}(r||(r={})),function(n){n.QosError_VroomWopiFailure="VroomWopiFailure",n.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",n.QosError_EncounteredJsApiError="EncounteredJsApiError",n.QosError_FailedToLoadDocument="FailedToLoadDocument",n.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",n.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",n.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",n.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",n.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",n.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",n.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",n.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",n.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",n.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",n.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",n.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",n.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",n.QosError_FilePickerBootFailed="FilePickerBootFailed",n.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",n.QosError_SelectedItemNotReturned="SelectedItemNotReturned",n.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",n.QosError_UrlNotProvided="UrlNotProvided",n.QosError_CallbackNotDefined="CallbackNotDefined",n.QosError_OwlFrameCreationFailure="OwlFrameCreationFailure"}(u||(u={})),function(n){n.ho="Bootstrapfile_WacDocumentVroomError",n.bo="LoadDocument_WacDocumentVroomError",n.So="WacDocumentBootstrapperLoadError",n.wo="WacInitializeWopiPendingError",n.yo="WacDocumentGenericBootError",n.mo="WacDocumentJsApiV1Error",n.po="WacDocumentJsApiV2Error"}(a||(a={})),function(n){n.PermissionError="PermissionError",n.NotFound="NotFound",n.Throttling="Throttling",n.Offline="Offline",n.Other="Other"}(s||(s={}));var l,c,d={};!function(n){n.New="NEW",n.BackstageMru="BACKSTAGE-MRU",n.Reboot="REBOOT"}(l||(l={})),function(n){n.SharePointOnline="sharepoint",n.OneDriveConsumer="onedrive",n.Graph="graph"}(c||(c={}))},2506:function(n,e,t){t.d(e,{f:function(){return v},r:function(){return f}});var o=t(6709),i=t(5796),r=t(280),u=t(3979),a=t(8396),s=t(4086),l=t(2544),c=t(7783),d=t(4285),f=function(){function n(){}return Object.defineProperty(n,"isCreateNewFlowExecuting",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapper&&n.bootstrapperLoadPromise&&n.bootstrapperUrl&&n.bootstrapperInfo&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"isCreateNewFlowExecutingForJsApiBundledWithOwl",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapperUrl&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"completeCreateNewPromise",{get:function(){return n.To},enumerable:!1,configurable:!0}),n.completeCreateNew=function(n){this.Uo.resolve&&this.Uo.resolve(n)},n.failCreateNew=function(n){this.Uo.reject&&this.Uo.reject(n)},n.isTwoStepCreateNew=!1,n.createNewFlowExecuting=!1,n.Uo={},n.To=new Promise((function(e,t){n.Uo.resolve=e,n.Uo.reject=t})),n}();function v(n,e){var t,v,h,p;if(f.isTwoStepCreateNew=!!(n.documentBootInfo.isNewFile&&n.documentBootInfo.isTwoStepCreateNew&&n.sessionConfig.createNewParams&&n.sessionConfig.createNewParams.appUrl&&(0,u.ZR)(n.documentBootInfo.fileType,null===(t=n.uiHostConfig)||void 0===t?void 0:t.featureGates,e)&&(null===(v=n.initPackageParams)||void 0===v?void 0:v.jsApiUrlInfos)&&(null===(h=n.initPackageParams)||void 0===h?void 0:h.jsApiUrlInfos.get(n.documentBootInfo.fileType))),f.isTwoStepCreateNew){var m=n.initPackageParams.jsApiUrlInfos.get(n.documentBootInfo.fileType);m?(f.bootstrapperUrl=m.jsApiUrl,f.hostSessionId=(0,a.Zl)(n.sessionConfig.hostCorrelationId),f.bootstrapperLoadPromise=(0,s.g)(m.jsApiUrl,n.sessionConfig.createNewParams.appUrl,n.documentBootInfo.fileType,!0,n.sessionConfig.wiseEnvironment,e).then((function(t){var u=(0,o.CR)((0,s.n)(n.documentBootInfo.fileType),2),a=u[0],v=u[1];if(v||!a||!f.hostSessionId)return null==e||e.ULS.sendTraceTag(507778318,i.W.oo,r.G.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(v)),!1;f.bootstrapper=a,f.bootstrapperInfo=t,f.application=a.createApplication((0,d.Z)(n.documentBootInfo,f.bootstrapperInfo.bootstrapperUrl,n.uiHostConfig,n.sessionConfig)),f.session=f.application.createSession({hostSessionId:f.hostSessionId}),f.createNewFlowExecuting=!0;var h=(0,l.VN)(n.sessionConfig.createNewParams,n.documentBootInfo,n.container,n.uiHostConfig,n.sessionConfig);return f.session.run(c.O.createNew,h).catch((function(n){null==e||e.ULS.sendTraceTag(507778317,i.W.oo,r.G.Warning,"Caught error running create new flow: ".concat(n)),f.createNewFlowExecuting=!1})),!0})).catch((function(t){return null==e||e.ULS.sendTraceTag(507778316,i.W.oo,r.G.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(t)),!1}))):null==e||e.ULS.sendTraceTag(507778319,i.W.oo,r.G.Warning,"jsapiBootstrapperUrl for ".concat(n.documentBootInfo.fileType," is undefined in ").concat(null===(p=n.uiHostConfig)||void 0===p?void 0:p.uiHostName))}}},7571:function(n,e,t){t.d(e,{SS:function(){return u},Yf:function(){return a},aj:function(){return s},eE:function(){return r},mN:function(){return l}});var o=t(6709),i=t(1507);function r(n){return!(!n||!n.failure)&&"TypeError: Failed to fetch"===n.failure}function u(n){switch(n){case i.AU.ho:case i.AU.bo:return!1;default:return!0}}function a(n,e){if(e)return!0;if(!n)return!1;switch(n){case 401:case 403:case 404:case 429:return!0;default:return!1}}function s(n){var e=n.httpErrorCode,t=n.networkError,r=n.qosErrorName,u=n.errorMessage,a=n.error,s=n.documentLoadedWithTabSwitch,l=r===i.DG.QosError_EncounteredJsApiError&&"timeout"===u&&s;return t||l||[401,403,404,429].includes(e)||function(n){var e,t,i,r;if(!n)return!1;try{for(var u=[JSON.parse(n)];u.length>0;){var a=u.pop();if("string"==typeof a){if(c.has(a))return!0}else if("object"==typeof a&&null!==a)try{for(var s=(e=void 0,(0,o.XA)(Object.values(a))),l=s.next();!l.done;l=s.next()){var f=l.value;u.push(f)}}catch(n){e={error:n}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}}catch(e){try{for(var v=(0,o.XA)(d),h=v.next();!h.done;h=v.next()){var p=h.value;if(-1!==n.indexOf(p))return!0}}catch(n){i={error:n}}finally{try{h&&!h.done&&(r=v.return)&&r.call(v)}finally{if(i)throw i.error}}}return!1}(JSON.stringify(a))}function l(n,e){if(e)return i.I$.Offline;switch(n){case 401:case 403:return i.I$.PermissionError;case 404:return i.I$.NotFound;case 429:return i.I$.Throttling;default:return i.I$.Other}}var c=new Set(["DocumentIsIRMProtected","5373959","5243086","5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]),d=Array.from(c)},3594:function(n,e,t){t.d(e,{Fh:function(){return o},dt:function(){return s},i0:function(){return c},vJ:function(){return l}});var o,i=t(5796),r=t(280),u=t(5904),a=t(1305);function s(n,e,t){null==t||t.ULS.sendTraceTag(521164238,i.W.oo,r.G.Info,"".concat(n,": ").concat(e?"Enabled":"Disabled"))}function l(n,e){if(!e)return!1;if(!e.has(n))return!1;var t=e.get(n);return null!=t&&"boolean"==typeof t&&t}function c(n,e,t){var o,s=[];null==e||e.ULS.sendTraceTag(522299220,i.W.oo,r.G.Verbose,'Attempting to parse Feature Gate Config String: "'.concat(n,'"'));try{s=null!==(o=u.ep.toFeatureGateConfig(n,e))&&void 0!==o?o:[]}catch(t){return null==e||e.ULS.sendTraceTag(524814532,i.W.oo,r.G.Error,'Unable to parse Feature Gate Config string: "'.concat(n,'", due to Exception: ').concat(t)),new Map}null==e||e.ULS.sendTraceTag(522299221,i.W.oo,r.G.Verbose,"Successfully parsed Feature Gate Config String to JSON: ".concat(JSON.stringify(s)));var l=new Map,c=t;return c=c?null==t?void 0:t.toLocaleLowerCase():"",s.forEach((function(n){var e,t=(null!==(e=n.SettingsRings)&&void 0!==e?e:"").replace(/\s+/g,"").toLocaleLowerCase().split(",");c&&t.includes(c)&&l.set(n.ConfigId,n.IsEnabled)})),null==e||e.ULS.sendTraceTag(522299222,i.W.oo,r.G.Info,"Successfully filtered Feature Gate Config JSON: ".concat(JSON.stringify(s),", to ring id: ").concat(c,", with result map: ").concat((0,a.z)(l))),l}!function(n){n.FeatureGate_EcsHootGate="EcsHootGate",n.FeatureGate_VisioJsApiV2Gate="VisioJsApiV2Gate",n.FeatureGate_OneNoteJsApiV2Gate="OneNoteJsApiV2Gate",n.FeatureGate_HideCloseButtonGate="HideCloseButtonGate",n.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",n.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",n.FeatureGate_BlurAndGrabFocusForShareDialogGate="BlurAndGrabFocusForShareDialogGate",n.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",n.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",n.FeatureGate_DisableEUDBBrowserULSRouting="DisableEUDBBrowserULSRouting",n.FeatureGate_DisableEUDBHealthTelemetryRouting="DisableEUDBHealthTelemetryRouting",n.FeatureGate_ESSForXLGate="ESSForXL",n.FeatureGate_iOSNullCheckFeatureGate="iOSNullCheckFeatureGate",n.FeatureGate_Locale1JSGate="Locale1JSGate",n.FeatureGate_BypassOPTIONSCall="BypassOPTIONSCall",n.FeatureGate_EnableOwlFrameBoot="IsOwlIFrameBootEnabled",n.FeatureGate_EnableOwlFrameBootTreatment="IsOwlIFrameBootTreatment",n.FeatureGate_Vroom21ForWord="Vroom21ForWord",n.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",n.FeatureGate_ManifestCachingGate="ManifestCachingGate",n.FeatureGate_ManualRedirectOnTenantChangeGate="ManualRedirectOnTenantChangeGate",n.FeatureGate_PrefetchWacToken="PrefetchWacToken",n.FeatureGate_UseNewEuplReporting="UseNewEuplReporting",n.FeatureGate_PostWacTokenAsync="PostWacTokenAsync",n.FeatureGate_DeprecateAxios="DeprecateAxios",n.FeatureGate_UseRedirectUrlOnTenantChange="UseRedirectUrlOnTenantChange"}(o||(o={}))},7075:function(n,e,t){t.d(e,{$$:function(){return u},T4:function(){return l},qj:function(){return s},yB:function(){return a}});var o=t(3594),i=t(1305),r=new RegExp("(^| )".concat("OwlFrameMode","=([^;]+)")),u="/suite/WebLoader.aspx",a="",s=function(){function n(){}return Object.defineProperty(n,"isOwlFrame",{get:function(){return"boolean"==typeof n.Fo?n.Fo:"https:"===location.protocol&&location.origin.indexOf("common.online.office.com")>-1&&location.pathname===u},enumerable:!1,configurable:!0}),n.isOwlFrameBootEnabled=function(e,t){return void 0!==n.Po?n.Po:e?(n.Po=!n.isOwlFrame&&(0,o.vJ)(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,e),(0,o.dt)(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,n.Po,t),n.Po):(n.Po=!1,n.Po)},n.checkOwlFrameCookie=function(n,e){if(e&&"FASTFOOD"===n){var t=document.cookie.match(r);if(t){var i=t[2];"0"===i||"1"===i?(e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.delete(o.Fh.FeatureGate_EnableOwlFrameBootTreatment)):"2"===i?(e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.set(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0)):"3"===i&&(e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.set(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0),e.set(o.Fh.FeatureGate_EcsHootGate,!0),a="https://login.microsoftonline.com/")}}},n}();function l(n,e,t,o,r,u){return"Boot Experiment Status: ".concat(s.isOwlFrameBootEnabled(t,u)?"TREATMENT":"CONTROL",", FileType: ").concat(n,", Environment: ").concat(e,", Feature Gates: ").concat(t?(0,i.d)(t):"{}",", UiHost: ").concat(o,", Integration Type: ").concat(r)}},4048:function(n,e,t){t.d(e,{X:function(){return o}}),t(5796),t(280);var o=function(){var n=void 0;try{n=window.localStorage}catch(n){}return n}()},8334:function(n,e,t){function o(n){return new Map([["ErrorName","".concat(n.wacErrorName)+(n.errorName?"_".concat(n.errorName):"")],["ErrorMessage",n.errorMessage?n.errorMessage:""],["HttpErrorCode","".concat(n.httpErrorCode)],["NetworkError","".concat(n.networkError)],["error",n.error?i(n.error):""],["DocumentLoadedWithTabSwitch","".concat(n.documentLoadedWithTabSwitch)]])}function i(n){if("string"==typeof n)try{return JSON.parse(n),n}catch(n){}return JSON.stringify(n,Object.getOwnPropertyNames(n))}t.d(e,{x:function(){return o}})},2531:function(n,e,t){t.d(e,{c:function(){return i}});var o=t(8959);function i(){var n=(0,o.a)();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)}))}},4285:function(n,e,t){t.d(e,{Z:function(){return i}});var o=t(3979);function i(n,e,t,i,r){var u,a,s,l,c,d,f,v,h,p,m,w;return{host:{storageHostName:(0,o.fG)(null!==(u=n.docUrl)&&void 0!==u?u:""),capabilities:{isFeatureEnabledCallback:(0,o.t1)(i),moveToFolder:null==t?void 0:t.supportsMoveToFolder,commonFilePicker:null==t?void 0:t.supportsCommonFilePicker,rebootDoc:null==t?void 0:t.supportsDocumentReboot,createNewDoc:null==t?void 0:t.supportsCreateNewDocument,authToken:null==t?void 0:t.supportsAuthToken,excelExternalLinks:null==t?void 0:t.supportsExcelExternalLinks,refreshAccessToken:null==t?void 0:t.supportsRefreshAccessToken,atMentions:null==t?void 0:t.supportsAtMentions,accessibilityLoop:null==t?void 0:t.supportsAccessibilityLoop,customAuthConfig:null==t?void 0:t.supportsCustomAuthConfig,directPrint:null===(a=null==t?void 0:t.supportsDirectPrint)||void 0===a||a,directDownload:null==t?void 0:t.supportsDirectDownload},uiHostName:(null==t?void 0:t.uiHostName)||o.N2,requireExplicitUnload:null==t?void 0:t.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==t?void 0:t.uiHostIntegrationType,uiHostScenarioType:null===(s=null==i?void 0:i.additionalApplicationParameters)||void 0===s?void 0:s.uiHostScenarioType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout,origin:null==i?void 0:i.origin},user:{id:r?r.wac.userId:n.puid,isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:e,ui:{uiEmbed:null===(l=null==t?void 0:t.uiEmbed)||void 0===l||l,controls:(null==t?void 0:t.supportsHostUiControls)?[{id:"close",visibility:(null==t?void 0:t.showCloseButton)?1:0},{id:"share",visibility:(null==t?void 0:t.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==t?void 0:t.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==t?void 0:t.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==t?void 0:t.copyLinkEnabled)?1:0},{id:"conversation",visibility:(null==t?void 0:t.conversationButtonEnabled)?1:0}]:void 0,language:n.uiCulture,hideHeader:null==t?void 0:t.hideHeader,hideAppLauncherInHeader:null==t?void 0:t.hideAppLauncherInHeader,hideSearchInHeader:null==t?void 0:t.hideSearchInHeader,hideMeInHeader:null==t?void 0:t.hideMeInHeader,hideChatInHeader:null==t?void 0:t.hideChatInHeader,hideWorkflowInHeader:null==t?void 0:t.hideWorkflowInHeader,hideSettingsInHeader:null==t?void 0:t.hideSettingsInHeader,showAppIconInHeader:null==t?void 0:t.showAppIconInHeader,useNeutralColorInHeader:null==t?void 0:t.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==t?void 0:t.openLinksInNewWindow,contentAssemblyMode:null==t?void 0:t.contentAssemblyMode,showNotebookList:"1"===(null===(c=null==i?void 0:i.additionalApplicationParameters)||void 0===c?void 0:c.shownotebooklist),enableMobileViewer:"1"===(null===(d=null==i?void 0:i.additionalApplicationParameters)||void 0===d?void 0:d.wdMobileEmbedOneNoteViewer),mobileEmbedView:"1"===(null===(f=null==i?void 0:i.additionalApplicationParameters)||void 0===f?void 0:f.wdMobileEmbedOneNoteViewer),showBreadcrumbInMobileView:"1"===(null===(v=null==i?void 0:i.additionalApplicationParameters)||void 0===v?void 0:v.wdMobileEmbedOneNoteViewer),showInternalFeedback:"1"===(null===(h=null==i?void 0:i.additionalApplicationParameters)||void 0===h?void 0:h.wdNotesInternalFeedbackEnabled),embed:"1"===(null===(p=null==i?void 0:i.additionalApplicationParameters)||void 0===p?void 0:p.embed),embedded:"1"===(null===(m=null==i?void 0:i.additionalApplicationParameters)||void 0===m?void 0:m.embedded),hidesections:"1"===(null===(w=null==i?void 0:i.additionalApplicationParameters)||void 0===w?void 0:w.hidesections)}}}},2294:function(n,e,t){t.d(e,{ME:function(){return c},OV:function(){return l},W8:function(){return s},r_:function(){return o},vY:function(){return a}});var o,i=t(6709),r=t(167),u=t(7075);function a(n){var e,t,i,r,a,s,l,c;void 0===n&&(n="");var d=u.qj.isOwlFrame?null===(i=null===(t=null===(e=null===window||void 0===window?void 0:window.performance)||void 0===e?void 0:e.getEntriesByName)||void 0===t?void 0:t.call(e,o.OwlFrameTimeOrigin)[0])||void 0===i?void 0:i.detail:null===(s=null===(a=null===(r=null===window||void 0===window?void 0:window.performance)||void 0===r?void 0:r.getEntriesByName)||void 0===a?void 0:a.call(r,o.OwlHostTimeOrigin)[0])||void 0===s?void 0:s.detail;return null===(c=null===(l=null===window||void 0===window?void 0:window.performance)||void 0===l?void 0:l.getEntriesByType)||void 0===c?void 0:c.call(l,"mark").filter((function(e){return e.name.startsWith(n)})).reduce((function(n,e){return e.name!==o.OwlFrameTimeOrigin&&e.name!==o.OwlHostTimeOrigin?n[e.name]=d+e.startTime:n[e.name]=d,n}),{})}function s(n,e){var t,r=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],u=(n[o.OwlBootAppMessageSend]||n[o.OwlBootAppWithCustomFunctionsMessageSend])-r,a=e[o.OwlBootAppMessageReceive]||e[o.OwlBootAppWithCustomFunctionsMessageReceive],s=e[o.OwlOnBootComplete];return{hostTime:u,frameTime:s-a,totalTime:s-r,owlPerformanceTimeline:(0,i.pi)((0,i.pi)((0,i.pi)({},n),e),((t={})[o.OwlStart]=r,t[o.OwlEnd]=s,t))}}function l(n){var e,t=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],r=n[o.OwlOnBootComplete];return{totalTime:r-t,owlPerformanceTimeline:(0,i.pi)((0,i.pi)({},n),((e={})[o.OwlStart]=t,e[o.OwlEnd]=r,e))}}function c(n){var e;try{e=JSON.stringify((0,r.pb)())}catch(n){e="[]"}var t=(0,i.pi)({},a("owl"));return n&&(n.owlVersion&&(t.version=n.owlVersion),n.wiseEnvironment&&(t.environment=n.wiseEnvironment),n.exposure&&(t.exposure=n.exposure)),{bootTelemetryData:e,owlTelemetryData:JSON.stringify(t)}}!function(n){n.OwlBootAppMessageSend="owlBootAppMessageSend",n.OwlBootAppMessageReceive="owlBootAppMessageReceive",n.OwlLoadedMessageSend="owlLoadedMessageSend",n.OwlLoadedMessageReceive="owlLoadedMessageReceive",n.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",n.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",n.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",n.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",n.OwlStart="owlStart",n.OwlEnd="owlEnd",n.OwlHostTimeOrigin="owlHostTimeOrigin",n.OwlFrameTimeOrigin="owlFrameTimeOrigin",n.OwlWacBootStart="owlWacBootStart",n.OwlOnBootComplete="owlOnBootComplete"}(o||(o={}))},1305:function(n,e,t){t.d(e,{d:function(){return r},z:function(){return i}});var o=t(6709);function i(n){var e,t,i="{ ";try{for(var r=(0,o.XA)(n.entries()),u=r.next();!u.done;u=r.next()){var a=u.value;i+="{ key: ".concat(a[0],", value: ").concat(a[1]," },")}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i.substring(0,i.length-1)+" }"}function r(n){var e,t,i={};try{for(var r=(0,o.XA)(n.entries()),u=r.next();!u.done;u=r.next()){var a=(0,o.CR)(u.value,2),s=a[0],l=a[1];i[String(s)]=l}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return JSON.stringify(i)}},4688:function(n,e,t){t.d(e,{J:function(){return s}});var o,i,r,u=t(2199),a=function(n){var e=document.getElementById("unified-ui-host-config"),t=e&&e.textContent;if(t)return JSON.parse(t)}(),s={version:"v1",officeHomeCdnDomain:null!==(o=null==a?void 0:a.officeHomeCdnDomain)&&void 0!==o?o:(0,u.w8)(),genericFeatureGates:null!==(i=null==a?void 0:a.genericFeatureGates)&&void 0!==i?i:null,deploymentEnvironment:null!==(r=null==a?void 0:a.deploymentEnvironment)&&void 0!==r?r:"Not_specified"}},681:function(n,e,t){t.d(e,{JK:function(){return s},Th:function(){return w},VJ:function(){return r},XU:function(){return a},Y$:function(){return p},aE:function(){return m},bM:function(){return d},gG:function(){return h},k$:function(){return v},o4:function(){return o},pK:function(){return u},sj:function(){return f}});var o,i=t(6709),r=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,a=/http[s]?:\/\/d\.docs\.live\.net/,s=/https:\/\/[\S]*?graph\.[\S]/,l="https://graph.microsoft.com",c=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function d(n){if(!n)return"";try{return decodeURIComponent(n)}catch(n){return""}}function f(n){return n?n.substring(0,n.lastIndexOf("/")):""}function v(n){if(n&&n.length){var e=n.match(c);if(e)return{href:n,protocol:e[1],host:e[2],hostname:e[3],port:e[4],path:e[5],search:e[6],hash:e[7]}}}function h(n){if(n&&n.length){if(n.match(u)||n.match(a))return"OneDrive";if(n.match(r))return"SharePoint";if(n.startsWith(l))return"Graph"}}function p(n,e,t){var o=n,r="",u=!0;for(var a in e&&(o=(0,i.pi)((0,i.pi)({},e),o)),o){var s,l=o[a];if(!t||"object"!=typeof l&&l||"object"==typeof l&&l&&l.uriValue||"number"==typeof l||"boolean"==typeof l)u?u=!1:r+="&",s="object"==typeof l&&l&&l.uriValue?l.uriValue:encodeURIComponent("".concat(l)),r+="".concat(a,"=").concat(s)}return r}function m(n){if(n&&n.length){if(n.match(u)||n.match(a))return o.OneDrive;if(n.match(r))return o.SharePoint}}function w(n,e){var t=n.toLowerCase(),o=function(n){var e=v(n);return e&&e.hostname||""}(e),i=function(n){var e=n.toLowerCase();return!e||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e}(o),r=f(e);return 0===t.indexOf("https://")||0===t.indexOf("http://")?t:"/"===t.charAt(0)?"".concat(i).concat(t):"".concat(r,"/").concat(t)}!function(n){n.OneDrive="Documents",n.SharePoint="Sites"}(o||(o={}))},1622:function(n,e,t){var o,i,r,u,a;t.d(e,{J7:function(){return o},L5:function(){return r},hx:function(){return i},iz:function(){return u}}),function(n){n.CacheOnly="cache-only",n.NetworkFirst="network-first",n.NetworkOnly="network-only"}(o||(o={})),function(n){n.Delete="DELETE",n.Get="GET",n.Head="HEAD",n.Options="OPTIONS",n.Post="POST",n.Put="PUT",n.Patch="PATCH"}(i||(i={})),function(n){n.CorrelationId="X-OfficeHome-CorrelationId",n.Mock="ohp-mock",n.TestTraffic="X-OfficeHome-TestTraffic"}(r||(r={})),function(n){n.TestTraffic="testtraffic"}(u||(u={})),function(n){n.Json="json",n.Text="text",n.ArrayBuffer="arraybuffer",n.Blob="blob"}(a||(a={}))},3140:function(n,e,t){t.d(e,{G3:function(){return f},YM:function(){return s},gG:function(){return u},n5:function(){return a},sm:function(){return h},wU:function(){return v},yA:function(){return p}});var o=t(5796),i=t(280),r=t(681);function u(n){if(n&&n.length){if(n.match(r.pK)||n.match(r.XU))return"OneDrive";if(n.match(r.VJ))return"SharePoint";if(n.match(r.JK))return"Graph"}}var a=function(n){return"action=".concat(n)},s=function(n){return(null==n?void 0:n.isESSEnabled)&&(null==n?void 0:n.wacDataCenter)?[l(null==n?void 0:n.wacDataCenter),c(null==n?void 0:n.sessionId),d(null==n?void 0:n.hostCorrelationId)]:[]},l=function(n){return n?"WacDataCenter=".concat(n):void 0},c=function(n){return n?"usid=".concat(n):void 0},d=function(n){return n?"hid=".concat(n):void 0},f=function(n){return n&&n.length?"$select="+n.join(","):void 0};function v(n){return h(n,{accept:"application/json",prefer:"allow-zerobyte"})}function h(n,e,t,r){var u=e;if(!n||!n.success)return null!=u?u:{};u||(u={}),null==r||r.ULS.sendTraceTag(507588634,o.W.oo,i.G.Important,"Format: ".concat(n.format));var a="RPSCompact"===n.format?t||"":"Bearer ";return u.Authorization="".concat(a).concat(n.token).trim(),u}function p(n,e,t){var r,a=e.isConsumer,s=e.oneDriveResourceId,l=new URL(n);if(l&&l.protocol&&l.host){var c=a?s:"".concat(l.protocol,"//").concat(l.host),d=a?function(n){return n.inMockMode?n.officeHomeApiRoot:n.oneDriveConsumerApi}(e):function(n,e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1);var i=e.inMockMode?e.officeHomeApiRoot:n;return"".concat(i,t?"/_api":o?"/_api/v2.1":"/_api/v2.0")}(c||"",e),f=a?"OneDrive":null!==(r=u(c||""))&&void 0!==r?r:"None";if(c&&d&&f)return{baseUrl:d,tokenType:f,resourceUrl:c,hostname:l.hostname};null==t||t.ULS.sendTraceTag(542492316,o.W.oo,i.G.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!c,"][InvalidBaseUrl: ").concat(!d,"][InvalidTokenType: ").concat(!f,"]"))}else null==t||t.ULS.sendTraceTag(542492315,o.W.oo,i.G.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!l,"][InvalidProtocol: ").concat(!(null==l?void 0:l.protocol),"][Invalidhost: ").concat(!(null==l?void 0:l.host),"]"))}},759:function(n,e,t){var o;t.d(e,{T:function(){return o}}),function(n){n.Excel="Excel",n.None="None",n.OneNote="OneNote",n.PowerPoint="PowerPoint",n.Visio="Visio",n.Word="Word"}(o||(o={}))},8959:function(n,e,t){function o(n){window.performance&&window.performance.mark&&(Array.isArray(n)?n.forEach((function(n){window.performance.mark(n)})):window.performance.mark(n))}function i(){var n,e,t;return(null===(e=null===(n=window.performance)||void 0===n?void 0:n.now)||void 0===e?void 0:e.call(n))+(null===(t=window.performance)||void 0===t?void 0:t.timeOrigin)||Date.now()}function r(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(n){}return Date.now()}t.d(e,{a:function(){return i},eR:function(){return r},l5:function(){return o}})}},r={};function u(n){var e=r[n];if(void 0!==e)return e.exports;var t=r[n]={id:n,exports:{}};return i[n](t,t.exports,u),t.exports}u.m=i,u.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(e,{a:e}),e},e=Object.getPrototypeOf?function(n){return Object.getPrototypeOf(n)}:function(n){return n.__proto__},u.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var i=Object.create(null);u.r(i);var r={};n=n||[null,e({}),e([]),e(e)];for(var a=2&o&&t;"object"==typeof a&&!~n.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((function(n){r[n]=function(){return t[n]}}));return r.default=function(){return t},u.d(i,r),i},u.d=function(n,e){for(var t in e)u.o(e,t)&&!u.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},u.f={},u.e=function(n){return Promise.all(Object.keys(u.f).reduce((function(e,t){return u.f[t](n,e),e}),[]))},u.u=function(n){return"owl."+({36:"hi-in-owl-strings-json",98:"sd-arab-pk-owl-strings-json",399:"lb-lu-owl-strings-json",666:"sr-cyrl-ba-owl-strings-json",712:"ga-ie-owl-strings-json",856:"gd-gb-owl-strings-json",921:"zh-tw-owl-strings-json",1e3:"el-gr-owl-strings-json",1029:"sl-si-owl-strings-json",1102:"ms-my-owl-strings-json",1105:"ca-es-owl-strings-json",1133:"be-by-owl-strings-json",1350:"bn-in-owl-strings-json",1406:"ca-es-valencia-owl-strings-json",1489:"et-ee-owl-strings-json",1532:"uk-ua-owl-strings-json",1608:"nl-nl-owl-strings-json",1635:"es-mx-owl-strings-json",1771:"ne-np-owl-strings-json",1791:"ar-sa-owl-strings-json",1825:"kk-kz-owl-strings-json",1993:"kok-in-owl-strings-json",2046:"ta-in-owl-strings-json",2129:"quz-pe-owl-strings-json",2281:"ur-pk-owl-strings-json",2289:"ha-latn-ng-owl-strings-json",2394:"te-in-owl-strings-json",2468:"msal",2772:"ro-ro-owl-strings-json",2792:"pt-br-owl-strings-json",2811:"km-kh-owl-strings-json",2855:"pa-in-owl-strings-json",2902:"lt-lt-owl-strings-json",3041:"fr-fr-owl-strings-json",3075:"en-gb-owl-strings-json",3102:"cy-gb-owl-strings-json",3247:"da-dk-owl-strings-json",3268:"id-id-owl-strings-json",3395:"tt-ru-owl-strings-json",3622:"lo-la-owl-strings-json",3648:"handlers",3787:"qps-ploc-owl-strings-json",3872:"ky-kg-owl-strings-json",4051:"fi-fi-owl-strings-json",4144:"ja-jp-owl-strings-json",4335:"it-it-owl-strings-json",4525:"kn-in-owl-strings-json",4628:"mk-mk-owl-strings-json",4654:"fr-ca-owl-strings-json",4809:"tk-tm-owl-strings-json",5167:"af-za-owl-strings-json",5383:"as-in-owl-strings-json",5467:"nn-no-owl-strings-json",5760:"fa-ir-owl-strings-json",5848:"mi-nz-owl-strings-json",5874:"am-et-owl-strings-json",6099:"si-lk-owl-strings-json",6233:"vi-vn-owl-strings-json",6251:"sq-al-owl-strings-json",6338:"bn-bd-owl-strings-json",6664:"cs-cz-owl-strings-json",6727:"hr-hr-owl-strings-json",6774:"nb-no-owl-strings-json",6795:"hy-am-owl-strings-json",6798:"bs-latn-ba-owl-strings-json",6832:"tr-tr-owl-strings-json",6974:"pl-pl-owl-strings-json",7e3:"sw-ke-owl-strings-json",7027:"chr-cher-us-owl-strings-json",7332:"or-in-owl-strings-json",7335:"mt-mt-owl-strings-json",7447:"zh-cn-owl-strings-json",7610:"ml-in-owl-strings-json",7681:"ka-ge-owl-strings-json",7805:"az-latn-az-owl-strings-json",7986:"sv-se-owl-strings-json",8102:"es-es-owl-strings-json",8217:"gl-es-owl-strings-json",8225:"bg-bg-owl-strings-json",8253:"hu-hu-owl-strings-json",8294:"prs-af-owl-strings-json",8342:"ko-kr-owl-strings-json",8361:"fil-ph-owl-strings-json",8438:"en-us-owl-strings-json",8507:"ru-ru-owl-strings-json",8530:"sr-latn-rs-owl-strings-json",8660:"gu-in-owl-strings-json",8692:"ug-cn-owl-strings-json",8793:"pt-pt-owl-strings-json",8904:"eu-es-owl-strings-json",9054:"lv-lv-owl-strings-json",9173:"th-th-owl-strings-json",9264:"mr-in-owl-strings-json",9275:"de-de-owl-strings-json",9355:"qps-plocm-owl-strings-json",9545:"he-il-owl-strings-json",9660:"mn-mn-owl-strings-json",9729:"sr-cyrl-rs-owl-strings-json",9743:"sk-sk-owl-strings-json",9754:"is-is-owl-strings-json",9779:"uz-latn-uz-owl-strings-json",9894:"qps-ploca-owl-strings-json"}[n]||n)+"."+{36:"08015b9d7f44c1be93fc",98:"d0b93bea6a8eb17fbd8b",399:"d212938cacf4f576c30f",666:"cb4dbd481a4cbb987514",712:"44bb4588b563a46c1eda",856:"1503371adb35fd81b50c",921:"67a09fd49c5b99d67dfd",1e3:"6e83c2551d69d4d08c0b",1029:"86433ec45bdaf889e19e",1102:"be1c5c1a4adefb27f10d",1105:"8b39233745df58383158",1133:"428efd42b709ef29c676",1350:"e2fc5c021337dbfdb099",1406:"5d4756f103c9549263ed",1489:"c3c364f9de413bf12c6f",1532:"47449b80079f0b4404eb",1608:"4134a840fd435fd34e02",1635:"d262eaed8ac980ce7434",1771:"793fa1b22ec0ad76d915",1791:"c02f202fc344d20f31c5",1825:"6169dfcc9f17040ab4f2",1993:"bee7e57e4e45096691b9",2046:"1543fb82b2c5fc1e8011",2129:"e9d8fea6379518c2f0a4",2281:"923f4280168eb2602550",2289:"4242de05354517bcf62a",2394:"bc6e2550ae04e7977b79",2468:"ae48ea99d5b069cc5983",2772:"f3a0162eced55cf4f89b",2792:"dfde60888bb68e420067",2811:"0f2ba27f011079e78e7f",2855:"ddf5d92f2402823c1037",2902:"24f3cb678548f376eaba",3041:"33d6454d96402c1f9813",3075:"9c61073d8fb53737ea7f",3102:"2b6c402d6bf619fa61cb",3247:"2cb48e460c2344218cc9",3268:"37ae6f1e73d51ba44230",3395:"b431dfd377a7835813dd",3622:"fdbe5579bb07d819ac15",3648:"43d1a99c866561d784a8",3787:"582722f8917ba2b78ef9",3872:"71a658b43a2593fd0ecf",4051:"430b237acfd06f0747e9",4144:"0c26c67b68418b37db31",4335:"d49e799346a931037751",4525:"ebd08896ddcc5bad6411",4628:"7737188a1bb62a0275b0",4654:"6362e6e34af21d5bd113",4809:"bd187472756827a87c16",5167:"e6a7c5d8c8088009060b",5383:"2308c97046b2063f82e0",5415:"2f2f388628080cef252e",5467:"a3a1f888855abfc0c2a0",5760:"0cb2c123d32008c09131",5848:"9545fad683f1074f8604",5874:"e8b3f13180fb1b31d1be",5911:"6766b1410ab6c0b60c3b",6099:"80acc693991e953851b2",6233:"b69a4cac13ee0576ecf1",6251:"1a4ff5e48af69f848b98",6338:"3c29c3612a3175383492",6664:"67dd01e5ac16f9d18cd2",6727:"65dbebd7b04b318a1f1d",6774:"b0011ca7e6cecab630e2",6795:"6b57fb8c6dd6a77fbc08",6798:"ff9fd6787aa68a0e89ed",6832:"bcc9f8ef2080be8d16c8",6974:"40dae672e0c157fd3d6d",7e3:"bfa049a6f97e0e3ae034",7027:"0d119198d7ea531d0d58",7332:"fc41f3cdfb2a6a28217e",7335:"3bbb362f9a55a60601e6",7447:"b96634c440cddb51190e",7610:"2994eea54657f0493099",7681:"645ccfc5c76f930a67f3",7805:"18462b30bfac58b71c95",7986:"d5fae7f0076ed073adb5",8102:"73129d2f67f14c335f85",8217:"4e75c299f19ab8c32a44",8225:"0abff3acc5812b257c95",8253:"6137dbd913df212f0976",8294:"0ab112e12780893b836d",8342:"332cde542bac01e533af",8361:"e3c33d8e93482ac985cd",8438:"461814452c05e3c97926",8507:"440d5eb78bafca0b6481",8530:"735336668185330e7bf5",8660:"1e98dead4a2f92d040a7",8692:"71650365ba8b969d2c6a",8793:"733447c36e36b1eca85d",8904:"f792f9cfcb0d9a267db0",9054:"b9a2be87b92f217c6cc6",9173:"25fa950b93edbe0d7f4e",9264:"904dc006039c6313e064",9275:"d40783546a3e580c6e44",9355:"9e1089daf90ce15ea94e",9545:"4b454b29d3e0e5ae1a42",9660:"102fe2e09c7ce1512dfa",9729:"5d8e21b3bb672ed0cb57",9743:"a49bd6ec8428a6d440fa",9754:"a3e0fb99f67e0dbf3867",9779:"438f85ccddd0158e4777",9894:"f05387399bca7bb09148"}[n]+".js"},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),u.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t={},o="Microsoft.Office.OWL:",u.l=function(n,e,i,r){if(t[n])t[n].push(e);else{var a,s;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==o+i){a=d;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,u.nc&&a.setAttribute("nonce",u.nc),a.setAttribute("data-webpack",o+i),a.src=n,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),a.integrity=u.sriHashes[r],a.crossOrigin="anonymous"),t[n]=[e];var f=function(e,o){a.onerror=a.onload=null,clearTimeout(v);var i=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((function(n){return n(o)})),e)return e(o)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),s&&document.head.appendChild(a)}},u.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},u.j=9520,function(){var n;u.g.importScripts&&(n=u.g.location+"");var e=u.g.document;if(!n&&e&&(e.currentScript&&(n=e.currentScript.src),!n)){var t=e.getElementsByTagName("script");if(t.length)for(var o=t.length-1;o>-1&&!n;)n=t[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=n}(),u.sriHashes={36:"sha384-AkpUJvJCOd2vByq1HU40gFA0BTEc06bh28PhZH9rDQ2UILdLNbDafnUnoHLPRfZq",98:"sha384-qYGotODNWImNHfo9DDU7Tz9OKfJajxPD/bwDD1I1snWUkYRnb8o1XfxQ2B77wHE3",399:"sha384-DiKOhlWh67ZoiG25qEzF+T1GurQwAJxvuw5vZ0vG6Wy5XTO7K1RNFJocc3HXAblt",666:"sha384-SmqMUavtZfgeh/bxZDZHaKq1Y5gkO26spXR+oUTRPPkowwHmhR0WrSWQrP0zLnCp",712:"sha384-N9InZN4WuJbU+ekpiPr7jWwse7IPf2uB7U+vYPDg2AK6/SdlDBAfidqDKH1if/e/",856:"sha384-PtMvQVdsR3mp26Gu/+N+Xfa69knjeGGeMau4S/JRZVbNOZ2pQf6XLrYI54TpV/zm",921:"sha384-6K1hINAK34TjCD3om3QtEZoOLTLalwKf+FacHI4N3YlVpJS8pla7o+fkrKitLjy+",1e3:"sha384-XOOWDEaJiPXZS6GHG9+AQWas7vPas2bx2IUWCy3+XpC5u9HkTkjTtDaGqgGMzbwD",1029:"sha384-IEWalH+pfv99rBO3EotMMYG/2eGsn99ZvBjOQKQ5Zi6cslsov+M7+P2Pdkcvb8B5",1102:"sha384-bxUri3l0J3FWcUZtG5p7xS2LfpJ0mzidHrLz0hhkjPyDSGSa4vBq4whCkofj+8nZ",1105:"sha384-vn3wXMlwh62KyUGLQ4G2FYKUevCTlkaxbcJfJmyfmQ6jTn6OvWYZIBMda2g7wXZW",1133:"sha384-cuMKZKzg4aJ4/TEI3uE4N6hqcXNz32lUfCS6PXdMuqEr/9rpSmWNXl8WZVt89zb2",1350:"sha384-siBOb8w8EhzMsXw139h5HBgI1/nnrjDKEMUWOJMJeE1qd7M699aMG1g7e6Zqrt5E",1406:"sha384-1J2BPWtioZFd4DlB6I18rJ6w7d/ujfnGB7leUohABec60lAfaI/4AXDUQQ0JtPkj",1489:"sha384-XqT+dd3TYb3EMC6TTdjZxWcjw561M0DqzBnmY0oi39AP0qNwVx0qHa+H1w7pM0+9",1532:"sha384-y/01sCtAMLMvlePN1brHCobKnOIxQndIGC23W+CVudcNRLMRkPRbIiNunF4djhci",1608:"sha384-I8RbPhWQbU/7jxAmDHjEJGps8DxfIzGt2PsJ389zCggOiQbGqblFYfMj8hvfEvXc",1635:"sha384-4yDVKeKcoWXiCdYs5UJviNjpOeYtAOj9GhlxIdSo90HEUaDq7oWlphRDd07VdJvX",1771:"sha384-Gg9CM3A4Hl+00IrBN4ZqQOeZkqIJtokrMnooaeVnPfDn9/qHJJMbne6gykFFNcPM",1791:"sha384-9H1GI0OHpso5MoaxcaO+/MmRlgGAkyAP1JEf/4mRAq63Ut4Mzo4pbvILt+vTJqwY",1825:"sha384-faAlBNbif7V0FVsQmoKUxOdjCLbxOK6lafuEBD2sEdKISuPLLJGFjv2PHxRKO/Bv",1993:"sha384-BXEnIp3URoWcIA2GVBss9h/FzOYaKxRH+0CpUERoPetmPNyputEe8w3AgNcjGc3J",2046:"sha384-zi7whRpqgEPKBzC5A9gp46qPTot1Ynms6ecmTXBh0QvFvVv+RpaGp8/PQ+ssXc0r",2129:"sha384-MkIjYR7v2d6s1Lzs5yknQS1X0Jixq2MCBvEr+O+ALnjyucDZk+Ek8cEZpPodtAF6",2281:"sha384-nw0KNs+kgcuLG/c89iTaOVt+2mKV1k+OooELGGQdKH766LgZBwtfWWIet8kH/e4I",2289:"sha384-oms2kO1HePM+PTLM7iHvMpO1EJLmEqGl6M9yjfaVmFiqjRMHmQv9SrtFTOSgQTvM",2394:"sha384-E5YtPTv2qhQO8HAjBjmWAcMEgojSppyR0JsYACFK4YO8Tya1OHmfQeSRAJraEmWJ",2468:"sha384-Z0BgKDfks5N9uainE/yXBg3DkJ9y5wrBdFR2uvu638g2XRpivLZGyFGBMFJxTywU",2772:"sha384-ZAcvPolsywRK5RZ1VIZ4KqHETc2HzPqxLA/tYzD7PUoHMDm+iBAnqN2C5A12b3v/",2792:"sha384-DKDKCJKrdS5dxDkQ0r5JEot0p4k+Jn21xZHo03gpP4MEbhweIhtjSytFG89Rr4fX",2811:"sha384-r8qFT6VKXeF7c3fuVrwZhIV1qmPJxeF9q2h5hgwL/G7v1+vhjYvra9hbPfQ7+l1Y",2855:"sha384-ev1Zf8pmosOO3NklYv+lq2eBOc3k3P0PjgtmrJgXD3XB49ivqZlYIbLYciXWWI7B",2902:"sha384-2SVZhhb/Hjwp+wK0u3KdovNviTcIdAZipIaNA4IdoGE5TA0nuMpkdaYrTjF9BDRt",3041:"sha384-Umqw59aC8s81wZUmjhuRZeE1pTgS2eR4u1PGFN3IvkdcXFo0mJ2xkRPn910y00iJ",3075:"sha384-ZoPOG6QDh3vwGWurHX/4QvBYAtNm2O3vYf58W+cT25H0/mPkSC5+7xLTAFxYNUza",3102:"sha384-bhIxGbPfYPS7H/lzrQ3f8ncM/Yc0Y70y4Vb4PmmdH9mrWCGsPBpejmgmlfYUlGVK",3247:"sha384-NsXLvIZ7w6xtpXCriCnA4km8HHQ4RmHdkT+WBnypDy7GIEFxyfa/NxLs0jj+9urM",3268:"sha384-M2i9oTbHxUAtIiWpwRdTe3izVyAR8nX6j/7uZqDlRiCuFmkQC4L4DwWx54z1n5EU",3395:"sha384-dxfOTpkPlB9e1CAMbnzIqdByhGUeG+vqQ9K4Xvg0neyzr1iJZvtKXx6gZuhAXrRb",3622:"sha384-dn2N1P+4rEbfrRNeiAqOB3SJKOH/nWh39z/6CAgSi78pMhJDS+hHpV4y88njNqez",3648:"sha384-tf/WcwsnsHTV2LYOBzCiWH46tj0zhseW781Vtm8WkrmkYArQUmtQsP9kToYuqeVB",3787:"sha384-86C9OcOE3ivI633lPY2jhvRmv7RaMWHCRRUtH4VTRvQ21mx5sa4/BEM3n+P1f4Qi",3872:"sha384-l9rsphJxfyFGPJNFbG/vXRE64MIXpwF7FWKNM3UZVEb/jipob+PPuoojShW1s4Q0",4051:"sha384-T7WWzdKMteSaIYLDxJt2VpAxLbgY1dP65Gc5KQuFdWKqVY0U1UPafy9T1DddhAsC",4144:"sha384-MTEV5C/OrcjKB104BMyDPCwS5QwmPaRNCKhosQRTUx1U8RmTufXLWxOSE0jxFwza",4335:"sha384-w5JfAWzJwfzkqZrP8vyuhF53YuQylvpVvPWnN6Nc9HzwFPQ3A+7mpCSRDyQm7ni8",4525:"sha384-4KAVvUDjNf2E2oD1rgXSEEYMzJ7bFud9drRXyNT7zJMNXtH0p3/mbQGh+R6G3hus",4628:"sha384-UmfyeuXGVv8yQ/XNnuQwO88gHbh7ax6XZ8JPrNoF6F7xhwkSDD1gm+SEePN97NZk",4654:"sha384-RQ2Alp663KSWN8eyWiFBHvsO6PGKOvJKWlelLwYriYpViSG7ZZattmRNcSJaGAjg",4809:"sha384-mEIEdX4/W84kO66eCieg/SBL+AGE31BkIwxy0AE3lZV8wbPpohR8z24iaz0D6x2b",5167:"sha384-7/4xK8Ipib+nnezLLBed2XVanMESFIt5akGEdty+8KyG2DNGKjDkCC+tj3AIIAns",5383:"sha384-6PhEEaAG5Jfrx3KC/nizXLQFlbE+e3uas6rZnrvlRvTM7XTBYVRWNIe5UdYof1eP",5415:"sha384-FKdS6eRM4Xs9X488Qc8sYngN+GR2KKSKuuEX80yeBHLniYyC4YhGSs0H5eich9i/",5467:"sha384-0HsKhiwCWTG1f1uRs7yT24XIQMZnPyxju4Oisqxl2sCh65HDh8rOAd31H3u7elLc",5760:"sha384-xBtP6jk0qR3LPxz2lIwa/zmm9iWqyjAiHwONDTJY/y3nDseSVtj1ucI0WxDWkQa1",5848:"sha384-OKHGyx1twxV1A7isNehnXID5TjLMUwSwQ7xDQjQ1uruVFkffBUVCylrrENZhQOpt",5874:"sha384-SVOz9rljFWq66ZqnBTOJzJeO181+dGMt98KwS+kxlswwnXVHrSKZyFQX37/kqK8x",5911:"sha384-wSjxu68pbb+JvJfHKTQbxqToEqFNw6LqGaMek7ySFI4ULEGfJTX+My+fsitnKJ1B",6099:"sha384-JLdXOmALO6VWnrVTqNYtq8G0yD8k0wo8f7aOKkv1uWB+/oWg1WcVCYvkG8uqCAtN",6233:"sha384-cmPoRK9m2BBlb1rp/3chkvuXjJtyRdjHqilK0ZYfGbBFdG2f+ORcRxCrGV64zdup",6251:"sha384-aYF9uX0KzSl7cgZ5F8voZYYIONiDFJnTLMPlgO+WvvQNDFl+GppdlJuNJjyQ652p",6338:"sha384-VyobKxh6ii2+5h2as1+Zw6xLFCO+Na5r6FIk46xgq+ZgainFxiZG6mBtu4a5V0x0",6664:"sha384-c+U3e+FSn5Vfx2EQSLH8Ddovq857rJwW/4fJdPdupQIRQdPDEoTUED/fgCss1bXi",6727:"sha384-5bVHw+dM3esMCfS6U6idBSucAeVqoBgGVQx2eGJ2HNd1jPFK4wLAC6RjginCMqdq",6774:"sha384-B4NCNrfOrwZXOHMifS8YaREheH6e7OD9VhDl/UrUaR67LWk7sRbL+n+rAvFqTbnS",6795:"sha384-39ZCsRJwiZbAQ9VdCVcXXiRlfgN0mQcFJ8oqcW6dMox1R20LTM9z+iTgeSrAnxGv",6798:"sha384-o88JAnCoMMqJDoITSwt5rZspnWXc8piCev0VDWvCo5Be6IyHY7cqqN0QQyOHB8Hs",6832:"sha384-/dVahuZ5II582hH/ii6RvsV/MxQ/0mJk/Oi5eUMC+aSPhjcQO/mZGnnM78bznScs",6974:"sha384-yL3XfpS9rykRwsJypeXGKG0K8YH8WEWpffSUYs2COF9b9RDnoj8t1zCwXXsvInTe",7e3:"sha384-b+JHbzGrb2P/AQhP667o8rCExPcXJ50oJyiWLKC4HTYYnLyT4odRLMUWEAira5Bw",7027:"sha384-RvqGitxinuXyguMpnskdqNbL1u8SmeqXzHY3uyVWSLt3DQKDIPsh3Nvj8kCqMYcH",7332:"sha384-sgYYCKtcMSKaWCfpw2Preu+kxOhIuR0BRMTib71D1zLoyPYncTDp+fbVbxjgbrHO",7335:"sha384-9r1AgOXdHEkW8cMSJMcL8C9n74mO0dipLI3rRBHW9jaZFxlPS92Ede3Xgz8uuM5a",7447:"sha384-TegfJc/cTV1fM3lhiIX501cO1XcFmT8b9u2MjxREcfPZeTrqdEn9Xfptfr8IOqdu",7610:"sha384-ow9Qp+hQng3sD6awqFsJTlwtfOHo4/vz/9qiyE+lp6QyhVxoOGwjjYp8bCMbth52",7681:"sha384-H2mDdteN0+uS9RlNx8ckfV/RfxR1/y6bR72DHxEq5lje46tAnFlz8im1/tW/6poF",7805:"sha384-JX9xoy39V5HXC2jp1mc6wv2aUnni5uCmSUX1YW5K0+jCohW6nBZ2z22as6HzNeZ5",7986:"sha384-O6xBy9Gp/Dt0BydUR1W9F8+JIlqaIleIzwpeOLJrwBWeig/iobo9NZXigFQHIGSV",8102:"sha384-ggsg/idEvhegx0lXDzYwvvAJMlTUqKNr4tFBV+1ukTpdjQKjyRM/t/JiKyjx6Imw",8217:"sha384-mprAq7iizmv4bC74jqkR+42wNAja83SyZixuCXjHTDz+0jjuDLkmsHZmUdd23puV",8225:"sha384-ya7K7g7pIbCgcjSxLA+FOzc22mWfDbXafJRmzNKeBjAsile/ocBG0L0FWrQJfI3g",8253:"sha384-fogANTUdq79m5FtzmWGE3QylRZpZ+B2HzvTdy/wDLuSWX6K4EAtFq328blmZveeq",8294:"sha384-Ynup7uXCGgFWy36hFBbD60ArtuTqyZ/qaS9+NzgrEe3mnUrTtWSuoKmmwO5RtR7I",8342:"sha384-5cSRatX2EiNqlNiTgApcAewlCjAV0NIqTbacdhT6r5FjUFbmenXHmSxUzVWq0Coe",8361:"sha384-+AcBxJzSrpxcqqLpU7st5n/gqGViA2/X98wH9JmQYP9G/wW0ucP3i/6pXZtlCTfz",8438:"sha384-Z4qT4hMNKkObzLXqtNf8W/e2NBLxku8ynDqGLEI1ocW/TjudP0YKBShCp/cxpesj",8507:"sha384-3bxyyutB7DmVfznIA/2erllnPVf4J8Q0KTXKJXl48j8+glmB/s65R2x/wj9ouMhC",8530:"sha384-3gwsr/vYJMlMc9B5C6CbnYs423WprRmVbVqzEVg+z5FbukeBxKzccptEYg9H8D2e",8660:"sha384-aY2pBw1DhqCi+nW9aSTLMFWZOCI59/raxs1u0CHUA2+Y7/CQb4FiF2ywNXmTFOFW",8692:"sha384-50tyC1o9j5mheCVK39YoRrohcHEHx2ckPxZ5YMwhVC2cz+6Dvg4K3Rk087jdPNQc",8793:"sha384-pgCDeWpiUdXQW5L9srxjv7pz0SXdpMLm7asyX1aO0MI2CZLC00xQKRhSbbOVJyiY",8904:"sha384-XAeGQ3n113BiJLqVSCHsU8s00cdFCm2pEJls9BOV4Sl5CcMYtQ3yfuAns+85S+oE",9054:"sha384-HEUb+Y4EZab8JY88WcgE+uf6Z50Ik5ttJJ89jiFGV28E1vL55xpwAEX8KHqU4KjK",9173:"sha384-QKp39RjM51kEJiQrPczbBzTHbiRvi8w1Q2vcgC4m5zFqEqKGDRQncg2M7k6mzjFq",9264:"sha384-HZh8doWPeDvoahT7ESilejLEqPQ9GeiupkLA0hdmFghlNN3YmSKPXiGBxCNKDB+1",9275:"sha384-0WqIYX7kofzdZz65mtgk/jBhwiHJx/8XVQXpZyD7F2jrHhmziy5l/LrS8+7L/V/V",9355:"sha384-HOa3k+prwS9oODIforoUinZgRZNGCX1OgF09WHGQ0Nd36Je3LR+0FRzM6rIx+oY6",9545:"sha384-V4GNWh9Meu94G7OGu7GNu5SdetB2t+hntzHLezzl7jns4qZ3iZXKspCBp2hRZqn3",9660:"sha384-DuU4GTc4fDwcYWCG64FtYh31sIeYb4Toy29PSF+QY66UdlSDEuIJvD0FelucPFzJ",9729:"sha384-vU+837Ecq9pCTqTQmik9CXTT9w6FWnR1e4HUbDn6OlhTNtO7koKyLhXcl9YWijb7",9743:"sha384-ppf9z/DUa7o3Cze1DpM7vxcbiqfNEh29ZFnHgHchMTW5dcsOCwfWPVloNIsR7XhU",9754:"sha384-8SsnWHyFPk9cgJE7vyScRM9dnL7/UGOLheTOnzrXmSiPUwsSm8DsBMEErVfGrrcv",9779:"sha384-tdAzkkRHlHHIJ+cg3WKELQVWQU9/KXCcVVZNfqsSOGWvy+7BTYAmauVdyL8rOQmc",9894:"sha384-/vP3HEdgcHjD7saE2UYcZlT/WgcwxHR7gOh68OG3TAvGQ+ts6VQu3HEWsFSGun6r"},function(){if(void 0!==u){var n=u.u,e=u.e,t={},o={};u.u=function(e){return n(e)+(t.hasOwnProperty(e)?"?"+t[e]:"")},u.e=function(i){return e(i).catch((function(e){var r=o.hasOwnProperty(i)?o[i]:5;if(r<1){var a=n(i);throw e.message="Loading chunk "+i+" failed after 5 retries.\n("+a+")",e.request=a,e}return new Promise((function(n){var e=5-r+1;setTimeout((function(){var a="cache-bust=true&retry-attempt="+e;t[i]=a,o[i]=r-1,n(u.e(i))}),0)}))}))}}}(),function(){var n={9520:0};u.f.j=function(e,t){var o=u.o(n,e)?n[e]:void 0;if(0!==o)if(o)t.push(o[2]);else{var i=new Promise((function(t,i){o=n[e]=[t,i]}));t.push(o[2]=i);var r=u.p+u.u(e),a=new Error;u.l(r,(function(t){if(u.o(n,e)&&(0!==(o=n[e])&&(n[e]=void 0),o)){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,o[1](a)}}),"chunk-"+e,e)}};var e=function(e,t){var o,i,r=t[0],a=t[1],s=t[2],l=0;if(r.some((function(e){return 0!==n[e]}))){for(o in a)u.o(a,o)&&(u.m[o]=a[o]);s&&s(u)}for(e&&e(t);l<r.length;l++)i=r[l],u.o(n,i)&&n[i]&&n[i][0](),n[i]=0},t=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))}(),u.nc=void 0;var a={};!function(){u.r(a),u.d(a,{DocRebootSupportMode:function(){return Vt},ExpectedFailureReason:function(){return kn.I$},FeatureGateConstants:function(){return Rn.Fh},FileType:function(){return m.T},Health:function(){return qt.S9},HealthLogger:function(){return b.zP},KpiType:function(){return p.o},LogCategory:function(){return f.W},QosErrorName:function(){return kn.DG},TraceLevel:function(){return v.G},UlsLogger:function(){return b.G2},WacErrorName:function(){return kn.AU},bootDiagnostics:function(){return kn.c},bootDocument:function(){return Tt},bootDocumentWithCustomFunctions:function(){return Ut},completeCreateNew:function(){return yt},createNewGuid:function(){return h.n},forceEndSession:function(){return bt},getClientUrlForOpenInMobileApp:function(){return Ht},getDefaultResourceString:function(){return wt},getDocumentInfoFromWindow:function(){return zt},getExpectedFailureReason:function(){return ve.mN},getFeatureGateConfigByName:function(){return Rn.vJ},getFeatureGatesFromString:function(){return Rn.i0},getFetchAccessToken:function(){return Ft},getFetchItemFromNetwork:function(){return Pt},getFileTypeFromExtension:function(){return Qt},getFileTypeFromPath:function(){return Xt},getHootEndpoint:function(){return d.XQ},getOwlVersion:function(){return mt},getPrebootSessionId:function(){return q},getShareEndpoint:function(){return d.PO},getWebUrlForCopyLinkToPage:function(){return At},getWiseEnvironmentFromTeamsRing:function(){return G},initPackage:function(){return ht},isExpectedError:function(){return ve.Yf},isExpectedErrorByInfo:function(){return ve.aj},isMobilePhone:function(){return Bt},isNetworkError:function(){return ve.eE},localStorage:function(){return x.X},logFeatureGateUsage:function(){return Rn.dt},notifyHostAccessibilityLoopComplete:function(){return It},notifyHostBackButtonPressed:function(){return Ct},prebootApplication:function(){return K},prebootDocument:function(){return J},removePrebootSessionId:function(){return z},setWacDataCenterValueToCache:function(){return le},unifiedUiHostConfigs:function(){return re.J}});var n,e,t=u(6709);!function(n){n.Eo="App_AccessibilityLoopComplete",n.No="Wac_ActionComplete",n.ko="WacInitialize_Ready",n.Ro="Wac_AppFailed",n.Do="Wac_AppBootState",n.Oo="Wac_AppCompleted",n._o="BrowserEvent",n.Wo="UI_Close",n.Mo="App_CloseTab",n.jo="UI_Conversation",n.xo="UI_CopyAndEdit",n.Go="App_CreateNewDocument",n.Lo="Wac_AppDataSavedStatus",n.Bo="UI_Download",n.Vo="UI_Edit",n.Ko="Error",n.Jo="UI_FileEmbed",n.qo="UI_FileProperties",n.zo="File_Rename",n.Qo="File_RenameFailed",n.Xo="UI_FileVersions",n.Zo="StateChanged",n.Yo="App_IsFrameTrusted",n.$o="GetAccessToken",n.ni="App_GetAuthToken",n.ei="App_GetCustomAuthConfig",n.ti="App_GetHostKeyValue",n.oi="App_WopiInfoFromUrl",n.ii="App_DavUrlFromIds",n.ri="App_LoadingStatus",n.si="App_SwitchMode",n.li="App_MoveToFolder",n.ci="UI_OpenInMobileApp",n.di="UI_OpenInBrowser",n.fi="UI_OpenInClient",n.vi="PageChanged",n.hi="App_PushCommentContext",n.mi="App_PushState",n.wi="App_DocReboot",n.gi="UI_RedeemForCommenting",n.Si="App_RefreshSessionInfo",n.bi="UI_ReplyWithChanges",n.Ii="UI_ReportAbuse",n.Ci="App_FilePicker",n.Hi="UI_SaveStatus",n.Ai="WopiSession_Complete_Ack",n.yi="SetOverlayContent",n.Ti="UI_Sharing",n.Ui="UI_ShareForm",n.Fi="UI_SignIn",n.Pi="App_StoreHostKeyValue",n.Ei="App_Unloaded",n.Ni="App_UlsLog",n.ki="Wac_UnloadingApp",n.Ri="App_UpdateBootComplete",n.Di="PageCount",n.Oi="UI_CheckUserAccessAndGrantPermissions",n._i="User_Activity",n.Wi="Edit_Notification",n.Mi="UI_Workflow",n.ji="ZoomChanged",n.xi="CAAEMessage",n.Gi="Excel_HostFrameCacheSave",n.Li="Excel_HostFrameCacheEvict",n.Bi="Excel_RegenerateFileBundle",n.Vi="App_SwitchToWacFrame",n.Ki="App_SaveSSRData",n.Ji="App_PurgeDataInHostCache",n.qi="App_SaveHostRenderingV2Data",n.zi="App_SaveHostUtilsData",n.Qi="AcquireOAuthTokenTeams",n.Xi="App_SwitchNotebook",n.Zi="FailedBoot_CheckFileInfo",n.Yi="GetTeamsUsers",n.$i="SendTeamsUserMention",n.nr="NavigateBackToHost",n.er="App_GetClientUrlComplete",n.tr="App_GetWebUrlComplete",n.ir="App_CopyLinkComplete",n.rr="App_SendConversationId",n.ur="CloseTeamsConversation",n.ar="PageLoaded",n.sr="Visio_BRS",n.lr="Visio_SendLicenseInfo",n.cr="Visio_Consumption_CLTComplete",n.dr="Visio_SwitchMode_FromViewFrame",n.vr="Visio_ModeSwitch_ToHost_Ack",n.hr="Visio_UpdateEditUrl",n.pr="Visio_PageViewLoaded",n.mr="Visio_ActiveAppFrameLoadFailed",n.wr="Visio_DisposeBkgFrame",n.gr="Visio_ReadyToReceiveDocData",n.Sr="Visio_DocReboot_HostNav",n.br="Visio_SwitchToVisioFrame",n.Ir="WacAppPerfMetric",n.Cr="App_ModifyURLState",n.Hr="App_WacTokenAck"}(n||(n={})),function(n){n.Ar="Ack",n.yr="WacInitialize_Ready_Ack",n.Tr="Wac_BeforeUnloadApp",n.Ur="Blur_Focus",n.Fr="Wac_AppFailed_Ack",n.Pr="Wac_AppCompleted_Ack",n.Er="WopiStartSession_Complete",n.Nr="WopiPendingSession_Complete",n.kr="Host_AccessibilityLoopComplete",n.Yo="Host_IsFrameTrusted",n.Rr="Grab_Focus",n.Dr="HostCacheDiagnostic",n.Or="Host_KeyValue",n._r="JsApiDiagnostics",n.li="Host_MoveToFolder",n.Wr="PageChanged_Ack",n.Mr="App_PopState",n.jr="Host_SendChannelId",n.Gr="Host_SendConversationId",n.Lr="GetTeamsUsers_Reply",n.Br="SendTeamsUserMention_Reply",n.Vr="Host_BackButtonPressed",n.Kr="Host_GetClientUrl",n.Jr="Host_GetWebUrl",n.qr="OwlFrameDiagnostics",n.zr="File_Rename",n.Ci="Host_FilePicker",n.Qr="PostAccessToken",n.Xr="Host_SetAuthToken",n.Zr="Host_SetCustomAuthConfig",n.Yr="App_PushCommentContext",n.$r="CanEmbed",n.nu="Host_RefreshSessionInfo",n.eu="CheckUserAccessAndGrantPermissions_Result",n.tu="Host_WopiInfoFromUrl",n.ou="Host_DavUrlFromIds",n.iu="SetCurrentPage",n.ru="SetZoomLevel",n.uu="WopiPendingSession_Fail",n.au="SetOverlayContent",n.su="WopiPendingApplicationComplete_Received",n.lu="Host_SwitchMode",n.cu="Host_Unload",n.du="PageCount_Ack",n.fu="ZoomChanged_Ack",n.vu="Host_ShareUI",n.hu="Host_Telemetry",n.pu="Visio_ConsumptionCLTComplete_Ack",n.mu="Visio_SwitchMode_FromHF_Ack",n.wu="Visio_SwitchMode_FromHostFrame",n.gu="Visio_FallbackToLegacySwitch",n.Su="Visio_DocumentData",n.bu="Host_PostWacToken"}(e||(e={}));var o,i,r,s,l=function(){function o(o,i,r,u){void 0===u&&(u=!1),this.Iu=new Map,this.Cu=o,this.Hu=i,this.Au=new Set(this.enumValues(n)),this.yu=new Set(this.enumValues(e)),this.Tu=u,this.Uu="",r?"string"==typeof r?this.Fu=new Set([i,r]):Array.isArray(r)?this.Fu=new Set((0,t.ev)([i],r,!0)):"function"==typeof r?(this.Fu=new Set([this.Hu]),this.Pu=r):("string"==typeof r.validOrigins?this.Fu=new Set([i,r.validOrigins]):this.Fu=new Set((0,t.ev)([i],r.validOrigins,!0)),this.Pu=r.validateOrigin):this.Fu=new Set([i]),this.Eu=this.receiveMessage.bind(this),window.addEventListener("message",this.Eu)}return o.prototype.registerHandler=function(n,e){var t=this.Iu.get(n);t?t.push(e):this.Iu.set(n,[e])},o.prototype.sendMessage=function(n,e){var o,i,r=null!==(o=null==e?void 0:e.window)&&void 0!==o?o:this.Cu,u=null!==(i=null==e?void 0:e.origin)&&void 0!==i?i:this.Hu;if(this.validateOrigin(u)){var a=void 0;try{a=crypto.randomUUID()}catch(n){a=crypto.getRandomValues(new Uint8Array(16)).join("")}var s=(0,t.pi)((0,t.pi)({},n),{correlationId:a,sendTime:Date.now()});return r.postMessage(JSON.stringify(s),u),a}return!1},o.prototype.dispose=function(){window.removeEventListener("message",this.Eu)},o.prototype.receiveMessage=function(n){if(n.data&&"string"==typeof n.data&&this.validateOrigin(n.origin))try{var e=JSON.parse(n.data);if("MessageId"in e&&"SendTime"in e&&"CorrelationId"in e&&"Values"in e)this.Tu&&this.handleCrossDocumentMessage(n.data,e,n.origin);else if(e.id){var t=this.Iu.get(e.id);null==t||t.forEach((function(n){return n(e)}))}}catch(n){}},o.prototype.validateOrigin=function(n){var e,t=!1;return this.Fu.has(n)?t=!0:(null===(e=this.Pu)||void 0===e?void 0:e.call(this,n))&&(this.Fu.add(n),t=!0),t},o.prototype.handleCrossDocumentMessage=function(n,e,t){if(e.MessageId){if(t===this.Hu&&this.yu.has(e.MessageId))return window.parent.postMessage(n,this.Uu),!0;if(t.endsWith("officeapps.live.com")&&this.Au.has(e.MessageId))return this.Uu||(this.Uu=t),this.Cu.postMessage(n,this.Hu),!0}return!1},o.prototype.enumValues=function(n){return Object.keys(n).map((function(e){return n[e]}))},o}(),c=u(8959),d=u(2199),f=u(5796),v=u(280),h=u(7350),p=u(7784),m=u(759),w=u(2294),g=u(7075);function S(){var n,e;window.performance&&!((null===(n=window.performance.getEntriesByName(w.r_.OwlHostTimeOrigin))||void 0===n?void 0:n.length)>0||(null===(e=window.performance.getEntriesByName(w.r_.OwlFrameTimeOrigin))||void 0===e?void 0:e.length)>0)&&window.performance.mark("".concat(g.qj.isOwlFrame?w.r_.OwlFrameTimeOrigin:w.r_.OwlHostTimeOrigin),{startTime:0,detail:window.performance.timeOrigin})}(s=o||(o={})).FrameLoaded="Frame_FrameLoaded",s.GetAuthToken="Frame_GetAuthToken",s.BootComplete="Frame_BootComplete",s.SuccessNotification="Frame_OnSuccessNotification",s.BootFailure="Frame_BootFailure",s.ReturnFocus="Frame_ReturnFocus",s.ConversationClose="Frame_ConversationClose",s.NavigateBack="Frame_BackButtonPressed",s.OpenPageLevelConversation="Frame_OpenPageLevelConversation",s.DocumentClose="Frame_DocumentClose",s.OpenInMobileApp="Frame_OpenInMobileApp",s.FetchItemFromNetwork="Frame_FetchItemFromNetwork",s.FetchAccessToken="Frame_FetchAccessToken",s.OpenShareControl="Frame_OpenShareControl",s.CreateDocument="Frame_CreateDocument",s.SetTitle="Frame_SetTitle",s.UserActivity="Frame_UserActivity",s.CAAEMessage="Frame_CAAEMessage",s.UserAccess="Frame_UserAccess",s.MoveToFolder="Frame_MoveToFolder",s.SharedFilePicker="Frame_SharedFilePicker",s.Rename="Frame_Rename",s.FrameChange="Frame_FrameChange",s.InvokeSessionRefreshInfoPopupBlockedDialog="Frame_InvokeSessionRefreshInfoPopupBlockedDialog",s.FileEmbed="Frame_FileEmbed",s.EndSessionResponse="Frame_EndSessionResponse",s.EndSessionObservable="Frame_EndSessionObservable",s.TelemetryData="Frame_TelemetryData",(r=i||(i={})).BootApplication="Host_BootApplication",r.GetAuthTokenResponse="Host_GetAuthTokenResponse",r.EndSession="Host_EndSession",r.HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",r.GetClientUrl="Host_GetClientUrl",r.GetWebUrl="Host_GetWebUrl",r.BackButtonPressed="Host_BackButtonPressed",r.SendConversationId="Host_SendConversationId",r.PostWacToken="Host_PostWacToken",r.FetchItemFromNetworkResponse="Host_FetchItemFromNetworkResponse",r.FetchAccessTokenResponse="Host_FetchAccessTokenResponse",r.OpenShareControlResponse="Host_OpenShareControlResponse",r.CreateDocumentResponse="Host_CreateDocumentResponse",r.SessionRefreshInfoDialogHandleRefresh="Host_SessionRefreshInfoDialogHandleRefresh",r.SessionRefreshInfoDialogHandleCancel="Host_SessionRefreshInfoDialogHandleCancel",r.SessionRefreshInfoDialogOnDismiss="Host_SessionRefreshInfoDialogOnDismiss",r.SharingLinkTokenProvider="Host_SharingLinkTokenProvider",r.TelemetryData="Host_TelemetryData";var b=u(167);function I(n){var e,o,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,I,C,H,A,y,T,U,F,P,E,N,R,D,O,_,W,M,j,x,G,L,B,V;return{documentIdentifier:n.documentIdentifier,sessionConfig:{hostCorrelationId:n.sessionConfig.hostCorrelationId,isMsa:n.sessionConfig.isMsa,tenantId:n.sessionConfig.tenantId,organizationName:n.sessionConfig.organizationName,sessionId:n.sessionConfig.sessionId,isESSEnabled:n.sessionConfig.isESSEnabled,experiments:n.sessionConfig.experiments,highContrastMode:n.sessionConfig.highContrastMode,additionalApplicationParameters:n.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(e=n.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.tabsCacheHit,packageEntryTime:null===(o=n.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime,isTestMode:null===(i=n.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.isTestMode,isManifestCachingEnabled:null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(u=n.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isOwlBootstrapperEnabled,isPrebooted:null===(a=n.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(s=n.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isVroom21,ringId:null===(l=n.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.ringId,teamsContextStartTime:null===(c=n.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.teamsContextStartTime,teamsContextEndTime:null===(d=n.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(f=n.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataStartTime,wopiDataEndTime:null===(v=n.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.wopiDataEndTime,bootStrapStartTime:null===(h=n.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.bootStrapStartTime,bootStrapEndTime:null===(p=n.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapEndTime,driveItemStartTime:null===(m=n.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(w=n.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemEndTime,driveItemFromWacStartTime:null===(g=n.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(S=n.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.driveItemFromWacEndTime,accessTokenStartTime:null===(I=n.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.accessTokenStartTime,accessTokenEndTime:null===(C=n.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.accessTokenEndTime,isCookieBlocked:null===(H=n.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.isCookieBlocked,meetingLiveDiagnostics:null===(A=n.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.meetingLiveDiagnostics,spRequestGuid:null===(y=n.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.spRequestGuid,createNewStartTime:null===(T=n.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.createNewStartTime,createNewEndTime:null===(U=n.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.createNewEndTime,loadManifestStartTime:null===(F=n.sessionConfig.bootDiagnostics)||void 0===F?void 0:F.loadManifestStartTime,loadManifestEndTime:null===(P=n.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.loadManifestEndTime,getManifestFromRemoteTimeElapsed:null===(E=n.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.getManifestFromRemoteTimeElapsed,loadManifestServerTimeElapsed:null===(N=n.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.loadManifestServerTimeElapsed,loadOwlStartTime:null===(R=n.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.loadOwlStartTime,loadOwlEndTime:null===(D=n.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.loadOwlEndTime,owlBootstrapperStartTime:null===(O=n.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(_=n.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.owlBootstrapperEndTime,isOdcMigrated:null===(W=n.sessionConfig.bootDiagnostics)||void 0===W?void 0:W.isOdcMigrated,perfNavigationTiming:(null===(M=n.sessionConfig.bootDiagnostics)||void 0===M?void 0:M.perfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:(null===(x=null===(j=n.sessionConfig.bootDiagnostics)||void 0===j?void 0:j.legacyPerformanceData)||void 0===x?void 0:x.host)||(0,b.vb)()},wacTokenFetchStartTime:null===(G=n.sessionConfig.bootDiagnostics)||void 0===G?void 0:G.wacTokenFetchStartTime,wacTokenFetchEndTime:null===(L=n.sessionConfig.bootDiagnostics)||void 0===L?void 0:L.wacTokenFetchEndTime},uiHostTabId:n.sessionConfig.uiHostTabId,upn:n.sessionConfig.upn,meeting:n.sessionConfig.meeting,customAuthConfigValue:n.sessionConfig.customAuthConfigValue,wiseEnvironment:n.sessionConfig.wiseEnvironment,isSynthetic:n.sessionConfig.isSynthetic,hostUrl:n.sessionConfig.hostUrl,owlVersion:n.sessionConfig.owlVersion,owlRollout:n.sessionConfig.owlRollout,fileType:n.sessionConfig.fileType,clickTime:n.sessionConfig.clickTime,uiCulture:n.sessionConfig.uiCulture,dataCulture:n.sessionConfig.dataCulture,puid:n.sessionConfig.puid,isNewFile:n.sessionConfig.isNewFile,wdValue:n.sessionConfig.wdValue,sessionOrigin:n.sessionConfig.sessionOrigin,intent:n.sessionConfig.intent,hostClientType:n.sessionConfig.hostClientType,isPopOut:n.sessionConfig.isPopOut,teamType:n.sessionConfig.teamType,initPackageParams:n.sessionConfig.initPackageParams&&(0,t.pi)((0,t.pi)({},n.sessionConfig.initPackageParams),{jsApiUrlInfos:(null===(B=n.sessionConfig.initPackageParams)||void 0===B?void 0:B.jsApiUrlInfos)&&k(null===(V=n.sessionConfig.initPackageParams)||void 0===V?void 0:V.jsApiUrlInfos)}),origin:n.sessionConfig.origin},uiHostConfig:(0,t.pi)((0,t.pi)({},n.uiHostConfig),{featureGates:n.uiHostConfig.featureGates&&k(n.uiHostConfig.featureGates)})}}function C(n,e){(0,c.l5)(w.r_.OwlOnBootComplete),null==Dt||Dt.sendMessage({id:o.BootComplete,data:{docInfo:n,wacBootDiagnostics:e}}),function(){var n=(0,w.ME)(),e=n.bootTelemetryData,t=n.owlTelemetryData;null==Dt||Dt.sendMessage({id:o.TelemetryData,data:{bootTelemetryData:e,owlTelemetryData:t}})}()}function H(n,e){null==Dt||Dt.sendMessage({id:o.BootFailure,data:{errorInfo:n,docInfo:e}})}function A(n){null==Dt||Dt.sendMessage({id:o.ReturnFocus,data:{navigateForward:n}})}function y(){null==Dt||Dt.sendMessage({id:o.ConversationClose,data:{}})}function T(){null==Dt||Dt.sendMessage({id:o.NavigateBack,data:{}})}function U(n,e,t){null==Dt||Dt.sendMessage({id:o.OpenPageLevelConversation,data:{conversationId:n,pageUrl:e,hostSendConversationId:t}})}function F(){null==Dt||Dt.sendMessage({id:o.DocumentClose,data:{}})}function P(){null==Dt||Dt.sendMessage({id:o.SuccessNotification,data:{}})}function E(n,e){null==Dt||Dt.sendMessage({id:o.OpenInMobileApp,data:{openInAppUrl:n,storeUrl:e}})}function N(){var n=document.createElement("div");return n.id="owl-container",n}function k(n){return JSON.stringify(Array.from(n.entries()))}function R(n){if(n)try{return new Map(JSON.parse(n))}catch(n){return}}var D,O=u(6768);!function(n){n.Item="item",n.Response="response",n.Result="result",n.Token="token",n.URL="url"}(D||(D={}));var _=u(6938),W=u(2544),M=u(933),j=u(3979),x=u(4048);function G(n){switch(n){case"ring0":case"ring1":case"ring2":return"FASTFOOD";case"ring3_9":return"MSIT";case"general_gcc":return"USGOV";case"gcchigh":return"TRAILBLAZER";case"dod":return"PATHFINDER";case"ag08":return"AIRGAP08";case"ag09":return"AIRGAP09";case"gallatin":return"GALLATIN";default:return"PRODUCTION"}}var L=u(681),B="PrebootDocument",V="owlfc";function K(n,e,t){var o=(0,c.a)(),i=(0,_.L8)(),r=(0,W.q_)(n);if(r)if(x.X){var u=x.X.getItem(r);if(u)null==i||i.ULS.sendTraceTag(545036514,f.W.oo,v.G.Verbose,"prebootDocument: Session is already prebooted with sessionid: "+u);else{var a=(0,h.n)()[0];x.X.setItem(r,a);var s=new b.zP(a,n.fileType,t).health;null==s||s.updatePartADimensions({applicationLcid:n.uiCulture,loggableUserId:n.puid,sessionOrigin:n.wdOrigin}),null==s||s.addOrUpdatePartCDimension("IsNewFile",(!!n.isNewFile).toString());var l=new Map;l.set("StartTime",(new Date).toUTCString()),null==s||s.recordKpiUsage(B,p.o.FailureBased,V,l),l.delete("StartTime"),(0,M.o)(n,e,i).then((function(n){null==i||i.ULS.sendTraceTag(558158863,f.W.oo,v.G.Info,"prebootDocument: Attempting to preboot document with sessionid: "+a),function(n,e){var t;if(!n||!e)return!1;var o="access_token="+encodeURIComponent(e.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(e.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(null!==(t=e.bundleUrl)&&void 0!==t?t:"")+"&user_id="+encodeURIComponent(e.wac.userId),i=Q(e.wac.applicationUrl);if(!i)return!1;var r=encodeURIComponent(e.wac.wopiSrc),u=(0,j.l_)(),a=new XMLHttpRequest;return a.open("POST",i+"?op=preboot&usid="+encodeURI(n)+"&wopisrc="+r+"&sc="+u),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(o),!0}(a,n.wopiHostData)?i.ULS.sendTraceTag(558158864,f.W.oo,v.G.Info,"prebootDocument: Preboot request sent successfully with sessionid: "+a):(null===x.X||void 0===x.X||x.X.removeItem(r),i.ULS.sendTraceTag(545036515,f.W.oo,v.G.Info,"prebootDocument: Preboot request cannot be made with sessionid: "+a),l.set("FailureTime",(new Date).toUTCString()),null==s||s.recordKpiFailure(B,"PrebootRequestFailed",!1,!0,{durationMs:(0,c.a)()-o,extendedProperties:l}))})).catch((function(n){i.ULS.sendTraceTag(558158865,f.W.oo,v.G.Warning,"prebootDocument: Failed to send Preboot request with WacDocumentVroomError:"+JSON.stringify(n)),l.set("DriveItemError",JSON.stringify(n)),l.set("FailureTime",(new Date).toUTCString()),null==s||s.recordKpiFailure(B,"PrebootDriveItemRequestFailed",!1,!1,{durationMs:(0,c.a)()-o,extendedProperties:l}),null===x.X||void 0===x.X||x.X.removeItem(r)}))}}else null==i||i.ULS.sendTraceTag(527471828,f.W.oo,v.G.Warning,"prebootDocument: 3rd Party Cookie is blocked! Cannot perform preboot. Bail out.");else null==i||i.ULS.sendTraceTag(558158862,f.W.oo,v.G.Verbose,"prebootDocument: Not enough document information was provided. Cannot get unique identifier.")}function J(n,e,t){K(n,e,G(t))}function q(n){var e=(0,W.q_)(n);return e&&x.X?x.X.getItem(e):null}function z(n,e){if(e){var t=(0,W.q_)(n);if(t)return null===x.X||void 0===x.X||x.X.removeItem(t),!0}return!1}function Q(n){if(!n)return null;var e=(0,L.k$)(n);if(!e)return null;var t=e.path.substring(0,e.path.lastIndexOf("/"))+"/preboot.ashx";return e.protocol+"//"+e.hostname+t}var X=function(){function n(n){var e=this;this.Nu=!1,this.ku="",this.Ru=[],this.Du=function(n){e.Nu||(e.Nu=!0,e.ku=n?"timeout":"cancelled",e.Ru.map((function(n){return n()})),e.Ru=[])},this.Ou=n,window.setTimeout((function(){return e.Du(!0)}),n)}return Object.defineProperty(n.prototype,"isCancelled",{get:function(){return this.Nu},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timeoutInMs",{get:function(){return this.Ou},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"reason",{get:function(){return this.ku},enumerable:!1,configurable:!0}),n.prototype.cancel=function(){this.Du(!1)},n.prototype.subscribe=function(n){this.Nu?n():this.Ru.push(n)},n}(),Z=u(7783),Y=u(1328),$=u(826),nn=u(6839),en=u(8973),tn=u(9055),on=u(8267);function rn(n,e){return function(t){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new un(n,e))}}var un=function(){function n(n,e){this.project=n,this.thisArg=e}return n.prototype.call=function(n,e){return e.subscribe(new an(n,this.project,this.thisArg))},n}(),an=function(n){function e(e,t,o){var i=n.call(this,e)||this;return i.project=t,i.count=0,i.thisArg=o||i,i}return tn.ZT(e,n),e.prototype._=function(n){var e;try{e=this.project.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)},e}(on.L);function sn(n,e,t,o){return(0,en.m)(t)&&(o=t,t=void 0),o?sn(n,e,t).pipe(rn((function(n){return(0,nn.k)(n)?o.apply(void 0,n):o(n)}))):new $.y((function(o){ln(n,e,(function(n){arguments.length>1?o.next(Array.prototype.slice.call(arguments)):o.next(n)}),o,t)}))}function ln(n,e,t,o,i){var r;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){var u=n;n.addEventListener(e,t,i),r=function(){return u.removeEventListener(e,t,i)}}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){var a=n;n.on(e,t),r=function(){return a.off(e,t)}}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){var s=n;n.addListener(e,t),r=function(){return s.removeListener(e,t)}}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(var l=0,c=n.length;l<c;l++)ln(n[l],e,t,o,i)}o.add(r)}var cn=u(8750);function dn(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var fn=dn(),vn=u(9604);var hn=u(5149),pn=function(n){if(n&&"function"==typeof n[vn.L])return r=n,function(n){var e=r[vn.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(n)};if((e=n)&&"number"==typeof e.length&&"function"!=typeof e)return i=n,function(n){for(var e=0,t=i.length;e<t&&!n.closed;e++)n.next(i[e]);n.complete()};var e;if(function(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}(n))return o=n,function(n){return o.then((function(e){n.closed||(n.next(e),n.complete())}),(function(e){return n.error(e)})).then(null,cn.z),n};if(n&&"function"==typeof n[fn])return t=n,function(n){for(var e=t[fn]();;){var o=void 0;try{o=e.next()}catch(e){return n.error(e),n}if(o.done){n.complete();break}if(n.next(o.value),n.closed)break}return"function"==typeof e.return&&n.add((function(){e.return&&e.return()})),n};var t,o,i,r,u=(0,hn.K)(n)?"an invalid object":"'"+n+"'";throw new TypeError("You provided "+u+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};u(1492);var mn=function(n){function e(e){var t=n.call(this)||this;return t.parent=e,t}return tn.ZT(e,n),e.prototype._=function(n){this.parent.notifyNext(n)},e.prototype.B=function(n){this.parent.notifyError(n),this.unsubscribe()},e.prototype.Y=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(on.L),wn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return tn.ZT(e,n),e.prototype.notifyNext=function(n){this.destination.next(n)},e.prototype.notifyError=function(n){this.destination.error(n)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(on.L);function gn(n,e,t){return void 0===t&&(t=Number.POSITIVE_INFINITY),"function"==typeof e?function(o){return o.pipe(gn((function(t,o){return(i=n(t,o),i instanceof $.y?i:new $.y(pn(i))).pipe(rn((function(n,i){return e(t,n,o,i)})));var i}),t))}:("number"==typeof e&&(t=e),function(e){return e.lift(new Sn(n,t))})}var Sn=function(){function n(n,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=n,this.concurrent=e}return n.prototype.call=function(n,e){return e.subscribe(new bn(n,this.project,this.concurrent))},n}(),bn=function(n){function e(e,t,o){void 0===o&&(o=Number.POSITIVE_INFINITY);var i=n.call(this,e)||this;return i.project=t,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return tn.ZT(e,n),e.prototype._=function(n){this.active<this.concurrent?this._u(n):this.buffer.push(n)},e.prototype._u=function(n){var e,t=this.index++;try{e=this.project(n,t)}catch(n){return void this.destination.error(n)}this.active++,this.Wu(e)},e.prototype.Wu=function(n){var e=new mn(this),t=this.destination;t.add(e);var o=function(n,e){if(!e.closed){if(n instanceof $.y)return n.subscribe(e);var t;try{t=pn(n)(e)}catch(n){e.error(n)}return t}}(n,e);o!==e&&t.add(o)},e.prototype.Y=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(n){this.destination.next(n)},e.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n.length>0?this._(n.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(wn),In=function(){function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n}(),Cn=function(){function n(n){if(this.total=n,this.total<0)throw new In}return n.prototype.call=function(n,e){return e.subscribe(new Hn(n,this.total))},n}(),Hn=function(n){function e(e,t){var o=n.call(this,e)||this;return o.total=t,o.count=0,o}return tn.ZT(e,n),e.prototype._=function(n){var e=this.total,t=++this.count;t<=e&&(this.destination.next(n),t===e&&(this.destination.complete(),this.unsubscribe()))},e}(on.L);function An(n,e){return function(t){return t.lift(new Tn(n,e))}}var yn,Tn=function(){function n(n,e){this.predicate=n,this.thisArg=e}return n.prototype.call=function(n,e){return e.subscribe(new Un(n,this.predicate,this.thisArg))},n}(),Un=function(n){function e(e,t,o){var i=n.call(this,e)||this;return i.predicate=t,i.thisArg=o,i.count=0,i}return tn.ZT(e,n),e.prototype._=function(n){var e;try{e=this.predicate.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(n)},e}(on.L),Fn=u(8396),Pn=u(3821),En=u(3065),Nn=u(5540),kn=u(1507);!function(n){n.AccessibilityLoopCompleted="AccessibilityLoopCompleted",n.ActionCompleted="ActionCompleted",n.BrowserEvent="BrowserEvent",n.CAAEMessage="CAAEMessage",n.Close="Close",n.ContentDisplayed="ContentDisplayed",n.Conversation="Conversation",n.CopyAndEdit="CopyAndEdit",n.CreateNewDocument="CreateNewDocument",n.Download="Download",n.Edit="Edit",n.Error="Error",n.FileEmbed="FileEmbed",n.FileProperties="FileProperties",n.FileRenamed="FileRenamed",n.FileVersions="FileVersions",n.FrameStateChanged="FrameStateChanged",n.FrameTrust="FrameTrust",n.GetAccessToken="GetAccessToken",n.GetAuthToken="GetAuthToken",n.GetCustomAuthConfig="GetCustomAuthConfig",n.GetWopiInfoFromUrl="GetWopiInfoFromUrl",n.GetDavUrlFromIds="GetDavUrlFromIds",n.ModeSwitched="ModeSwitched",n.MoveToFolder="MoveToFolder",n.OpenInMobileApp="OpenInMobileApp",n.OpenInBrowser="OpenInBrowser",n.OpenInClient="OpenInClient",n.PageChanged="PageChanged",n.PushState="PushState",n.Reboot="Reboot",n.RedeemForCommenting="RedeemForCommenting",n.RefreshSessionInfo="RefreshSessionInfo",n.ReplyWithChanges="ReplyWithChanges",n.ReportAbuse="ReportAbuse",n.SessionStarted="SessionStarted",n.SharedFilePicker="SharedFilePicker",n.SaveStatus="SaveStatus",n.Share="Share",n.ShareForm="ShareForm",n.SignIn="SignIn",n.SplashScreenShown="SplashScreenShown",n.UserAccessAndPermissions="UserAccessAndPermissions",n.UserActivity="UserActivity",n.UserEditActivity="UserEditActivity",n.Workflow="Workflow",n.ZoomChanged="ZoomChanged",n.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",n.LoadingStatus="LoadingStatus",n.SwitchNotebook="SwitchNotebook",n.FailedBootCheckFileInfo="FailedBootCheckFileInfo",n.GetTeamsUsers="GetTeamsUsers",n.SendTeamsUserMention="SendTeamsUserMention",n.NavigateBackToHost="NavigateBackToHost",n.GetClientUrlComplete="GetClientUrlComplete",n.GetWebUrlComplete="GetWebUrlComplete",n.CopyLinkComplete="CopyLinkComplete",n.SendConversationId="SendConversationId",n.CloseTeamsConversation="CloseTeamsConversation",n.PageLoaded="PageLoaded",n.FrameChanged="FrameChanged"}(yn||(yn={}));var Rn=u(3594),Dn=function(){function n(n){var e=this;this.resolve=function(){null==n||n.ULS.sendTraceTag(507586270,f.W.oo,v.G.Warning,"DeferredPromise.resolve() called before resolve function was set")},this.reject=function(e){return null==n?void 0:n.ULS.sendTraceTag(507586269,f.W.oo,v.G.Error,"DeferredPromise.reject() called before reject function was set. Error: ".concat(e))},this.Mu=new Promise((function(n,t){e.resolve=n,e.reject=t})),this.Mu.finally}return n.prototype.then=function(n,e){return this.Mu.then(n,e)},n.prototype.catch=function(n){return this.Mu.catch(n)},n.prototype.finally=function(n){return this.Mu.finally(n)},n}(),On=u(2506),_n="officeapps.live.com",Wn="PostWacToken",Mn="owlfc",jn=2e3,xn=9e3,Gn=9500,Ln=6e5,Bn={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1},Vn={};function Kn(n){var e,o,i,r,a=(null===(e=n.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.hostPageFirstFlushTime)||(0,c.a)(),s=n.documentBootInfo,l=n.fetchItemFromNetwork,d=n.fetchAccessToken,h=n.sessionConfig,S=n.container,b=n.setTitle,I=n.onBootComplete,C=n.onBootFailure,H=n.onReturnFocus,A=n.onConversationClose,y=n.onNavigateBack,T=n.onOpenPageLevelConversation,U=n.onDocumentClose,F=n.onSuccessNotification,P=n.onDismissHostSpinner,E=n.uiHostConfig,N=n.createDocument,k=n.openShareControl,R=n.onOpenInMobileApp,D=n.sharingLinkTokenProvider,W=n.onUserActivity,M=n.onCAAEMessage,x=n.onUserAccess,G=n.onMoveToFolder,L=n.onSharedFilePicker,B=n.onRename,V=n.initPackageParams,K=n.onFrameChange,J=n.invokeSessionRefreshInfoPopupBlockedDialog,q=n.onFileEmbed,z=n.bootstrapFile,Q=null==E?void 0:E.supportsExplicitUnload;h.logger||(h.logger=(0,_.L8)());var $=h.hostCorrelationId,nn=h.isMsa,en=h.tenantId,tn=h.shareApiEndpoint,on=h.organizationName,un=h.logger,an=h.hostClientType,ln=h.channelId,cn=h.health,dn=(0,j.ZR)(s.fileType,null==E?void 0:E.featureGates,un);null==un||un.ULS.sendTraceTag(576578584,f.W.oo,v.G.Info,"Lean Ui Host: bootApp");var fn,vn=new X(Ln),hn=[],pn=function(n){return new Promise((function(e){dn&&!vn&&e("No active session to close. Return from here.");var o=function(n){null==un||un.ULS.sendTraceTag(575411776,f.W.oo,v.G.Info,"Dispose the WAC frame. And reboot: ".concat(n?"true":"false")),Yn.next(n),Yn.complete(),xt(),e("WAC frame disposed")},i=function(){s.fileType===m.T.Excel&&(0,Pn.gP)(),null==zn||zn.unsubscribe(),null==Qn||Qn.unsubscribe()};if(!Sn)return null==un||un.ULS.sendTraceTag(529093076,f.W.oo,v.G.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void o(n);if(dn)null==Sn||Sn.removeEventListener(fn),null==vn||vn.cancel(),null==Sn||Sn.dispose().catch((function(n){null==un||un.ULS.sendTraceTag(527257879,f.W.oo,v.G.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(Kn,", Error: ").concat(n))})).finally((function(){i(),o(n)}));else if(hn.forEach((function(n){var e=(0,t.CR)(n,2),o=e[0],i=e[1];Sn.RemoveEventHandler(o,i)})),null==Sn||Sn.Dispose(Q,function(n){if(n===m.T.OneNote)return xn}(s.fileType)),i(),Q){Sn.RegisterEventHandler(Nn.E_.Event_Unloaded,(function(){null==un||un.ULS.sendTraceTag(575411777,f.W.oo,v.G.Info,"Receive Unloaded Event from WAC"),Kn=!0,clearTimeout(r),o(n)}));var r=window.setTimeout((function(){null==un||un.ULS.sendTraceTag(575411778,f.W.oo,v.G.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(Kn)),Kn||o(n)}),s.fileType===m.T.OneNote?Gn:jn)}else null==un||un.ULS.sendTraceTag(575271647,f.W.oo,v.G.Info,"No Explicit Unload. Tear down the WAC frame to end session."),o(n)}))},mn=function(n,e,o){var i,r,a,c,p=Promise.resolve(null===(i=null==n?void 0:n.wac)||void 0===i?void 0:i.applicationUrl),m=function(){return e.asObservable().pipe((function(n){return n.lift(new Cn(1))})).toPromise()},w=null!==(r=null==E?void 0:E.sessionOriginPrefix)&&void 0!==r?r:"TEAMS.UNIFIEDUIHOST.",g=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().documentRebootHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,health:cn,getWdOrigin:function(n){return"".concat(w).concat(n)},reboot:function(n,e){pn({documentBootInfo:n,navigationRequired:!e}).catch((function(){null==un||un.ULS.sendTraceTag(512296464,f.W.oo,v.G.Error,"endSession: endSession error in DocumentReboot")}))}}),b=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().renameHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({bootedDocumentInfo:e,getCurrentDocumentInfo:m,hostRenameCallback:B,health:cn}),I=function(n){var e=this,o=(0,t.pi)((0,t.pi)({},n),{popupMetadata:{retry:0,dialogInvoked:!1,popupOpen:!1}});return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().sessionRefreshInfoHandler(o,n)];case 2:return e.sent(),[2]}}))}))}}({hostUrl:null==h?void 0:h.hostUrl,supportsRefreshTokenReauthPopUp:null==E?void 0:E.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:m,documentBootInfo:s,fetchItemFromNetwork:l,officeDocumentSession:o,appUrlPromise:p,invokePopupBlockedDialog:J,logger:un,health:cn}),C=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().shareHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,sharePointInfo:n.sharePointInfo,shareApiEndPointBase:tn,fetchAccessToken:d,openShareControl:k,correlationId:In,isMsa:nn,tenantId:en,organizationName:on,onOpen:function(){(0,En.R)(Nn.KX.PostMessage_BlurFocus,void 0,Un,Jn,un)},onClose:function(){(0,En.R)(Nn.KX.PostMessage_GrabFocus,void 0,Un,Jn,un)},health:cn,featureGates:null==E?void 0:E.featureGates,logger:un}),F=null!=x?x:function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().userAccessHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,shareHandler:C,officeDocumentSession:o,appUrlPromise:p,logger:un,health:cn}),P=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().userActivityHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:m,onUserActivity:W,health:cn}),O=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().createNewHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,createDocument:N,getWdOrigin:function(n){return"".concat(w).concat(n)},reboot:function(n,e){pn({documentBootInfo:n,navigationRequired:!e}).catch((function(n){var e=(0,Rn.vJ)(Rn.Fh.FeatureGate_CommandingAshaVetoes,null==E?void 0:E.featureGates);(0,Rn.dt)(Rn.Fh.FeatureGate_CommandingAshaVetoes,e,un),e&&(null==cn||cn.recordQosError(kn.DG.QosError_CreateNewHandlerEndSessionFailure,[kn.cS.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",kn.DG.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat(In)],["Reason",n]])})),null==un||un.ULS.sendTraceTag(512296463,f.W.oo,v.G.Error,"endSession: endSession error in DocumentCreate")}))},logger:un,health:cn,correlationId:In}),_=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().getAuthTokenHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,fetchAccessToken:d,officeDocumentSession:o,appUrlPromise:p,logger:un,health:cn}),j=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().sendConversationIdHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,onOpenPageLevelConversation:T,hostSendConversationId:$n,health:cn}),z=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().closeTeamsConversationHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:m,onConversationClose:A,health:cn}),Q=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().navigateBackToHostHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:m,onNavigateBack:y,health:cn}),X=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().accessibilityLoopCompleteHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,onReturnFocus:H,health:cn}),Z=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().getClientUrlCompleteHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,hostClientType:an,logger:un,openInMobileAppCallback:R,health:cn}),Y=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().loadingStatusHandler(n)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,channelId:ln,officeDocumentSession:o,appUrlPromise:p,health:cn}),$=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().getWebUrlCompleteHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,hostClientType:an,logger:un,health:cn}),rn=(0,Pn.a6)({getCurrentDocumentInfo:m,fetchItemFromNetwork:l,officeDocumentSession:o,appUrlPromise:p,logger:un,health:cn}),sn=(0,Pn.ok)({getCurrentDocumentInfo:m,fetchItemFromNetwork:l,officeDocumentSession:o,appUrlPromise:p,logger:un,health:cn}),dn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().actionCompleteHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,logger:un,webUrl:null!==(a=n.webUrl)&&void 0!==a?a:"",health:cn}),fn=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().openInBrowserHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:m,logger:un,webUrl:null!==(c=n.webUrl)&&void 0!==c?c:"",health:cn,correlationId:In}),vn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().openInMobileAppHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,logger:un,openInMobileAppCallback:R,health:cn,correlationId:In}),hn={appUrlPromise:p,container:S,fetchAccessToken:d,fetchItemFromNetwork:l,getCurrentDocumentInfo:m,host:null==E?void 0:E.uiHostName,health:cn,logger:un,officeDocumentSession:o,wopiHostData:n,sessionConfig:h,uiHostConfig:E,initPackageParams:V},mn=null!=G?G:function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().moveToFolderFilePickerHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}(hn),wn=null!=L?L:function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().commonPickerHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}(hn),gn=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return[4,e.sent().getCustomAuthConfigHandler(n)];case 2:return e.sent(),[2]}}))}))}}({customAuthConfigValue:null==h?void 0:h.customAuthConfigValue,getCurrentDocumentInfo:m,officeDocumentSession:o,appUrlPromise:p,logger:un,health:cn}),Sn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().pushStateHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,supportsPopAndPushState:null==E?void 0:E.supportsPopAndPushState,logger:un,sharingLinkTokenProvider:D,health:cn}),bn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().caaeMessageHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,onCAAEMessage:M,health:cn}),Hn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().popStateCallback(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,appUrlPromise:p,logger:un,officeDocumentSession:o,health:cn});!function(n){var e=n.onPopState;n.supportsPopAndPushState&&window.addEventListener("popstate",e)}({getCurrentDocumentInfo:m,onPopState:Hn,supportsPopAndPushState:null==E?void 0:E.supportsPopAndPushState,health:cn});var An=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,4347))];case 1:return e.sent().frameChangedHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:m,onFrameChange:K,health:cn});return{documentRebootHandler:g,renameHandler:b,sessionRefreshInfoHandler:I,shareHandler:C,userAccessHandler:F,userActivityHandler:P,createNewHandler:O,getAuthTokenHandler:_,sendConversationIdHandler:j,closeTeamsConversationHandler:z,navigateBackToHostHandler:Q,accessibilityLoopCompleteHandler:X,getClientUrlCompleteHandler:Z,getWebUrlCompleteHandler:$,loadingStatusHandler:Y,wopiInfoFromUrlHandler:rn,davUrlFromIdsHandler:sn,onCloseHandler:function(){null==un||un.ULS.sendTraceTag(575545427,f.W.oo,v.G.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(U?"true":"false")),U&&U()},actionCompleteHandler:dn,openInBrowserHandler:fn,openInMobileAppHandler:vn,moveToFolderPickerHandler:mn,commonFilePickerHandler:wn,getCustomAuthConfigHandler:gn,pushStateHandler:Sn,caaeMessageHandler:bn,frameChangedHandler:An,fileEmbedHandler:function(){q&&q()},dismissSplashScreenHandler:function(){var n=document.getElementById("splashscreen-container");n&&(n.style.display="none")}}},wn=(null==V?void 0:V.jsApiUrlInfos)?null==V?void 0:V.jsApiUrlInfos:new Map;0===wn.size&&wn.set(m.T.Word,{jsApiUrl:null===(o=null==V?void 0:V.wordBootstrapperUrlInfo)||void 0===o?void 0:o.url,jsApiSri:null===(i=null==V?void 0:V.wordBootstrapperUrlInfo)||void 0===i?void 0:i.sri,PreloadedInBootStrapper:null===(r=null==V?void 0:V.wordBootstrapperUrlInfo)||void 0===r?void 0:r.wordJsApiPreloadedInBootStrapper});var Sn,bn=(0,Fn.Tq)(s,$,l,E,h,C,!1,F,(function(n,e,t,o){Sn=n;var i=new Y.X(t),r=mn(e,i,o),u=r.documentRebootHandler,a=r.renameHandler,s=r.sessionRefreshInfoHandler,l=r.shareHandler,c=r.userAccessHandler,d=r.userActivityHandler,f=r.createNewHandler,v=r.getAuthTokenHandler,h=r.sendConversationIdHandler,p=r.closeTeamsConversationHandler,w=r.navigateBackToHostHandler,g=r.accessibilityLoopCompleteHandler,S=r.getClientUrlCompleteHandler,b=r.getWebUrlCompleteHandler,I=r.loadingStatusHandler,C=r.wopiInfoFromUrlHandler,H=r.davUrlFromIdsHandler,A=r.onCloseHandler,y=r.actionCompleteHandler,T=r.openInBrowserHandler,U=r.openInMobileAppHandler,N=r.moveToFolderPickerHandler,k=r.commonFilePickerHandler,R=r.getCustomAuthConfigHandler,D=r.pushStateHandler,O=r.caaeMessageHandler,_=r.frameChangedHandler,W=r.fileEmbedHandler,M=r.dismissSplashScreenHandler,j=(0,Rn.vJ)(Rn.Fh.FeatureGate_UseNewEuplReporting,null==E?void 0:E.featureGates);fn=function(n){var e=n.data;switch(n.type){case yn.Reboot:u(e);break;case yn.FileRenamed:a(e);break;case yn.UserAccessAndPermissions:c(e);break;case yn.Share:l(e);break;case yn.UserActivity:d(e);break;case yn.CreateNewDocument:f(e);break;case yn.RefreshSessionInfo:s(e);break;case yn.GetAuthToken:v(e);break;case yn.AccessibilityLoopCompleted:g(e);break;case yn.GetClientUrlComplete:S(e);break;case yn.LoadingStatus:I(e);break;case yn.GetWebUrlComplete:b(e);break;case yn.NavigateBackToHost:w(e);break;case yn.SendConversationId:h(e);break;case yn.CloseTeamsConversation:p(e);break;case yn.GetWopiInfoFromUrl:C(e);break;case yn.Close:A();break;case yn.ActionCompleted:y(e);break;case yn.OpenInBrowser:T(e);break;case yn.OpenInMobileApp:U(e);break;case yn.MoveToFolder:N(e);break;case yn.SharedFilePicker:k(e);break;case yn.GetCustomAuthConfig:R(e);break;case yn.GetDavUrlFromIds:H(e);break;case yn.PushState:D(e);break;case yn.CAAEMessage:O(e);break;case yn.FrameChanged:_(e);break;case yn.FileEmbed:W();break;case yn.ContentDisplayed:j&&t.fileType!==m.T.Excel&&(null==F||F(j));break;case yn.SessionStarted:j&&t.fileType!==m.T.Excel&&(null==P||P());break;case yn.SplashScreenShown:M()}},Sn.addEventListener(fn)}),vn,wn,z),In=bn.correlationId,Hn=bn.bootstrapperObservable,Tn=bn.fileNamePromise,Un=bn.applicationUrlPromise;null==un||un.ULS.sendTraceTag(546182048,f.W.oo,v.G.Info,"BootApp: Load document returned"),Tn.then((function(n){return null==b?void 0:b(n)})).catch((function(){return"obligatory catch"}));var Kn,Jn=void 0,qn=void 0,zn=void 0,Qn=void 0,Xn=new Dn(un),Zn=new Dn(un),Yn=new O.xQ,$n=function(n){(0,En.R)(Nn.KX.PostMessage_HostSendConversationId,{conversationId:n},Un,Jn,un)};return zn=function(n,e,t){return n.pipe(gn((function(n){return n({container:e,flushTime:t})}),void 0,1))}(Hn,S,a).subscribe((function(n){var e=n.officeApplication,o=n.bootedDocumentInfo,i=n.wopiHostData,r=n.wopiPendingApp,u=n.officeDocumentSession,a=n.wacBootDiagnostics;if(Sn=e,qn=r,Jn=u)Xn.resolve(Jn);else if(qn)Zn.resolve(qn);else{var l="No session found";Xn.reject(l),Zn.reject(l)}var d=sn(window,"message").pipe(An((function(n){return!!n.data&&!!n.origin&&n.origin.endsWith(_n)})),rn((function(n){return JSON.parse(n.data)})),An((function(n){return!(!n||!n.MessageId)})));if(!dn){var p=mn(i,o,u),S=p.documentRebootHandler,b=p.renameHandler,C=p.sessionRefreshInfoHandler,H=p.shareHandler,A=p.userAccessHandler,y=p.userActivityHandler,T=p.createNewHandler,U=p.getAuthTokenHandler,F=p.sendConversationIdHandler,P=p.closeTeamsConversationHandler,N=p.navigateBackToHostHandler,k=p.accessibilityLoopCompleteHandler,R=p.getClientUrlCompleteHandler,D=p.getWebUrlCompleteHandler,O=p.loadingStatusHandler,_=p.wopiInfoFromUrlHandler,W=p.davUrlFromIdsHandler,M=p.onCloseHandler,j=p.actionCompleteHandler,x=p.openInBrowserHandler,G=p.moveToFolderPickerHandler,L=p.commonFilePickerHandler,B=p.getCustomAuthConfigHandler,V=p.pushStateHandler,K=p.caaeMessageHandler,J=p.fileEmbedHandler;hn=[[Nn.Dm.PostMessage_SendConversationId,F],[Nn.Dm.PostMessage_CloseTeamsConversation,P],[Nn.Dm.PostMessage_NavigateBackToHost,N],[Nn.Dm.PostMessage_AccessibilityLoopComplete,k],[Nn.Dm.PostMessage_GetClientUrlComplete,R],[Nn.Dm.PostMessage_GetWebUrlComplete,D],[Nn.Dm.PostMessage_LoadingStatus,O],[Nn.E_.Event_DocumentReboot,S],[Nn.Dm.PostMessage_FileRenamed,b],[Nn.Dm.PostMessage_CheckUserAccess,A],[Nn.Dm.PostMessage_Share,H],[Nn.Dm.PostMessage_UserActivity,y],[Nn.Dm.PostMessage_AppCreateNewDocument,T],[Nn.Dm.PostMessage_OpenInBrowser,x],[Nn.E_.Event_MoveToFolder,G],[Nn.E_.Event_SharedFilePicker,L],[Nn.E_.Event_GetCustomAuthConfig,B],[Nn.Dm.PostMessage_CAAEMessage,K]],s.fileType===m.T.Excel&&(hn.push([Nn.E_.Event_GetWopiInfoFromUrl,_]),hn.push([Nn.E_.Event_GetDavUrlFromIds,W])),hn.forEach((function(n){var o=(0,t.CR)(n,2),i=o[0],r=o[1];e.RegisterEventHandler(i,r)})),Qn=d.subscribe((function(n){switch(n.MessageId){case Nn.Dm.PostMessage_AppRefreshSessionInfo:C(n.Values);break;case Nn.Dm.PostMessage_GetAuthToken:U(n.Values);break;case Nn.Dm.PostMessage_Close:M();break;case Nn.Dm.PostMessage_ActionComplete:j(n.Values);break;case Nn.Dm.PostMessage_AppPushState:V(n.Values);break;case Nn.Dm.PostMessage_FileEmbed:J()}}))}if(I){if(null==un||un.ULS.sendTraceTag(546182049,f.W.oo,v.G.Info,"BootApp: About to execute OnBootComplete"),(0,c.l5)(w.r_.OwlOnBootComplete),!g.qj.isOwlFrame){var q=(0,w.OV)((0,w.vY)("owl"));null==un||un.ULS.sendTraceTag(508568928,f.W.oo,v.G.Important,(0,g.T4)(s.fileType,h.wiseEnvironment,null==E?void 0:E.featureGates,null==E?void 0:E.uiHostName,null==E?void 0:E.uiHostIntegrationType,un)+", OwlTraditional Telemetry Data: "+JSON.stringify(q))}I(s,a)}}),(function(n){C&&(null==un||un.ULS.sendTraceTag(546182050,f.W.oo,v.G.Info,"BootApp: About to execute OnBootFailure"),C(n)),null==zn||zn.unsubscribe(),null==Qn||Qn.unsubscribe()})),{endSession:pn,sessionEndObservable:Yn.asObservable(),hostAccessibilityLoopComplete:function(n){return(0,En.R)(Nn.KX.PostMessage_HostAccessibilityLoopComplete,{Direction:n?"forward":"backward"},Un,Jn,un),!0},hostGetClientUrl:function(){(0,En.R)(Nn.KX.PostMessage_HostGetClientUrl,{},Un,Jn,un)},hostGetWebUrl:function(){(0,En.R)(Nn.KX.PostMessage_HostGetWebUrl,{},Un,Jn,un)},postFrameDiagnostics:function(n){(0,En.R)(Nn.KX.PostMessage_OwlFrameDiagnostics,{FrameDiagnostics:n},Un,Jn,un)},hostBackButtonPressed:function(){return(0,En.R)(Nn.KX.PostMessage_HostBackButtonPressed,{},Un,Jn,un),!0},hostSendConversationId:$n,postWacToken:function(n){var e=(0,c.a)(),t=(0,c.eR)();Bn.PostWacTokenAttempted=Vn.PostWacTokenAttempted=!0,null==cn||cn.recordKpiUsage(Wn,p.o.SuccessBased,Mn,void 0),null==un||un.ULS.sendTraceTag(507597022,f.W.oo,v.G.Important,"postWacToken flow initiated"),Promise.race([Xn,Zn]).then((function(o){o.run?(null==un||un.ULS.sendTraceTag(507597021,f.W.oo,v.G.Info,"officeDocSession created after ".concat((0,c.a)()-e," ms")),o.run(Z.O.postWacToken,{wacToken:n,postWacTokenStart:t}).then((function(n){return Vn.PostWacTokenResult=n.completion})).catch((function(n){Vn.PostWacTokenResult="Unexpected JSAPI V2 error",null==un||un.ULS.sendTraceTag(507852515,f.W.oo,v.G.Warning,"Caught error running postWacToken flow: ".concat(n))}))):o.PostWacToken?(null==un||un.ULS.sendTraceTag(507597020,f.W.oo,v.G.Info,"wopiPending created after ".concat((0,c.a)()-e," ms")),o.PostWacToken(n,t,Vn)):(Vn.PostWacTokenResult="Unexpected OWL error",null==un||un.ULS.sendTraceTag(507852514,f.W.oo,v.G.Warning,"postWacToken: WopiPending or OfficeDocumentSession is not defined. This should never happen, the catch callback should be hit instead."))})).catch((function(){Vn.PostWacTokenResult="Error occurred instantiating JSAPI session in OWL",null==un||un.ULS.sendTraceTag(507852513,f.W.oo,v.G.Warning,"Neither JSAPI v1 or v2 applications were created")}))},completeCreateNew:function(n){On.r.session?On.r.session.run(Z.O.completeCreateNew,n).then((function(n){return On.r.completeCreateNew(n)})).catch((function(n){un.ULS.sendTraceTag(507778315,f.W.oo,v.G.Warning,"Caught error running completeCreateNew flow: ".concat(n)),On.r.failCreateNew(n)})):(un.ULS.sendTraceTag(507778314,f.W.oo,v.G.Warning,"Attempting to run completeCreateNew flow without an OfficeDocumentSession."),On.r.failCreateNew(new Error("CreateNewUtils.session is undefined")))}}}var Jn,qn=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference"];function zn(n,e,t,o,i,r,u,a,s,l,c,d,f,v,h,p){var m=new b.zP(n,t,e,s,a,l).health;return null==m||m.addQosPillar("Open"),null==m||m.updatePartADimensions({applicationLcid:o,loggableUserId:i,tenantId:r,uiHost:c,uiHostIntegrationType:d,sessionOrigin:f}),null==m||m.addOrUpdatePartCDimension("HostCorrelationId",u),null==m||m.addOrUpdatePartCDimension("AppSessionId",n),null==m||m.addOrUpdatePartCDimension("HostRingId",null!=v?v:"n/a"),null==m||m.addOrUpdatePartCDimension("IsNewFile",(!!h).toString()),null==m||m.addOrUpdatePartCDimension("isOdcMigrated",(!!p).toString()),null==m||m.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),m}var Qn,Xn=null===(Jn=document.getElementById("owl"))||void 0===Jn?void 0:Jn.dataset,Zn="e03a13ee-9730-4cae-8525-47559c8cf18a",Yn="6a2a0a9e-6f11-4d59-b8a1-afd8bfd2401c";function $n(n,e,o,i,r){return(0,t.mG)(this,void 0,void 0,(function(){var u,a,s,l,d,p,m,w,g,S,b,I,C,H=this;return(0,t.Jh)(this,(function(A){switch(A.label){case 0:return[4,Promise.all([ie.instance(),n])];case 1:return u=t.CR.apply(void 0,[A.sent(),2]),a=u[0],s=u[1],l=null===e?(0,h.n)()[0]:e,d=(0,c.a)(),p=o?s.getAccountByUsername(o):null,m=(0,c.a)(),null==i||i.ULS.sendTraceTag(508053090,f.W.oo,v.G.Warning,"[OWL] Msal get user account from cache, take time: ".concat(m-d)),null!==p?[3,3]:[4,ee(s,l,o,i)];case 2:return(w=A.sent())?[2,w.accessToken]:[2,Promise.reject("SsoSilent login failed")];case 3:if(r)try{g=atob(r)}catch(n){return[2,Promise.reject("Failed to decode claims")]}return S={correlationId:e,account:p,scopes:["".concat(Zn,"/.default")],claims:g,enableRTExpiryCheck:!0},b=(0,c.a)(),I=s.acquireTokenSilent(S),C="",[4,I.then((function(n){if(n.fromCache)if(r){var e=(0,c.a)();null==i||i.ULS.sendTraceTag(508045138,f.W.oo,v.G.Warning,"[OWL] Msal get wac token silently with claims from cache succeed, take time: ".concat(e-b))}else{var t=(0,c.a)();null==i||i.ULS.sendTraceTag(508122775,f.W.oo,v.G.Warning,"[OWL] Msal get wac token silently from cache succeed, take time: ".concat(t-b))}else if(r){var o=(0,c.a)();null==i||i.ULS.sendTraceTag(508045137,f.W.oo,v.G.Warning,"[OWL] Msal get wac token silently with claim succeed, take time: ".concat(o-b))}else{var u=(0,c.a)();null==i||i.ULS.sendTraceTag(508155349,f.W.oo,v.G.Info,"[OWL] Msal get wac token silently succeed, take time: ".concat(u-b))}C=n.accessToken})).catch((function(n){return(0,t.mG)(H,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return Rn.Fh.FeatureGate_EcsHootGate&&n instanceof a.InteractionRequiredAuthError?[4,oe(s,S,i)]:[3,2];case 1:return e=t.sent(),C=e.accessToken,[3,3];case 2:null==i||i.ULS.sendTraceTag(508123353,f.W.oo,v.G.Warning,"[OWL] Msal failed to get wac token silently: error ".concat(n)),t.label=3;case 3:return[2]}}))}))}))];case 4:return A.sent(),[2,C]}}))}))}function ne(n,e){return(0,t.mG)(this,void 0,void 0,(function(){var o,i,r=this;return(0,t.Jh)(this,(function(u){switch(u.label){case 0:return[4,ie.instance()];case 1:return o=u.sent(),i=function(n){var e,t;return{appIds:[Yn],authority:null!==(e=g.yB||(null==Xn?void 0:Xn.authority))&&void 0!==e?e:"",authorityType:n.isMsa?"msa":"aad",upn:null!==(t=n.loginHint||n.upn)&&void 0!==t?t:"string"==typeof n.customAuthConfigValue?JSON.parse(n.customAuthConfigValue).login_Hint:""}}(n),[2,new Promise((function(n){return(0,t.mG)(r,void 0,void 0,(function(){var r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return i.authority&&(i.authority=i.authority.replace(Qn.ProdLegacy,Qn.Prod)),"msa"===i.authorityType.toLowerCase()?i.authority=Qn.Prod+Qn.MsaSuffix:(i.authority||(i.authority=Qn.Prod+Qn.AadSuffix),i.authority.indexOf(Qn.AadSuffix)<0&&("/"===i.authority.charAt(i.authority.length-1)?i.authority+=Qn.AadSuffix:i.authority+="/"+Qn.AadSuffix)),r={auth:{authority:i.authority,clientId:Yn,redirectUri:"/suite/OAuth.html",clientCapabilities:["CP1"]},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},u={disabled:!1,samplingPercentage:1},a=new o.PublicClientApplication(r,u),s=(0,c.a)(),[4,a.initialize()];case 1:return t.sent(),l=(0,c.a)(),null==e||e.ULS.sendTraceTag(508143306,f.W.oo,v.G.Info,"[OWL] Msal init time: ".concat(l-s)),n(a),[2]}}))}))}))]}}))}))}function ee(n,e,o,i){return(0,t.mG)(this,void 0,void 0,(function(){var r,u,a,s,l,d;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,ie.instance()];case 1:r=t.sent(),u={loginHint:o,correlationId:e,scopes:["".concat(Zn,"/.default")]},t.label=2;case 2:return t.trys.push([2,4,,7]),a=(0,c.a)(),[4,n.ssoSilent(u)];case 3:return(s=t.sent())&&(l=(0,c.a)(),null==i||i.ULS.sendTraceTag(508143305,f.W.oo,v.G.Info,"[OWL] Msal ssoSilent succeed, take time: ".concat(a-l))),[2,s];case 4:return d=t.sent(),Rn.Fh.FeatureGate_EcsHootGate&&d instanceof r.InteractionRequiredAuthError?[4,te(n,u,i)]:[3,6];case 5:return[2,t.sent()];case 6:return null==i||i.ULS.sendTraceTag(508143303,f.W.oo,v.G.Warning,"[OWL] Msal ssoSilent failed, error: ".concat(d)),[2,Promise.reject(d)];case 7:return[2]}}))}))}function te(n,e,o,i){return void 0===i&&(i=2),(0,t.mG)(this,void 0,void 0,(function(){var r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,6]),r=(0,c.a)(),[4,n.loginPopup(e)];case 1:return(u=t.sent())&&(a=(0,c.a)(),null==o||o.ULS.sendTraceTag(508123352,f.W.oo,v.G.Info,"[OWL] Msal loginPopup succeed, take time: ".concat(a-r))),[2,u];case 2:return s=t.sent(),[4,ie.instance()];case 3:return l=t.sent(),s instanceof l.BrowserAuthError&&s.errorCode===l.BrowserAuthErrorCodes.popupWindowError&&document.getElementById("authenticationButton")?[4,te(n,e,o,i-1)]:[3,5];case 4:t.sent(),t.label=5;case 5:return null==o||o.ULS.sendTraceTag(508123351,f.W.oo,v.G.Warning,"[OWL] Msal loginPopup failed"),[2,Promise.reject(s)];case 6:return[2]}}))}))}function oe(n,e,o,i){return void 0===i&&(i=2),(0,t.mG)(this,void 0,void 0,(function(){var r=this;return(0,t.Jh)(this,(function(u){return[2,new Promise((function(u){return(0,t.mG)(r,void 0,void 0,(function(){var r,a,s,l,d;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,6]),r=(0,c.a)(),[4,n.acquireTokenPopup(e)];case 1:return(a=t.sent())&&(s=(0,c.a)(),null==o||o.ULS.sendTraceTag(508123355,f.W.oo,v.G.Info,"[OWL] Msal get wac token through popup succeed, take time: ".concat(s-r)),u(a)),[3,6];case 2:return l=t.sent(),[4,ie.instance()];case 3:return d=t.sent(),l instanceof d.BrowserAuthError&&l.errorCode===d.BrowserAuthErrorCodes.popupWindowError&&i>0&&document.getElementById("authenticationButton")?[4,oe(n,e,o,i-1)]:[3,5];case 4:t.sent(),t.label=5;case 5:return null==o||o.ULS.sendTraceTag(508123354,f.W.oo,v.G.Warning,"[OWL] Msal failed to get wac token through popup: error ".concat(l)),[3,6];case 6:return[2]}}))}))}))]}))}))}!function(n){n.Prod="https://login.microsoftonline.com/",n.ProdLegacy="https://login.windows.net/",n.Ppe="https://login.windows-ppe.net/",n.AadSuffix="organizations",n.MsaSuffix="consumers"}(Qn||(Qn={}));var ie=function(){function n(){}return n.instance=function(){return(0,t.mG)(this,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return this.st?[3,2]:(n=this,[4,u.e(2468).then(u.bind(u,1506))]);case 1:n.st=e.sent(),e.label=2;case 2:return[2,this.st]}}))}))},n}(),re=u(4688),ue="WacDataCenter";function ae(n){switch(n){case m.T.Word:case m.T.PowerPoint:case m.T.Excel:case m.T.OneNote:case m.T.Visio:return"".concat(n.toString()).concat(ue);default:return}}function se(n){var e,t=ae(n),o=t?null===localStorage||void 0===localStorage?void 0:localStorage.getItem(t):void 0;return null!==(e=null!=o?o:null===localStorage||void 0===localStorage?void 0:localStorage.getItem(ue))&&void 0!==e?e:void 0}function le(n,e){if(e){null===localStorage||void 0===localStorage||localStorage.setItem(ue,e);var t=ae(n);t&&(null===localStorage||void 0===localStorage||localStorage.setItem(t,e))}}var ce,de,fe,ve=u(7571),he=u(8334),pe=u(4382),me=u(1622),we=u(2531);function ge(n,e,o,i,r){var u=this;void 0===o&&(o=!1),kn.c.driveItemStartTime=(0,c.a)(),(0,c.l5)("driveItemStartTime"),ce||(ce=new Map);var a=ce.get(n);if(!o&&a&&a.promise&&(!a.expiryTime||a.expiryTime>new Date))return kn.c.driveItemEndTime=(0,c.a)(),(0,c.l5)("driveItemEndTime"),null==i||i.ULS.sendTraceTag(553726288,f.W.oo,v.G.Info,"GetDriveItem: Returning drive item from the cache"),a.promise;null==i||i.ULS.sendTraceTag(553726289,f.W.oo,v.G.Info,"GetDriveItem: Invalidating the cache"),ce.delete(n),null==i||i.ULS.sendTraceTag(546182045,f.W.oo,v.G.Info,"GetDriveItem: About to make the fetch call to get drive item");var s=n,l={method:me.hx.Get,headers:e.headers};if((0,Rn.dt)(Rn.Fh.FeatureGate_BypassOPTIONSCall,r,i),r){s=n.concat("&ump=1");var d=function(n){var e=(0,we.c)(),o=[];return o.push("--".concat(e)),void 0!==n&&Object.entries(n).forEach((function(n){var e=(0,t.CR)(n,2),i=e[0],r=e[1];void 0!==r&&o.push("".concat(i,": ").concat(r))})),o.push("X-HTTP-Method-Override: GET"),o.push("\r\n--".concat(e,"--")),{body:o.join("\r\n"),headers:{"Content-Type":"multipart/form-data;boundary=".concat(e)}}}(e.headers),h=d.body,p=d.headers;l={method:me.hx.Post,headers:p,body:h},null==i||i.ULS.sendTraceTag(508961629,f.W.oo,v.G.Info,"GetDriveItem: POST request to get drive item: content-length : ".concat(h.length))}var m=fetch(s,l).catch((function(n){return Promise.reject({api:"getItem",failure:n,message:"Fetch call failed",retry:!0})})).then((function(e){return(0,t.mG)(u,void 0,void 0,(function(){var o,r,u,a,s,l,c,d,h,p;return(0,t.Jh)(this,(function(w){switch(w.label){case 0:if(200===e.status)return o=e.json().then((function(n){return n||Promise.reject({api:"getItem",status:e.status,message:"Ok httpStatus, invalid response"})})),r=new Map,a=null===(s=null==e?void 0:e.headers)||void 0===s?void 0:s.get("SPRequestGuid"),kn.c.spRequestGuid=null!=a?a:void 0,r.set("SPRequestGuid",a),null==i||i.ULS.sendTraceTag(554964099,f.W.oo,v.G.Info,"GetDriveItem:  [VroomResponseHeaders: ".concat(JSON.stringify(r),"]")),ce.set(n,{promise:m,expiryTime:(g=new Date,new Date(g.getFullYear(),g.getMonth(),g.getDate(),g.getHours()+24,g.getMinutes(),g.getSeconds(),g.getMilliseconds()))}),[2,o];w.label=1;case 1:return w.trys.push([1,3,,4]),[4,e.json()];case 2:return u=w.sent(),a=null===(l=null==e?void 0:e.headers)||void 0===l?void 0:l.get("SPRequestGuid"),kn.c.spRequestGuid=null!=a?a:void 0,[2,Promise.reject((0,t.pi)((0,t.pi)({api:"getItem",SPRequestGuid:a,status:e.status,errorCode:null===(c=null==u?void 0:u.error)||void 0===c?void 0:c.code,innerErrorCode:null===(h=null===(d=null==u?void 0:u.error)||void 0===d?void 0:d.innerError)||void 0===h?void 0:h.code,message:null===(p=null==u?void 0:u.error)||void 0===p?void 0:p.message,redirectLocation:(null==u?void 0:u.error)?null==u?void 0:u.error["@error.redirectLocation"]:void 0},Se(e)),{retry:429===e.status||e.status>=500}))];case 3:return w.sent(),[2,Promise.reject({api:"getItem",status:e.status,message:"request failed, could not retrieve error object."})];case 4:return[2]}var g}))}))})).finally((function(){kn.c.driveItemEndTime=(0,c.a)(),(0,c.l5)("driveItemEndTime")}));return m}function Se(n){var e,o,i,r=null===(i=null==n?void 0:n.headers)||void 0===i?void 0:i.get("www-authenticate"),u=void 0,a=void 0;if(r){var s=r.split(",");if(s)try{for(var l=(0,t.XA)(s),c=l.next();!c.done;c=l.next()){var d=c.value,f=d&&d.trim();f&&f.startsWith("error=")?u=f.split('"')[1]:f&&f.startsWith("claims=")&&(a=[f.split('"')[1]])}}catch(n){e={error:n}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(e)throw e.error}}}return{claimsError:u,claims:a}}var be="getItemFromWac",Ie="x-behind-service-response-status",Ce="GetDriveItem",He=new Map,Ae="owlfc";function ye(n,e,o){return(0,t.mG)(this,void 0,void 0,(function(){var i;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:de=(0,c.a)(),He.set("StartTime",de.toString()),o||null==e||e.ULS.sendTraceTag(526951836,f.W.oo,v.G.Info,"GetDriveItem: Health object not initialized"),null==o||o.recordKpiUsage(Ce,p.o.FailureBased,Ae,He),He.delete("StartTime"),kn.c.driveItemFromWacStartTime=(0,c.a)(),(0,c.l5)("driveItemFromWacStartTime"),t.label=1;case 1:return t.trys.push([1,3,4,5]),null==e||e.ULS.sendTraceTag(523867683,f.W.oo,v.G.Info,"GetDriveItem: About to make the fetch call to get drive item"),[4,fetch(n.url,{method:n.method,headers:n.headers,body:JSON.stringify(n.body)})];case 2:return[2,Te(t.sent(),e,o)];case 3:return i=t.sent(),fe=(0,c.a)(),He.set("DriveItemError",JSON.stringify(i)),He.set("FailureTime",fe.toString()),null==o||o.recordKpiFailure(Ce,"GetDriveItemFromHootFailed",!1,!1,{durationMs:fe-de,extendedProperties:He}),[2,Promise.reject({api:be,failure:i,message:"Failed to post request to Hoot"})];case 4:return kn.c.driveItemFromWacEndTime=(0,c.a)(),(0,c.l5)("driveItemFromWacEndTime"),[7];case 5:return[2]}}))}))}function Te(n,e,o){var i,r,u;return(0,t.mG)(this,void 0,void 0,(function(){var a,s;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(n.status===pe.W.OK)return[2,Ue(n,e)];fe=(0,c.a)(),He.set("FailureTime",fe.toString()),null==o||o.recordKpiFailure(Ce,"WacHootServiceNotAvailable",!1,!0,{durationMs:fe-de,extendedProperties:He}),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.json()];case 2:return a=t.sent(),s=null===(i=null==n?void 0:n.headers)||void 0===i?void 0:i.get("SPRequestGuid"),kn.c.spRequestGuid=null!=s?s:void 0,[2,Promise.reject({api:be,SPRequestGuid:s,status:n.status,errorCode:null===(r=null==a?void 0:a.error)||void 0===r?void 0:r.code,message:null===(u=null==a?void 0:a.error)||void 0===u?void 0:u.message})];case 3:return t.sent(),[2,Promise.reject({api:be,status:n.status,message:"Request to Hoot failed, could not reach out Hoot for retrieving object."})];case 4:return[2]}}))}))}function Ue(n,e){var o,i,r=null===(o=null==n?void 0:n.headers)||void 0===o?void 0:o.get(Ie),u=r?parseInt(r,10):pe.W.InternalServiceError,a=new Map,s=null===(i=null==n?void 0:n.headers)||void 0===i?void 0:i.get("SPRequestGuid");return kn.c.spRequestGuid=null!=s?s:void 0,a.set("SPRequestGuid",s),null==e||e.ULS.sendTraceTag(526951837,f.W.oo,v.G.Info,"GetDriveItemFromWac: [VroomResponseHeaders: ".concat(JSON.stringify(a),"]. The http response status code from downstream service to Hoot: ").concat(u.toString())),u===pe.W.OK?n.json().then((function(e){return e?function(n){var e,t,o,i,r,u,a,s;return kn.c.hootRequestToWacServiceStart=null===(e=n.perfMarkers)||void 0===e?void 0:e.requestToWacServiceStart,kn.c.hootTokenValidationStart=null===(t=n.perfMarkers)||void 0===t?void 0:t.hootTokenValidationStart,kn.c.hootTokenValidationEnd=null===(o=n.perfMarkers)||void 0===o?void 0:o.hootTokenValidationEnd,kn.c.hootPopGenerationStart=null===(i=n.perfMarkers)||void 0===i?void 0:i.hootPopGenerationStart,kn.c.hootPopGenerationEnd=null===(r=n.perfMarkers)||void 0===r?void 0:r.hootPopGenerationEnd,kn.c.hootVroomCallStart=null===(u=n.perfMarkers)||void 0===u?void 0:u.hootVroomCallStart,kn.c.hootVroomCallEnd=null===(a=n.perfMarkers)||void 0===a?void 0:a.vroomCallEnd,kn.c.hootResponseToClientComplete=null===(s=n.perfMarkers)||void 0===s?void 0:s.hootResponseToClientComplete,n}(e):Promise.reject({api:be,SPRequestGuid:s,status:n.status,message:"Ok httpStatus, invalid response"})})):Promise.reject((0,t.pi)({api:be,SPRequestGuid:s,status:n.status,sharePointCallStatus:u,message:"Post request to Hoot succeed, Hoot failed to retrieve object from downstream service."},Se(n)))}var Fe="Failed to parse stringified drive item.";function Pe(n,e,o,i,r){var u,a={Authorization:null!==(u=Ne(r).Authorization)&&void 0!==u?u:"",SessionId:i},s=(0,t.pi)((0,t.pi)({},e),{optionsHttpRequestHeaders:a});return{url:o,method:me.hx.Post,headers:n,body:s}}function Ee(n,e){try{return JSON.parse(n.graphDriveItem)}catch(n){return null==e||e.ULS.sendTraceTag(508155346,f.W.oo,v.G.Error,"Failed to parse Vroom response from JSON string. [".concat(n.name,": ").concat(n.message,"]")),null}}function Ne(n,e){var t=null!=e?e:{};return n?(t.Authorization="Bearer ".concat(n).trim(),t):t}var ke=u(3140);function Re(n,e,o,i,r,u,a,s){return void 0===r&&(r=!1),void 0===s&&(s=ke.wU),(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return n?[2,e(o,r,i,void 0,!0).then(s).then((function(e){return ge(n,{headers:e},r,u,a)})).catch((function(t){return null==u||u.ULS.sendTraceTag(512255580,f.W.oo,v.G.Warning,"GetDriveItemWithUrl: error when trying to getDriveItem: ".concat(t)),t&&401===t.status&&"insufficient_claims"===t.claimsError&&"authChallengeRequired"===t.innerErrorCode&&t.claims?(null==u||u.ULS.sendTraceTag(523076960,f.W.oo,v.G.Warning,"GetDriveItemWithUrl: vroom call failed with claims challenge. Retry with claims"),e(o,r,i,void 0,!0,t.claims).then(s).then((function(e){return ge(n,{headers:e},r,u,a)}))):Promise.reject(t)}))]:[2,Promise.reject("No api endpoint given")]}))}))}function De(n){var e={accept:"application/json",prefer:"redeemSharingLink,allow-zerobyte,manualRedirect"};return(0,ke.sm)(n,e),e}var Oe,_e=function(n){return n?"expand=thumbnails":""};function We(n,e,o,i,r,u,a,s,l,c){void 0===i&&(i=!1),void 0===r&&(r="open"),void 0===u&&(u=!1);var d=o.inMockMode,h=o.getAccessToken,p=c?n:function(n,e){try{null==e||e.ULS.sendTraceTag(541870043,f.W.oo,v.G.Info,"getSharesUrl: Start constructing shares Url");for(var t=n.replace(/[,@+$#]/g,(function(n){return encodeURIComponent(n)})),o=window.btoa((u=encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(n,e){return String.fromCharCode(parseInt(e,16))})),a=void 0,(a=u)&&(a=a.replace(/#/g,"%23")),a)),i=o.length-1;"="===o.charAt(i);)--i;var r=o.slice(0,i+1).replace(/\+/g,"-").replace(/\//g,"_");return"shares/u!".concat(r,"/driveItem")}catch(n){return void(null==e||e.ULS.sendTraceTag(541872152,f.W.oo,v.G.Error,"getSharesUrl: Failed to get Share Url. ".concat(n)))}var u,a}(n,a);if(!p)return Promise.reject("No shareUrl");var m=(0,ke.yA)(n,o,a);if(!m)return Promise.reject("No apiInfo");var w=new Date;w.setSeconds(0,0);var g=(0,t.ev)([(0,ke.G3)(e),(0,ke.n5)(r),_e(u)],(0,t.CR)((0,ke.YM)(s)),!1).filter((function(n){return!!n})).join("&"),S=d?"shares?itemUrl=".concat(encodeURIComponent(p),"&currentDate=").concat(w.toISOString()):"".concat(p,"?").concat(g);return Re("".concat(m.baseUrl,"/").concat(S),h,m.tokenType,m.resourceUrl,i,a,l,De)}function Me(n,e,o,i,r,u,a,s,l){var c;void 0===i&&(i=!1),void 0===r&&(r="open");var h=n.driveId,p=n.docId,m=n.baseUrl,w=n.docUrl;if(!h||!p)return Promise.reject("Not enough document information was given to retrieve the item");var g,S,b=(0,t.ev)([(0,ke.G3)(e),(0,ke.n5)(r)],(0,t.CR)((0,ke.YM)(s)),!1).filter((function(n){return!!n})).join("&"),I=function(n){if(!n)return null;var e=new URL(n);return e.protocol+"//"+e.host}(null!=m?m:w);I?(S=I,g="".concat(m||I,"/_api/v2.0"),null==a||a.ULS.sendTraceTag(543958855,f.W.oo,v.G.Info,"making vroom service call with driveId+docId")):(S=(0,d.A8)(u),g="".concat(S,"/v1.0"),null==a||a.ULS.sendTraceTag(543958856,f.W.oo,v.G.Info,"making graph service call with driveId+docId"));var C="".concat(g,"/drives/").concat(encodeURIComponent(h),"/items/").concat(encodeURIComponent(p),"/?").concat(b),H=null!==(c=(0,ke.gG)(S))&&void 0!==c?c:"None";return Re(C,o.getAccessToken,H,S,i,a,l)}function je(n){var e={accept:"application/json",prefer:"allow-zerobyte,manualRedirect"};return(0,ke.sm)(n,e),e}function xe(n,e,o,i,r,u,a,s,l,c){var d;if(void 0===r&&(r=!1),void 0===u&&(u="open"),!n||!e)return Promise.reject("Not enough document information was given to retrieve the item");var f=new URL(e),v="".concat(f.protocol,"//").concat(f.host);if((0,Rn.dt)(Rn.Fh.FeatureGate_Vroom21SupportGate,l,a),kn.c.isVroom21=l,l){var h=o.indexOf("openWith");-1!==h&&(o[h]="openwith($select=wac)")}var p,m=(0,t.ev)([(0,ke.G3)(o),(0,ke.n5)(u)],(0,t.CR)((0,ke.YM)(s)),!1).filter((function(n){return!!n})).join("&");p=l?"".concat(e,"/_api/v2.1/sites/root/items/").concat(encodeURIComponent(n),"/driveItem?").concat(m):"".concat(e,"/_api/v2.0/sites/root/items/").concat(encodeURIComponent(n),"/driveItem?").concat(m);var w=null!==(d=(0,ke.gG)(e))&&void 0!==d?d:"None";return Re(p,i.getAccessToken,w,v,r,a,c,je)}var Ge,Le,Be,Ve,Ke,Je,qe,ze,Qe,Xe,Ze,Ye,$e,nt,et,tt,ot="getItemFromWac";function it(n,e,o,i){var r={Authorization:(0,ke.sm)(i).Authorization,SessionId:o},u=(0,t.pi)((0,t.pi)({},e),{optionsHttpRequestHeaders:r});return{url:Oe,method:me.hx.Post,headers:n,body:u}}function rt(n,e){if(n&&n.KMSI){var t={token:e,expiryTime:n.wacTokenExpTime};null===x.X||void 0===x.X||x.X.setItem(Zn,JSON.stringify(t))}}function ut(n,e){if(n)try{return JSON.parse(n.graphDriveItem)}catch(n){null==e||e.ULS.sendTraceTag(520439698,f.W.oo,v.G.Error,"GetDriveItemFromWacWithUrl: Failed to parse vroom response from string to JSON. [Error: ".concat(JSON.stringify(n),"]"))}return Promise.reject({api:ot,message:"Failed to parse response data from string to JSON due to invalid data or format"})}var at,st=!1,lt=!1,ct=kn.NF.SharePointOnline,dt="owl-container",ft="PrebootDocumentOpen",vt="owlfc";function ht(n){var e,t,o;if(!(null===(e=null==n?void 0:n.clientVersion)||void 0===e?void 0:e.trim()))throw new Error("invalid clientVersion");if(!n.exposure||n.exposure<=0||n.exposure>100)throw new Error("invalid exposure ("+(null!==(t=n.exposure)&&void 0!==t?t:"undefined")+")");n.wiseEnvironment=null===(o=n.wiseEnvironment)||void 0===o?void 0:o.toLocaleUpperCase(),Ge=n}function pt(n){var e;return null!==(e=document.getElementById(dt))&&void 0!==e?e:St(n,dt)}function mt(){if(Ge)return Ge.clientVersion;null==Xe||Xe.ULS.sendTraceTag(508060617,f.W.oo,v.G.Error,"You must call initPackage before calling getOwlVersion")}function wt(n){switch(n){case"Graph":return(0,d.A8)(et);case"OneDrive":return(0,d.Y6)();case"SharePoint":return(0,d.tf)();default:return""}}function gt(n){var e;if(n){var t;try{t=new URL(n)}catch(n){return}return null!==(e=new URLSearchParams(t.search).get("nav"))&&void 0!==e?e:void 0}}function St(n,e){var t=document.createElement("div");return t.id=e,n.appendChild(t)}function bt(n){return Le?Le(n):Promise.reject("endSession not defined")}function It(n){return Be?Be(n):(null==Xe||Xe.ULS.sendTraceTag(555872272,f.W.oo,v.G.Error,"hostAccessibilityLoopComplete no defined"),!1)}function Ct(){return Je?Je():(null==Xe||Xe.ULS.sendTraceTag(508127040,f.W.oo,v.G.Error,"hostBackButtonPressed no defined"),!1)}function Ht(){if(Ve)return null==Xe||Xe.ULS.sendTraceTag(508355844,f.W.oo,v.G.Info,"Trying to get hostGetClientUrl."),void Ve();null==Xe||Xe.ULS.sendTraceTag(526152082,f.W.oo,v.G.Error,"hostGetClientUrl not defined")}function At(){if(Ke)return null==Xe||Xe.ULS.sendTraceTag(508352272,f.W.oo,v.G.Info,"Trying to get WebUrl"),void Ke();null==Xe||Xe.ULS.sendTraceTag(508352271,f.W.oo,v.G.Error,"hostGetWebUrl not defined")}function yt(n){ze?ze(n):null==Xe||Xe.ULS.sendTraceTag(507778320,f.W.oo,v.G.Error,"createNewComplete is not defined")}function Tt(n){var e,r,a,s,C=this,H=(0,c.a)();S(),(0,c.l5)([w.r_.OwlStart,"packageEntryTime"]);var A=n.documentIdentifier,y=n.sessionConfig,T=n.uiHostConfig,U=n.getAuthToken,F=n.eventHandlers,P=n.container;et=null!==(e=null==Ge?void 0:Ge.wiseEnvironment)&&void 0!==e?e:y.wiseEnvironment;var E=(0,t.pi)((0,t.pi)({},A),{fileType:y.fileType,wdOrigin:null!==(r=y.sessionOrigin)&&void 0!==r?r:"TEAMS.UNIFIEDUIHOST.OPEN",wdValue:y.wdValue,uiCulture:y.uiCulture,dataCulture:y.dataCulture,puid:y.puid,clickTime:y.clickTime,isNewFile:y.isNewFile,isTwoStepCreateNew:y.isTwoStepCreateNew,navId:gt(null!==(a=A.shareUrl)&&void 0!==a?a:A.docUrl),templateId:A.templateId,intent:null!==(s=y.intent)&&void 0!==s?s:"open"}),N=q(E),k=y.sessionId||N||(0,h.n)()[0];y.bootDiagnostics=y.bootDiagnostics||{};var R=y.bootDiagnostics.ringId;y.bootDiagnostics.packageEntryTime=y.bootDiagnostics.packageEntryTime||H,Xe=new b.G2(k,et).logger,y.logger=Xe;var _=k===N,W=null==y?void 0:y.isNewFile;if(y.bootDiagnostics.isPrebooted=_,function(n,e,t,o,i,r){var u,a,s,l,c=n.wiseEnvironment;n.health=null!==(u=n.health)&&void 0!==u?u:zn(e,c,n.fileType,n.uiCulture,n.puid,n.tenantId,n.hostCorrelationId,null==r?void 0:r.exposure,null==r?void 0:r.clientVersion,n.isSynthetic,t.uiHostName,t.uiHostIntegrationType,n.sessionOrigin,o,i),n.hostClientType&&(null===(a=n.health)||void 0===a||a.addOrUpdatePartCDimension("HostClientType",n.hostClientType)),n.teamType&&(null===(s=n.health)||void 0===s||s.addOrUpdatePartCDimension("TeamType",n.teamType)),n.isPopOut&&(null===(l=n.health)||void 0===l||l.addOrUpdatePartCDimension("IsPopOut",(!!n.isPopOut).toString()))}(y,k,T,R,W,Ge),Ze=y.health,g.qj.checkOwlFrameCookie(et,T.featureGates),g.qj.isOwlFrameBootEnabled(T.featureGates,Xe)&&(function(n,e,i,r,u){return(0,t.mG)(this,void 0,void 0,(function(){var r,a,s,f;return(0,t.Jh)(this,(function(t){return r=function(n){return new URL((0,d.wl)(n)).origin}(n),(a=document.createElement("iframe")).src="".concat(r).concat(g.$$).concat(window.location.search?window.location.search+"&":"?","filetype=").concat(e,"&hostorigin=").concat(encodeURIComponent(window.location.origin),"&env=").concat(n).concat(u?"&corrid=".concat(u,"&usid=").concat(u):""),a.id=Mt,a.allowFullscreen=!0,a.allow="microphone ".concat(r,"; autoplay ").concat(r,"; camera ").concat(r,"; clipboard-read ").concat(r,"; clipboard-write ").concat(r,"; keyboard-map ").concat(r,"; display-capture ").concat(r),a.setAttribute("style","inset: 0px; height: ".concat("100%","; width: ").concat("100%","; display: block; position: absolute; background-color: transparent; border: none; visibility: ").concat("visible",";")),i.appendChild(a),s=new Promise((function(n){a.contentWindow&&(Rt=new l(a.contentWindow,r),_t=new kt(Rt,o.EndSessionResponse),Rt.registerHandler(o.FrameLoaded,(function(e){(0,c.l5)(w.r_.OwlLoadedMessageReceive),n(e.data.success?{status:Nt.Success}:{status:Nt.Error,error:e.data.error})})))})),f=new Promise((function(n){return setTimeout((function(){return n({status:Nt.Timeout,error:"Timed out waiting for OWL frame to load after ".concat(jt," ms.")})}),jt)})),[2,Promise.race([s,f])]}))}))}(et,y.fileType,P,0,k).then((function(e){e.status===Nt.Success?(n.sessionConfig.initPackageParams=Ge,(0,c.l5)(w.r_.OwlBootAppMessageSend),null==Rt||Rt.sendMessage({id:i.BootApplication,data:I(n)}),null==Xe||Xe.ULS.sendTraceTag(508432458,f.W.oo,v.G.Info,"CreateOwlFrame: Succeeded and now booting document")):(null==Ze||Ze.recordQosError(kn.DG.QosError_OwlFrameCreationFailure,[kn.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Xe||Xe.ULS.sendTraceTag(508432456,f.W.oo,v.G.Error,"CreateOwlFrame: Failed to create frame"))})).catch((function(n){null==Ze||Ze.recordQosError(kn.DG.QosError_OwlFrameCreationFailure,[kn.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(n)]])}),null==Xe||Xe.ULS.sendTraceTag(508432455,f.W.oo,v.G.Error,"CreateOwlFrame: Exception: ".concat(n))})),g.qj.isOwlFrameBootEnabled(T.featureGates,Xe))){var M=function(n,e){var r=this;return null==Rt||Rt.registerHandler(o.GetAuthToken,(function(e){return(0,t.mG)(r,void 0,void 0,(function(){var o,r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),u=e.data,a=u.resourceUrl,s=u.claims,[4,n.getAuthToken(a,s)];case 1:return o=t.sent(),[3,4];case 2:return l=t.sent(),r=l,[3,4];case 3:return null==Rt||Rt.sendMessage({id:i.GetAuthTokenResponse,data:{token:o,error:r,correlationId:e.correlationId}}),[7];case 4:return[2]}}))}))})),function(n,e,t,r,u){var a=n.onBootComplete,s=n.onBootFailure,l=n.onSuccessNotification,c=n.onReturnFocus,d=n.onConversationClose,f=n.onNavigateBack,v=n.onOpenPageLevelConversation,h=n.onDocumentClose,p=n.onOpenInMobileApp,m=new O.xQ;return null==Rt||Rt.registerHandler(o.EndSessionObservable,(function(n){m.next(n.data.rebootInfo),m.complete()})),null==Rt||Rt.registerHandler(o.BootComplete,(function(n){var e=n.data,t=e.docInfo,o=e.wacBootDiagnostics;null==a||a(t,o)})),null==Rt||Rt.registerHandler(o.BootFailure,(function(n){return null==s?void 0:s(n.data.errorInfo,n.data.docInfo)})),null==Rt||Rt.registerHandler(o.ReturnFocus,(function(n){return null==c?void 0:c(n.data.navigateForward)})),null==Rt||Rt.registerHandler(o.ConversationClose,(function(n){return null==d?void 0:d()})),null==Rt||Rt.registerHandler(o.NavigateBack,(function(n){return null==f?void 0:f()})),null==Rt||Rt.registerHandler(o.OpenPageLevelConversation,(function(n){return null==v?void 0:v(n.data.conversationId,n.data.pageUrl,n.data.hostSendConversationId)})),null==Rt||Rt.registerHandler(o.SuccessNotification,(function(n){return null==l?void 0:l()})),null==Rt||Rt.registerHandler(o.DocumentClose,(function(n){return null==h?void 0:h()})),null==Rt||Rt.registerHandler(o.OpenInMobileApp,(function(n){var e;return null==p?void 0:p(n.data.openInAppUrl,null!==(e=n.data.storeUrl)&&void 0!==e?e:"")})),null==Rt||Rt.registerHandler(o.EndSessionResponse,(function(n){_t.getHandler(o.EndSessionResponse,D.Result)(n),xt()})),null==Rt||Rt.registerHandler(o.TelemetryData,(function(n){!function(n,e,t,o,r){var u=(0,w.ME)(),a=u.bootTelemetryData,s=u.owlTelemetryData;null==Rt||Rt.sendMessage({id:i.TelemetryData,data:{context:(0,g.T4)(e,t,null==o?void 0:o.featureGates,null==o?void 0:o.uiHostName,null==o?void 0:o.uiHostIntegrationType,r),hostData:{bootTelemetryData:a,owlTelemetryData:s},frameData:n}})}(n.data,e.fileType,t,r,u)})),m.asObservable()}(n.eventHandlers,e,n.sessionConfig.wiseEnvironment,n.uiHostConfig,n.sessionConfig.logger)}(n,E),j={endSession:function(n){return _t.getMessagePromise(o.EndSessionResponse,{id:i.EndSession,data:{rebootInfo:n}})},hostAccessibilityLoopComplete:function(n){return null==Rt||Rt.sendMessage({id:i.HostAccessibilityLoopComplete,data:{navigateForward:n}}),!0},hostGetClientUrl:function(){null==Rt||Rt.sendMessage({id:i.GetClientUrl,data:{}})},hostGetWebUrl:function(){null==Rt||Rt.sendMessage({id:i.GetWebUrl,data:{}})},hostBackButtonPressed:function(){return null==Rt||Rt.sendMessage({id:i.BackButtonPressed,data:{}}),!0},hostSendConversationId:function(n){null==Rt||Rt.sendMessage({id:i.SendConversationId,data:{conversationId:n}})},postWacToken:function(n){null==Rt||Rt.sendMessage({id:i.PostWacToken,data:{wacToken:n}})},completeCreateNew:function(){}};return Le=j.endSession,Be=j.hostAccessibilityLoopComplete,Ve=j.hostGetClientUrl,Ke=j.hostGetWebUrl,Je=j.hostBackButtonPressed,qe=j.hostSendConversationId,ze=j.completeCreateNew,(0,t.pi)((0,t.pi)({},j),{sessionEndObservable:M})}if($e=(0,Rn.vJ)(Rn.Fh.FeatureGate_EcsHootGate,T.featureGates),g.qj.isOwlFrame&&$e&&!y.isAnonymous&&(y.loginHint||y.upn)&&(at||(at=ne(y,Xe))),Ge||(Ge=y.initPackageParams),nt=function(n,e){switch(n){case m.T.PowerPoint:return(0,Rn.vJ)(Rn.Fh.FeatureGate_Vroom21SupportGate,e.featureGates);case m.T.Word:return(0,Rn.vJ)(Rn.Fh.FeatureGate_Vroom21ForWord,e.featureGates);case m.T.Excel:return(0,Rn.vJ)(Rn.Fh.FeatureGate_Vroom21ForExcel,e.featureGates);default:return!1}}(y.fileType,T),tt=(0,Rn.vJ)(Rn.Fh.FeatureGate_BypassOPTIONSCall,T.featureGates),st=(0,Rn.vJ)(Rn.Fh.FeatureGate_ManualRedirectOnTenantChangeGate,T.featureGates),lt=(0,Rn.vJ)(Rn.Fh.FeatureGate_UseRedirectUrlOnTenantChange,T.featureGates),_){var G=new Map;G.set("StartTime",(new Date).toUTCString()),z(E,k),null==Ze||Ze.recordKpiUsage(ft,p.o.FailureBased,vt,G)}if(Ye=pt(P),A.docUrl||A.driveId&&A.docId||A.shareUrl||A.baseUrl&&A.fileId){var L,B=Ft(U),V={correlationId:y.hostCorrelationId,officeHomeApiRoot:"",getAccessToken:B},K=(0,t.pi)((0,t.pi)({},y),{shareApiEndpoint:(0,d.PO)(et),metaUiHostVersion:re.J.version,logger:Xe,sessionId:k}),J={isESSEnabled:K.isESSEnabled,wacDataCenter:K.isESSEnabled?se(y.fileType):void 0,sessionId:K.sessionId,hostCorrelationId:K.hostCorrelationId};(0,Rn.dt)(Rn.Fh.FeatureGate_EcsHootGate,$e,Xe),$e&&g.qj.isOwlFrame?(null==Xe||Xe.ULS.sendTraceTag(520757324,f.W.oo,v.G.Info,"FetchItemFromWac: Hoot endpoint enabled in ECS, fetch driveItem from Wac"),L=Et(E)?Pt(V,et,J,nt,tt):function(n,e,o,i){return function(r,u,a,s){return void 0===u&&(u=!1),void 0===a&&(a=!1),null==s||s.ULS.sendTraceTag(526951838,f.W.oo,v.G.Info,"Item to be fetched through wac service"),function(n,e,o,i,r,u,a,s){var l=this,c={docBootInfo:o,essOptions:u,api:r};return Oe=(0,d.XQ)(i,e),function(n,e){return(0,t.mG)(this,void 0,void 0,(function(){var o,i;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(o=null===x.X||void 0===x.X?void 0:x.X.getItem(Zn))try{if((i=JSON.parse(o))&&i.token&&i.expiryTime&&parseInt(i.expiryTime,10)>(new Date).getTime()/1e3)return null==e||e.ULS.sendTraceTag(524821017,f.W.oo,v.G.Info,"GetDriveItemFromWacWithUrl: Fetched valid access token from the windows local storage cache"),[2,i.token];null===x.X||void 0===x.X||x.X.removeItem(Zn)}catch(n){null===x.X||void 0===x.X||x.X.removeItem(Zn)}return[4,n("None",!0,Zn,void 0,!0)];case 1:return[2,t.sent()]}}))}))}(n,a).then((function(o){var i={accept:"application/json"},r=it(i,c,e,o);return ye(r,a,s).then((function(n){return rt(n,o),ut(n,a)})).catch((function(u){return(0,t.mG)(l,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return null==a||a.ULS.sendTraceTag(526471961,f.W.oo,v.G.Error,"GetDriveItemFromWacWithUrl: Retrying getDriveItemFromWac. [Error: ".concat(JSON.stringify(u),"][FailureReason: ").concat(null==u?void 0:u.failure,"]")),u&&401===u.sharePointCallStatus&&"insufficient_claims"===u.claimsError&&u.claims?(null==a||a.ULS.sendTraceTag(512492100,f.W.oo,v.G.Warning,"GetDriveItemFromWacWithUrl: Wac call vroom failed with claims challenge. Retry with claims"),[2,n("None",!0,Zn,void 0,!0,u.claims).then((function(n){return ye(it(i,c,e,n),a,s).then((function(e){return rt(e,n),ut(e,a)}))}))]):[2,ye(r,a,s).then((function(n){return rt(n,o),ut(n,a)}))]}))}))}))}))}(n.getAccessToken,e,r,o,ct,i,s,Ze)}}(V,k,et,J)):(null==Xe||Xe.ULS.sendTraceTag(520757325,f.W.oo,v.G.Info,"FetchItemFromVroom: Hoot endpoint disabled in ECS, fetch driveItem from Vroom"),L=Pt(V,et,J,nt,tt)),g.qj.isOwlFrame&&$e&&!K.isAnonymous&&(K.loginHint||K.upn)&&(at||(at=ne(K,Xe)),Et(E)||(L=function(n,e,o,i){var r;void 0===e&&(e=!1),void 0===o&&(o=!1);var u={isESSEnabled:Q.sessionConfig.isESSEnabled,wacDataCenter:Q.sessionConfig.isESSEnabled?se(Q.documentBootInfo.fileType):void 0,sessionId:Q.sessionConfig.sessionId,hostCorrelationId:Q.sessionConfig.hostCorrelationId},a=null===(r=Q.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isOdcMigrated;return"boolean"!=typeof a||a||(ct=kn.NF.OneDriveConsumer),function(n,e,o,i,r,u,a,s,l){return(0,t.mG)(this,void 0,void 0,(function(){var c,h,p,m,w,g,S,b,I,C,H;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return c={docBootInfo:n,essOptions:e,api:r},h=(0,d.XQ)(i,u),[4,$n(o,u,a,s)];case 1:if(!(p=t.sent()))return[2,Promise.reject("Failed to fetch necessary Wac token.")];w=Pe(m={accept:"application/json"},c,h,u,p),t.label=2;case 2:return t.trys.push([2,4,,9]),[4,ye(w,s,l)];case 3:if(!(C=t.sent()))return[2,Promise.reject("Failed to fetch DriveItem from Hoot.")];if(!(H=Ee(C,s)))throw new SyntaxError(Fe);return[2,H];case 4:return(g=t.sent())instanceof SyntaxError||null==s||s.ULS.sendTraceTag(508155348,f.W.oo,v.G.Warning,"Failed to get vroom data from Hoot. [Error: ".concat(JSON.stringify(g),"] [Reason: ").concat(null==g?void 0:g.failure,"]")),g&&401===g.sharePointCallStatus&&"insufficient_claims"===g.claimsError&&g.claims?(null==s||s.ULS.sendTraceTag(508155347,f.W.oo,v.G.Warning,"Hoot Vroom call failed with claims challenge, retrying with claims."),[4,$n(o,u,a,s,g.claims)]):[3,7];case 5:return(S=t.sent())?[4,ye(Pe(m,c,h,u,S),s,l)]:[2,Promise.reject("Failed to fetch necessary Wac token with Claims")];case 6:return b=t.sent(),(I=Ee(b,s))?[2,I]:[2,Promise.reject(Fe)];case 7:return[4,ye(w,s,l)];case 8:return C=t.sent(),(H=Ee(C,s))?[2,H]:[2,Promise.reject(Fe)];case 9:return[2]}}))}))}(n,u,at,Q.sessionConfig.wiseEnvironment,ct,k,Q.sessionConfig.upn,i,Ze)}));var Q={documentBootInfo:E,fetchItemFromNetwork:L,fetchAccessToken:B,openShareControl:function(n){return(0,t.mG)(C,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,7963))];case 1:return[2,e.sent().openVanillaJsShareControl(n,{},Ye)]}}))}))},sessionConfig:K,onBootComplete:F.onBootComplete,onBootFailure:F.onBootFailure,onReturnFocus:F.onReturnFocus,onConversationClose:F.onConversationClose,onNavigateBack:F.onNavigateBack,onOpenPageLevelConversation:F.onOpenPageLevelConversation,onDocumentClose:function(){F.onDocumentClose&&F.onDocumentClose(),null==Ze||Ze.shutdown()},onSuccessNotification:F.onSuccessNotification,onDismissHostSpinner:F.onDismissHostSpinner,onOpenInMobileApp:F.onOpenInMobileApp,onRename:F.onRename,initializeTwoStepCreateNew:F.initializeTwoStepCreateNew,bootstrapFile:F.bootstrapFile,uiHostConfig:T,createDocument:function(n){return(0,t.mG)(C,void 0,void 0,(function(){var e,o,i;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([u.e(5415),u.e(3648)]).then(u.bind(u,6634))];case 1:return e=t.sent(),o={fileType:n.fileType,wdOrigin:"TEAMS.UNIFIEDUIHOST.NEW",uiCulture:y.uiCulture,dataCulture:y.dataCulture,puid:y.puid,clickTime:n.clickTime,isNewFile:!0},i=(0,Rn.vJ)(Rn.Fh.FeatureGate_DeprecateAxios,T.featureGates),(0,Rn.dt)(Rn.Fh.FeatureGate_DeprecateAxios,i,Xe),[2,e.createNewDocument(V,o,n,et,Xe,i)]}}))}))},container:P};return Ut(Q)}null==Xe||Xe.ULS.sendTraceTag(576217559,f.W.oo,v.G.Error,"No document url is found. Exit")}function Ut(n){var e,r,u,a,s=(0,c.a)();(0,c.l5)(w.r_.OwlWithCustomFunctionsStart),S();var l=null!==(e=null==Ge?void 0:Ge.wiseEnvironment)&&void 0!==e?e:n.sessionConfig.wiseEnvironment;Bn.BootAttempted=!0,Bn.Environment=Vn.Environment=l,Bn.Application=Vn.Application=n.documentBootInfo.fileType,n.uiHostConfig&&(n.uiHostConfig.uiHostName&&(Bn.UiHost=Vn.UiHost=n.uiHostConfig.uiHostName),n.uiHostConfig.uiHostIntegrationType&&(Bn.UiHostIntegrationType=Vn.UiHostIntegrationType=n.uiHostConfig.uiHostIntegrationType)),n.sessionConfig&&n.sessionConfig.hostCorrelationId&&(Bn.HostCorrelationId=Vn.HostCorrelationId=n.sessionConfig.hostCorrelationId);var d=!!n.sessionConfig.health,p=function(n,e){var o,i,r,u,a,s,l,c,d,f,v,p=null!==(o=null==e?void 0:e.wiseEnvironment)&&void 0!==o?o:n.sessionConfig.wiseEnvironment,m=n.sessionConfig.sessionId||(0,h.n)();(n.sessionConfig.logger||(n.sessionConfig.logger=new b.G2(m,p).logger),n.sessionConfig.owlRollout="".concat(p,".").concat(null==e?void 0:e.exposure),n.sessionConfig.owlVersion=null==e?void 0:e.clientVersion,n.sessionConfig.health)||(v="string"==typeof m?m:(0,t.CR)(m,1)[0],n.sessionConfig.health=zn(v,p,null===(i=n.documentBootInfo)||void 0===i?void 0:i.fileType,null===(r=n.documentBootInfo)||void 0===r?void 0:r.uiCulture,null===(u=n.documentBootInfo)||void 0===u?void 0:u.puid,n.sessionConfig.tenantId,n.sessionConfig.hostCorrelationId,null==e?void 0:e.exposure,null==e?void 0:e.clientVersion,n.sessionConfig.isSynthetic,null===(a=n.uiHostConfig)||void 0===a?void 0:a.uiHostName,null===(s=n.uiHostConfig)||void 0===s?void 0:s.uiHostIntegrationType,null===(l=n.documentBootInfo)||void 0===l?void 0:l.wdOrigin,null===(c=n.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.ringId,null===(d=n.documentBootInfo)||void 0===d?void 0:d.isNewFile,null===(f=n.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.isOdcMigrated));return n}(n,Ge),m=null!==(r=p.sessionConfig.sessionId)&&void 0!==r?r:(0,h.n)()[0];n.sessionConfig.sessionId=m,g.qj.checkOwlFrameCookie(l,null===(u=n.uiHostConfig)||void 0===u?void 0:u.featureGates),d||(Ze=p.sessionConfig.health),Xe||(Xe=p.sessionConfig.logger),function(n,e){var t=!1,o=n.onBootComplete,i=n.onBootFailure,r=function(n){t?null==e||e.ULS.sendTraceTag(507540254,f.W.oo,v.G.Warning,"Calling success or failure callback after another callback has already been called. Calling ".concat(n)):(null==e||e.ULS.sendTraceTag(507540255,f.W.oo,v.G.Important,JSON.stringify(Bn)),t=!0,Bn={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1})};n.onBootComplete=function(n,e){Bn.BootSucceeded=!0,r("onBootComplete"),o&&o(n,e)},n.onBootFailure=function(n,e){r("onBootFailure"),i&&i(n,e)}}(n,Xe),function(n){var e=new Promise((function(n){return window.addEventListener("beforeunload",(function(e){return n(!0)}))})),t=new Promise((function(n){return setTimeout((function(){return n(!1)}),6e4)}));Promise.race([e,t]).then((function(e){n&&(n.ULS.sendTraceTag(507540257,f.W.oo,v.G.Important,JSON.stringify(Vn)),e?n.ULS.flushOnClose():n.ULS.flush()),Vn={}})).catch((function(){n&&n.ULS.sendTraceTag(507540256,f.W.oo,v.G.Warning,"Failed to log PostWacTokenTelemetry")}))}(Xe),function(n,e){var t,o,i,r,u,a,s,l;n.sessionConfig.bootDiagnostics=n.sessionConfig.bootDiagnostics||{},n.sessionConfig.bootDiagnostics.packageEntryTime=n.sessionConfig.bootDiagnostics.packageEntryTime||e,n.sessionConfig.bootDiagnostics.perfNavigationTiming=n.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,b.pb)(),g.qj.isOwlFrameBootEnabled(null===(t=n.uiHostConfig)||void 0===t?void 0:t.featureGates,Xe)&&(n.sessionConfig.bootDiagnostics.legacyPerformanceData=n.sessionConfig.bootDiagnostics.legacyPerformanceData||{host:(0,b.vb)()},g.qj.isOwlFrame&&(n.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming=n.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming||(0,b.pb)(),n.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame=n.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame||(0,b.vb)())),n.sessionConfig.bootDiagnostics.loadManifestStartTime=n.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(o=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadManifestStartTime)||0,n.sessionConfig.bootDiagnostics.loadManifestEndTime=n.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(i=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===i?void 0:i.loadManifestEndTime)||(null===(r=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===r?void 0:r.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed=n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed||(null===(u=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===u?void 0:u.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed=n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed||(null===(a=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===a?void 0:a.loadManifestServerTimeElapsed),n.sessionConfig.bootDiagnostics.loadOwlStartTime=n.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(s=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===s?void 0:s.loadOwlStartTime),n.sessionConfig.bootDiagnostics.loadOwlEndTime=n.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(l=null==Ge?void 0:Ge.owlBootstrapperDiagnostics)||void 0===l?void 0:l.loadOwlEndTime)}(p,s);var I=p.container;Ye=pt(p.container),p.container=Ye;var C=m===q(p.documentBootInfo),H=p.onBootFailure;p.onBootFailure=function(n,e){var t,o;if(null==Ze||Ze.recordQosError(n.qosErrorName,["UnifiedUiHostBootstrappingFailed"],(0,ve.aj)(n),(0,ve.SS)(n.wacErrorName),!0,!0,{inStaging:null===(t=n.inStaging)||void 0===t||t,extendedProperties:(0,he.x)(n)}),C){var i=new Map;i.set("FailureTime",(new Date).toUTCString()),i.set("Error",n.error),e&&i.set("DocumentBootInfo",JSON.stringify(e)),n.httpErrorCode&&i.set("HttpErrorCode",n.httpErrorCode),null==Ze||Ze.recordKpiFailure(ft,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,c.a)()-((null===(o=p.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime)||s),extendedProperties:i})}H&&H(n,e),null==Ze||Ze.shutdown()};var A=(0,t.pi)((0,t.pi)({},p),{initPackageParams:Ge});(null!==(a=A.initializeTwoStepCreateNew)&&void 0!==a?a:On.f)(A,Xe);var y=Kn(A);Le=y.endSession,Be=y.hostAccessibilityLoopComplete,Ve=y.hostGetClientUrl,Ke=y.hostGetWebUrl,Qe=y.postFrameDiagnostics,Je=y.hostBackButtonPressed,qe=y.hostSendConversationId,ze=y.completeCreateNew,g.qj.isOwlFrame&&function(n,e,r,u,a,s,l,c){var d=this;null==Dt||Dt.registerHandler(i.EndSession,(function(e){return(0,t.mG)(d,void 0,void 0,(function(){var i,r,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),[4,n()];case 1:return i=t.sent(),[3,4];case 2:return u=t.sent(),r=u,[3,4];case 3:return null==Dt||Dt.sendMessage({id:o.EndSessionResponse,data:{result:i,error:r,correlationId:e.correlationId}}),[7];case 4:return[2]}}))}))})),null==Dt||Dt.registerHandler(i.HostAccessibilityLoopComplete,(function(n){return e(n.data.navigateForward)})),null==Dt||Dt.registerHandler(i.GetClientUrl,(function(n){return r()})),null==Dt||Dt.registerHandler(i.GetWebUrl,(function(n){return u()})),null==Dt||Dt.registerHandler(i.BackButtonPressed,(function(n){return a()})),null==Dt||Dt.registerHandler(i.SendConversationId,(function(n){return s(n.data.conversationId)})),null==Dt||Dt.registerHandler(i.GetAuthTokenResponse,Ot.getHandler(i.GetAuthTokenResponse,D.Token)),null==Dt||Dt.registerHandler(i.FetchItemFromNetworkResponse,Ot.getHandler(i.FetchItemFromNetworkResponse,D.Item)),null==Dt||Dt.registerHandler(i.FetchAccessTokenResponse,Ot.getHandler(i.FetchAccessTokenResponse,D.Response)),null==Dt||Dt.registerHandler(i.OpenShareControlResponse,Ot.getHandler(i.OpenShareControlResponse)),null==Dt||Dt.registerHandler(i.CreateDocumentResponse,Ot.getHandler(i.CreateDocumentResponse,D.URL)),null==Dt||Dt.registerHandler(i.TelemetryData,(function(n){var e=n.data,t=e.context,o=e.hostData,i=e.frameData,r=(0,w.W8)(JSON.parse(o.owlTelemetryData),JSON.parse(i.owlTelemetryData));l&&l(r.owlPerformanceTimeline),null==c||c.ULS.sendTraceTag(508614159,f.W.oo,v.G.Important,t+", OwlFrame Telemetry Data: "+JSON.stringify(r)),null==c||c.ULS.sendTraceTag(508614158,f.W.oo,v.G.Important,t+", Boot Telemetry Data: "+JSON.stringify({hostBoot:o.bootTelemetryData,frameBoot:i.bootTelemetryData}))}))}(Le,Be,Ve,Ke,Je,qe,Qe,Xe);var T=function(n){var e=n.subscribe((function(n){var o,i;if(n&&(null===(o=p.uiHostConfig)||void 0===o?void 0:o.supportsInternalReboot)){var r=(0,h.n)(),u=new b.G2(r,l);p.sessionConfig.sessionId=u.sessionId,p.sessionConfig.logger=u.logger,p.sessionConfig.bootDiagnostics=(i=p.sessionConfig.bootDiagnostics,{tabsCacheHit:!0,packageEntryTime:(0,c.a)(),isTestMode:null==i?void 0:i.isTestMode,isPrebooted:!1,ringId:null==i?void 0:i.ringId,teamsContextStartTime:0,teamsContextEndTime:0,owlFramePerfNavigationTiming:(0,b.pb)(),perfNavigationTiming:(0,b.pb)(),meetingLiveDiagnostics:void 0}),p.sessionConfig.highContrastMode=n.theme,I&&Ye&&Ye.parentNode===I&&I.removeChild(Ye),Ye=St(I,dt);var a=Kn((0,t.pi)((0,t.pi)({},p),{container:Ye,documentBootInfo:n.documentBootInfo,initPackageParams:Ge}));Le=a.endSession,Be=a.hostAccessibilityLoopComplete,Ve=a.hostGetClientUrl,Ke=a.hostGetWebUrl,Je=a.hostBackButtonPressed,qe=a.hostSendConversationId,ze=a.completeCreateNew,e.unsubscribe(),T(a.sessionEndObservable)}else I&&Ye&&Ye.parentNode===I&&I.removeChild(Ye),e.unsubscribe();null==Ze||Ze.shutdown()}))};return T(y.sessionEndObservable),g.qj.isOwlFrame&&y.sessionEndObservable.subscribe((function(n){null==Dt||Dt.sendMessage({id:o.EndSessionObservable,data:{rebootInfo:n}})})),(0,c.l5)([w.r_.OwlEnd,w.r_.OwlWithCustomFunctionsEnd]),y}function Ft(n){return function(e,t,o,i,r,u){return null==Xe||Xe.ULS.sendTraceTag(546182046,f.W.oo,v.G.Info,"FetchAccessToken: Start"),r&&(kn.c.accessTokenStartTime=(0,c.a)(),(0,c.l5)("accessTokenStartTime")),n(o||wt(e),u).then((function(n){return{success:!0,token:n,format:"JWT",source:"OfficeHome"}})).catch((function(n){return Promise.reject({api:"getAuthToken",failure:n,message:"Failed to retrieve auth token"})})).finally((function(){null==Xe||Xe.ULS.sendTraceTag(546182047,f.W.oo,v.G.Info,"FetchAccessToken: End"),r&&(kn.c.accessTokenEndTime=(0,c.a)(),(0,c.l5)("accessTokenEndTime"))}))}}function Pt(n,e,o,i,r){var u=this;return function(a,s,l,c){return void 0===s&&(s=!0),void 0===l&&(l=!1),(0,t.mG)(u,void 0,void 0,(function(){var u,s,d;return(0,t.Jh)(this,(function(t){return u=!0,s=l?"editnew":"view"===a.intent?"view":"edit"===a.intent?"edit":"open",(null==o?void 0:o.isESSEnabled)&&o.wacDataCenter&&!qn.includes("wacSession")&&qn.push("wacSession"),a.shareUrl?(null==c||c.ULS.sendTraceTag(572634827,f.W.oo,v.G.Info,"Item to be fetched using shareUrl"),[2,We(a.shareUrl,qn,n,u,s,!1,c,o,r).catch((function(e){if(e&&404===e.status&&"The site has been moved to a new location."===e.message&&e.redirectLocation&&a.shareUrl){if(null==c||c.ULS.sendTraceTag(546120988,f.W.oo,v.G.Info,"Get item failed due to site move. Retry with the redirect location"),lt){var t=e.redirectLocation.split("?")[0];a.shareUrl=t}else{var i=new URL(e.redirectLocation),l=new URL(a.shareUrl);a.shareUrl=a.shareUrl.replace(l.hostname,i.hostname)}return We(a.shareUrl,qn,n,u,s,!1,c,o,r,lt)}throw e}))]):a.driveId&&a.docId?(null==c||c.ULS.sendTraceTag(572634828,f.W.oo,v.G.Info,"Item to be fetched using driveId and docId"),[2,Me(a,qn,n,u,s,e,c,o,r)]):a.fileId&&a.baseUrl?(null==c||c.ULS.sendTraceTag(572343521,f.W.oo,v.G.Info,"Item to be fetched using fileId and baseUrl"),[2,xe(a.fileId,a.baseUrl,qn,n,u,s,c,o,i,r).catch((function(e){if(st&&e&&404===e.status&&e.redirectLocation){if(null==c||c.ULS.sendTraceTag(508380358,f.W.oo,v.G.Important,"Get item failed due to site move. Retry with the redirect location"),a.baseUrl){var t=new URL(a.baseUrl),l=new URL(e.redirectLocation);a.baseUrl=a.baseUrl.replace(t.hostname,l.hostname)}return xe(a.fileId||"",a.baseUrl||"",qn,n,u,s,c,o,i,r)}throw e}))]):(null==c||c.ULS.sendTraceTag(572634829,f.W.oo,v.G.Info,"Item to be fetched using docUrl"),[2,We(null!==(d=a.docUrl)&&void 0!==d?d:"",qn,n,u,s,!1,c,o,r).catch((function(n){throw n}))])}))}))}}function Et(n){return!(n.shareUrl||!n.docId||!n.driveId||n.baseUrl||n.docUrl)}var Nt,kt=function(){function n(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];this.ju=n,this.xu=new Map(e.map((function(n){return[n,new Map]})))}return n.prototype.registerHandlers=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach((function(e){return n.xu.set(e,new Map)}))},n.prototype.getHandler=function(n,e,t){void 0===e&&(e=""),void 0===t&&(t="error");var o=this.xu.get(n);return function(n){if(o){var i=o.get(n.data.correlationId);i&&(o.delete(n.data.correlationId),e?n.data[e]?i.resolve(n.data[e]):i.reject(n.data[t]||t):i.resolve())}}},n.prototype.getMessagePromise=function(n,e){var t=this,o=this.xu.get(n);return o?new Promise((function(n,i){var r;t.ju||i("frameToHostMessenger does not exist");var u=null===(r=t.ju)||void 0===r?void 0:r.sendMessage(e);u?o.set(u,{resolve:n,reject:i}):i("Encountered error sending message to host")})):Promise.reject("No registered handlers ")},n}();!function(n){n[n.Success=0]="Success",n[n.Error=1]="Error",n[n.Timeout=2]="Timeout"}(Nt||(Nt={}));var Rt,Dt,Ot,_t,Wt,Mt="OwlFrame",jt=3e4;function xt(){Dt&&Dt.dispose(),Rt&&Rt.dispose(),window.performance&&window.performance.getEntriesByType&&window.performance.clearMarks&&window.performance.getEntriesByType("mark").filter((function(n){return n.name.startsWith("owl")})).forEach((function(n){return window.performance.clearMarks(n.name)}));var n=document.getElementById(Mt);n&&n.remove()}!function(n){n[n.Firefox=0]="Firefox",n[n.Opera=1]="Opera",n[n.IE=2]="IE",n[n.Edge=3]="Edge",n[n.Chrome=4]="Chrome",n[n.Safari=5]="Safari",n[n.TeamsElectron=6]="TeamsElectron",n[n.Unknown=7]="Unknown"}(Wt||(Wt={}));var Gt=window.navigator,Lt=Gt?Gt.userAgent:void 0;function Bt(){return!!Lt&&Lt.indexOf("iPhone")>=0||/android.+mobile/i.test(Gt.userAgent)}var Vt,Kt,Jt,qt=u(6277);function zt(){var n=window.location.search,e=new URLSearchParams(n),t=e.get(kn.$c.ItemId),o=e.get(kn.$c.DriveId),i=e.get(kn.$c.DocUrl);return{docId:null!=t?t:void 0,driveId:null!=o?o:void 0,docUrl:null!=i?i:void 0}}function Qt(n){return Jt||(Jt=function(){Kt||((Kt={})[m.T[m.T.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],Kt[m.T[m.T.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],Kt[m.T[m.T.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],Kt[m.T[m.T.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],Kt[m.T[m.T.OneNote]]=["one"]),Jt={};var n=function(n){if(!Kt.hasOwnProperty(n))return"continue";var e=Kt[n];if(!e)return"continue";e.forEach((function(e){Jt[e]=m.T[n]}))};for(var e in Kt)n(e);return Jt}()),n&&Jt[n.toLowerCase()]||m.T.None}function Xt(){var n=window.location.pathname.split("/");if(4===n.length||5===n.length)return function(n){switch(n){case"word":return m.T.Word;case"excel":return m.T.Excel;case"powerpoint":return m.T.PowerPoint;case"onenote":return m.T.OneNote;case"visio":return m.T.Visio;default:return}}(n[2].toLowerCase())}!function(n){n[n.NotSupported=0]="NotSupported",n[n.SameDocOnly=1]="SameDocOnly",n[n.AnyDoc=2]="AnyDoc",n[n.OtherMode=4]="OtherMode"}(Vt||(Vt={})),function(){var n,e;if(g.qj.isOwlFrame){var r=new URLSearchParams(location.search),u=document.getElementById("owl"),a=r.get("hostorigin"),s="true"===(null===(e=null===(n=null==u?void 0:u.dataset)||void 0===n?void 0:n.validHost)||void 0===e?void 0:e.toLowerCase());a&&s&&function(n){Dt=new l(window.parent,n),Ot=new kt(Dt,i.GetAuthTokenResponse,i.FetchItemFromNetworkResponse,i.FetchAccessTokenResponse,i.OpenShareControlResponse,i.CreateDocumentResponse),Dt.registerHandler(i.BootApplication,(function(n){(0,c.l5)(w.r_.OwlBootAppMessageReceive),Tt(function(n){var e,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,I,k,D,O,_,W,M,j,x,G,L,B,V,K,J,q,z,Q,X,Z,Y,$,nn,en,tn;return{documentIdentifier:n.documentIdentifier,sessionConfig:{hostCorrelationId:n.sessionConfig.hostCorrelationId,isMsa:n.sessionConfig.isMsa,tenantId:n.sessionConfig.tenantId,organizationName:n.sessionConfig.organizationName,sessionId:n.sessionConfig.sessionId,isESSEnabled:n.sessionConfig.isESSEnabled,experiments:n.sessionConfig.experiments,highContrastMode:n.sessionConfig.highContrastMode,additionalApplicationParameters:n.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(e=n.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.tabsCacheHit,packageEntryTime:null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.packageEntryTime,isTestMode:null===(u=n.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isTestMode,isManifestCachingEnabled:null===(a=n.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(s=n.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isOwlBootstrapperEnabled,isPrebooted:null===(l=n.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.isPrebooted,isVroom21:null===(c=n.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.isVroom21,ringId:null===(d=n.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.ringId,teamsContextStartTime:null===(f=n.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.teamsContextStartTime,teamsContextEndTime:null===(v=n.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.teamsContextEndTime,wopiDataStartTime:null===(h=n.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.wopiDataStartTime,wopiDataEndTime:null===(p=n.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.wopiDataEndTime,bootStrapStartTime:null===(m=n.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.bootStrapStartTime,bootStrapEndTime:null===(w=n.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.bootStrapEndTime,driveItemStartTime:null===(g=n.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemStartTime,driveItemEndTime:null===(S=n.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.driveItemEndTime,driveItemFromWacStartTime:null===(I=n.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(k=n.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.driveItemFromWacEndTime,accessTokenStartTime:null===(D=n.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.accessTokenStartTime,accessTokenEndTime:null===(O=n.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.accessTokenEndTime,isCookieBlocked:null===(_=n.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.isCookieBlocked,meetingLiveDiagnostics:null===(W=n.sessionConfig.bootDiagnostics)||void 0===W?void 0:W.meetingLiveDiagnostics,spRequestGuid:null===(M=n.sessionConfig.bootDiagnostics)||void 0===M?void 0:M.spRequestGuid,createNewStartTime:null===(j=n.sessionConfig.bootDiagnostics)||void 0===j?void 0:j.createNewStartTime,createNewEndTime:null===(x=n.sessionConfig.bootDiagnostics)||void 0===x?void 0:x.createNewEndTime,loadManifestStartTime:null===(G=n.sessionConfig.bootDiagnostics)||void 0===G?void 0:G.loadManifestStartTime,loadManifestEndTime:null===(L=n.sessionConfig.bootDiagnostics)||void 0===L?void 0:L.loadManifestEndTime,getManifestFromRemoteTimeElapsed:null===(B=n.sessionConfig.bootDiagnostics)||void 0===B?void 0:B.getManifestFromRemoteTimeElapsed,loadManifestServerTimeElapsed:null===(V=n.sessionConfig.bootDiagnostics)||void 0===V?void 0:V.loadManifestServerTimeElapsed,loadOwlStartTime:null===(K=n.sessionConfig.bootDiagnostics)||void 0===K?void 0:K.loadOwlStartTime,loadOwlEndTime:null===(J=n.sessionConfig.bootDiagnostics)||void 0===J?void 0:J.loadOwlEndTime,owlBootstrapperStartTime:null===(q=n.sessionConfig.bootDiagnostics)||void 0===q?void 0:q.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(z=n.sessionConfig.bootDiagnostics)||void 0===z?void 0:z.owlBootstrapperEndTime,isOdcMigrated:null===(Q=n.sessionConfig.bootDiagnostics)||void 0===Q?void 0:Q.isOdcMigrated,perfNavigationTiming:null===(X=n.sessionConfig.bootDiagnostics)||void 0===X?void 0:X.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(Z=n.sessionConfig.bootDiagnostics)||void 0===Z?void 0:Z.owlFramePerfNavigationTiming)||(0,b.pb)(),legacyPerformanceData:{host:null===($=null===(Y=n.sessionConfig.bootDiagnostics)||void 0===Y?void 0:Y.legacyPerformanceData)||void 0===$?void 0:$.host,owlFrame:(null===(en=null===(nn=n.sessionConfig.bootDiagnostics)||void 0===nn?void 0:nn.legacyPerformanceData)||void 0===en?void 0:en.owlFrame)||(0,b.vb)()}},uiHostTabId:n.sessionConfig.uiHostTabId,upn:n.sessionConfig.upn,meeting:n.sessionConfig.meeting,customAuthConfigValue:n.sessionConfig.customAuthConfigValue,wiseEnvironment:n.sessionConfig.wiseEnvironment,isSynthetic:n.sessionConfig.isSynthetic,hostUrl:n.sessionConfig.hostUrl,owlVersion:n.sessionConfig.owlVersion,owlRollout:n.sessionConfig.owlRollout,fileType:n.sessionConfig.fileType,clickTime:n.sessionConfig.clickTime,uiCulture:n.sessionConfig.uiCulture,dataCulture:n.sessionConfig.dataCulture,puid:n.sessionConfig.puid,isNewFile:n.sessionConfig.isNewFile,wdValue:n.sessionConfig.wdValue,sessionOrigin:n.sessionConfig.sessionOrigin,intent:n.sessionConfig.intent,hostClientType:n.sessionConfig.hostClientType,isPopOut:n.sessionConfig.isPopOut,teamType:n.sessionConfig.teamType,initPackageParams:n.sessionConfig.initPackageParams&&(0,t.pi)((0,t.pi)({},n.sessionConfig.initPackageParams),{jsApiUrlInfos:R(null===(tn=n.sessionConfig.initPackageParams)||void 0===tn?void 0:tn.jsApiUrlInfos)}),origin:n.sessionConfig.origin},uiHostConfig:(0,t.pi)((0,t.pi)({},n.uiHostConfig),{featureGates:n.uiHostConfig.featureGates?R(n.uiHostConfig.featureGates):void 0}),getAuthToken:function(n,e){return Ot.getMessagePromise(i.GetAuthTokenResponse,{id:o.GetAuthToken,data:{resourceUrl:n,claims:e}})},eventHandlers:{onBootComplete:C,onBootFailure:H,onReturnFocus:A,onConversationClose:y,onNavigateBack:T,onOpenPageLevelConversation:U,onDocumentClose:F,onSuccessNotification:P,onOpenInMobileApp:E},container:document.getElementById("owl-container")||N()}}(n.data))})),Dt.sendMessage({id:o.FrameLoaded,data:{success:!0}})}(a)}}()}(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=a}();